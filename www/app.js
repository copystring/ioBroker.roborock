var Zr={value:()=>{}};function Ue(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Vt(n)}function Vt(t){this._=t}function Xr(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Vt.prototype=Ue.prototype={constructor:Vt,on:function(t,e){var n=this._,r=Xr(t+"",n),o,a=-1,i=r.length;if(arguments.length<2){for(;++a<i;)if((o=(t=r[a]).type)&&(o=Qr(n[o],t.name)))return o;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<i;)if(o=(t=r[a]).type)n[o]=Fe(n[o],t.name,e);else if(e==null)for(o in n)n[o]=Fe(n[o],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Vt(t)},call:function(t,e){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,a;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=this._[t],r=0,o=a.length;r<o;++r)a[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],o=0,a=r.length;o<a;++o)r[o].value.apply(e,n)}};function Qr(t,e){for(var n=0,r=t.length,o;n<r;++n)if((o=t[n]).name===e)return o.value}function Fe(t,e,n){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=Zr,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var gt=Ue;var Ft="http://www.w3.org/1999/xhtml",ke={svg:"http://www.w3.org/2000/svg",xhtml:Ft,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ot(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),ke.hasOwnProperty(e)?{space:ke[e],local:t}:t}function Vr(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Ft&&e.documentElement.namespaceURI===Ft?e.createElement(t):e.createElementNS(n,t)}}function Fr(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ut(t){var e=ot(t);return(e.local?Fr:Vr)(e)}function Ur(){}function pt(t){return t==null?Ur:function(){return this.querySelector(t)}}function Ke(t){typeof t!="function"&&(t=pt(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var a=e[o],i=a.length,s=r[o]=new Array(i),l,u,c=0;c<i;++c)(l=a[c])&&(u=t.call(l,l.__data__,c,a))&&("__data__"in l&&(u.__data__=l.__data__),s[c]=u);return new T(r,this._parents)}function _e(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Kr(){return[]}function kt(t){return t==null?Kr:function(){return this.querySelectorAll(t)}}function jr(t){return function(){return _e(t.apply(this,arguments))}}function je(t){typeof t=="function"?t=jr(t):t=kt(t);for(var e=this._groups,n=e.length,r=[],o=[],a=0;a<n;++a)for(var i=e[a],s=i.length,l,u=0;u<s;++u)(l=i[u])&&(r.push(t.call(l,l.__data__,u,i)),o.push(l));return new T(r,o)}function _t(t){return function(){return this.matches(t)}}function Kt(t){return function(e){return e.matches(t)}}var Jr=Array.prototype.find;function qr(t){return function(){return Jr.call(this.children,t)}}function $r(){return this.firstElementChild}function Je(t){return this.select(t==null?$r:qr(typeof t=="function"?t:Kt(t)))}var to=Array.prototype.filter;function eo(){return Array.from(this.children)}function no(t){return function(){return to.call(this.children,t)}}function qe(t){return this.selectAll(t==null?eo:no(typeof t=="function"?t:Kt(t)))}function $e(t){typeof t!="function"&&(t=_t(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var a=e[o],i=a.length,s=r[o]=[],l,u=0;u<i;++u)(l=a[u])&&t.call(l,l.__data__,u,a)&&s.push(l);return new T(r,this._parents)}function jt(t){return new Array(t.length)}function tn(){return new T(this._enter||this._groups.map(jt),this._parents)}function Mt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Mt.prototype={constructor:Mt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function en(t){return function(){return t}}function ro(t,e,n,r,o,a){for(var i=0,s,l=e.length,u=a.length;i<u;++i)(s=e[i])?(s.__data__=a[i],r[i]=s):n[i]=new Mt(t,a[i]);for(;i<l;++i)(s=e[i])&&(o[i]=s)}function oo(t,e,n,r,o,a,i){var s,l,u=new Map,c=e.length,g=a.length,f=new Array(c),p;for(s=0;s<c;++s)(l=e[s])&&(f[s]=p=i.call(l,l.__data__,s,e)+"",u.has(p)?o[s]=l:u.set(p,l));for(s=0;s<g;++s)p=i.call(t,a[s],s,a)+"",(l=u.get(p))?(r[s]=l,l.__data__=a[s],u.delete(p)):n[s]=new Mt(t,a[s]);for(s=0;s<c;++s)(l=e[s])&&u.get(f[s])===l&&(o[s]=l)}function ao(t){return t.__data__}function nn(t,e){if(!arguments.length)return Array.from(this,ao);var n=e?oo:ro,r=this._parents,o=this._groups;typeof t!="function"&&(t=en(t));for(var a=o.length,i=new Array(a),s=new Array(a),l=new Array(a),u=0;u<a;++u){var c=r[u],g=o[u],f=g.length,p=so(t.call(c,c&&c.__data__,u,r)),y=p.length,b=s[u]=new Array(y),v=i[u]=new Array(y),A=l[u]=new Array(f);n(c,g,b,v,A,p,e);for(var O=0,R=0,d,k;O<y;++O)if(d=b[O]){for(O>=R&&(R=O+1);!(k=v[R])&&++R<y;);d._next=k||null}}return i=new T(i,r),i._enter=s,i._exit=l,i}function so(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function rn(){return new T(this._exit||this._groups.map(jt),this._parents)}function on(t,e,n){var r=this.enter(),o=this,a=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(o=e(o),o&&(o=o.selection())),n==null?a.remove():n(a),r&&o?r.merge(o).order():o}function an(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,o=n.length,a=r.length,i=Math.min(o,a),s=new Array(o),l=0;l<i;++l)for(var u=n[l],c=r[l],g=u.length,f=s[l]=new Array(g),p,y=0;y<g;++y)(p=u[y]||c[y])&&(f[y]=p);for(;l<o;++l)s[l]=n[l];return new T(s,this._parents)}function sn(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],o=r.length-1,a=r[o],i;--o>=0;)(i=r[o])&&(a&&i.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(i,a),a=i);return this}function ln(t){t||(t=lo);function e(g,f){return g&&f?t(g.__data__,f.__data__):!g-!f}for(var n=this._groups,r=n.length,o=new Array(r),a=0;a<r;++a){for(var i=n[a],s=i.length,l=o[a]=new Array(s),u,c=0;c<s;++c)(u=i[c])&&(l[c]=u);l.sort(e)}return new T(o,this._parents).order()}function lo(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function un(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function cn(){return Array.from(this)}function hn(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,a=r.length;o<a;++o){var i=r[o];if(i)return i}return null}function fn(){let t=0;for(let e of this)++t;return t}function gn(){return!this.node()}function pn(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o=e[n],a=0,i=o.length,s;a<i;++a)(s=o[a])&&t.call(s,s.__data__,a,o);return this}function uo(t){return function(){this.removeAttribute(t)}}function co(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ho(t,e){return function(){this.setAttribute(t,e)}}function fo(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function go(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function po(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function mn(t,e){var n=ot(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?co:uo:typeof e=="function"?n.local?po:go:n.local?fo:ho)(n,e))}function Jt(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function mo(t){return function(){this.style.removeProperty(t)}}function Ao(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Io(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function dn(t,e,n){return arguments.length>1?this.each((e==null?mo:typeof e=="function"?Io:Ao)(t,e,n??"")):lt(this.node(),t)}function lt(t,e){return t.style.getPropertyValue(e)||Jt(t).getComputedStyle(t,null).getPropertyValue(e)}function Co(t){return function(){delete this[t]}}function yo(t,e){return function(){this[t]=e}}function bo(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function An(t,e){return arguments.length>1?this.each((e==null?Co:typeof e=="function"?bo:yo)(t,e)):this.node()[t]}function In(t){return t.trim().split(/^|\s+/)}function Me(t){return t.classList||new Cn(t)}function Cn(t){this._node=t,this._names=In(t.getAttribute("class")||"")}Cn.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function yn(t,e){for(var n=Me(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function bn(t,e){for(var n=Me(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function vo(t){return function(){yn(this,t)}}function xo(t){return function(){bn(this,t)}}function wo(t,e){return function(){(e.apply(this,arguments)?yn:bn)(this,t)}}function vn(t,e){var n=In(t+"");if(arguments.length<2){for(var r=Me(this.node()),o=-1,a=n.length;++o<a;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof e=="function"?wo:e?vo:xo)(n,e))}function So(){this.textContent=""}function Eo(t){return function(){this.textContent=t}}function ko(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function xn(t){return arguments.length?this.each(t==null?So:(typeof t=="function"?ko:Eo)(t)):this.node().textContent}function _o(){this.innerHTML=""}function Mo(t){return function(){this.innerHTML=t}}function Bo(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function wn(t){return arguments.length?this.each(t==null?_o:(typeof t=="function"?Bo:Mo)(t)):this.node().innerHTML}function Po(){this.nextSibling&&this.parentNode.appendChild(this)}function Sn(){return this.each(Po)}function To(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function En(){return this.each(To)}function kn(t){var e=typeof t=="function"?t:Ut(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Oo(){return null}function _n(t,e){var n=typeof t=="function"?t:Ut(t),r=e==null?Oo:typeof e=="function"?e:pt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Ro(){var t=this.parentNode;t&&t.removeChild(this)}function Mn(){return this.each(Ro)}function No(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Do(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Bn(t){return this.select(t?Do:No)}function Pn(t){return arguments.length?this.property("__data__",t):this.node().__data__}function zo(t){return function(e){t.call(this,e,this.__data__)}}function Go(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Ho(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,o=e.length,a;n<o;++n)a=e[n],(!t.type||a.type===t.type)&&a.name===t.name?this.removeEventListener(a.type,a.listener,a.options):e[++r]=a;++r?e.length=r:delete this.__on}}}function Lo(t,e,n){return function(){var r=this.__on,o,a=zo(e);if(r){for(var i=0,s=r.length;i<s;++i)if((o=r[i]).type===t.type&&o.name===t.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=a,o.options=n),o.value=e;return}}this.addEventListener(t.type,a,n),o={type:t.type,name:t.name,value:e,listener:a,options:n},r?r.push(o):this.__on=[o]}}function Tn(t,e,n){var r=Go(t+""),o,a=r.length,i;if(arguments.length<2){var s=this.node().__on;if(s){for(var l=0,u=s.length,c;l<u;++l)for(o=0,c=s[l];o<a;++o)if((i=r[o]).type===c.type&&i.name===c.name)return c.value}return}for(s=e?Lo:Ho,o=0;o<a;++o)this.each(s(r[o],e,n));return this}function On(t,e,n){var r=Jt(t),o=r.CustomEvent;typeof o=="function"?o=new o(e,n):(o=r.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function Yo(t,e){return function(){return On(this,t,e)}}function Wo(t,e){return function(){return On(this,t,e.apply(this,arguments))}}function Rn(t,e){return this.each((typeof e=="function"?Wo:Yo)(t,e))}function*Nn(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,a=r.length,i;o<a;++o)(i=r[o])&&(yield i)}var Be=[null];function T(t,e){this._groups=t,this._parents=e}function Dn(){return new T([[document.documentElement]],Be)}function Zo(){return this}T.prototype=Dn.prototype={constructor:T,select:Ke,selectAll:je,selectChild:Je,selectChildren:qe,filter:$e,data:nn,enter:tn,exit:rn,join:on,merge:an,selection:Zo,order:sn,sort:ln,call:un,nodes:cn,node:hn,size:fn,empty:gn,each:pn,attr:mn,style:dn,property:An,classed:vn,text:xn,html:wn,raise:Sn,lower:En,append:kn,insert:_n,remove:Mn,clone:Bn,datum:Pn,on:Tn,dispatch:Rn,[Symbol.iterator]:Nn};var it=Dn;function E(t){return typeof t=="string"?new T([[document.querySelector(t)]],[document.documentElement]):new T([[t]],Be)}function zn(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Y(t,e){if(t=zn(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]}}return[t.pageX,t.pageY]}var Gn={passive:!1},mt={capture:!0,passive:!1};function qt(t){t.stopImmediatePropagation()}function ut(t){t.preventDefault(),t.stopImmediatePropagation()}function Bt(t){var e=t.document.documentElement,n=E(t).on("dragstart.drag",ut,mt);"onselectstart"in e?n.on("selectstart.drag",ut,mt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Pt(t,e){var n=t.document.documentElement,r=E(t).on("dragstart.drag",null);e&&(r.on("click.drag",ut,mt),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Tt=t=>()=>t;function Ot(t,{sourceEvent:e,subject:n,target:r,identifier:o,active:a,x:i,y:s,dx:l,dy:u,dispatch:c}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:c}})}Ot.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function Xo(t){return!t.ctrlKey&&!t.button}function Qo(){return this.parentNode}function Vo(t,e){return e??{x:t.x,y:t.y}}function Fo(){return navigator.maxTouchPoints||"ontouchstart"in this}function $t(){var t=Xo,e=Qo,n=Vo,r=Fo,o={},a=gt("start","drag","end"),i=0,s,l,u,c,g=0;function f(d){d.on("mousedown.drag",p).filter(r).on("touchstart.drag",v).on("touchmove.drag",A,Gn).on("touchend.drag touchcancel.drag",O).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(d,k){if(!(c||!t.call(this,d,k))){var _=R(this,e.call(this,d,k),d,k,"mouse");_&&(E(d.view).on("mousemove.drag",y,mt).on("mouseup.drag",b,mt),Bt(d.view),qt(d),u=!1,s=d.clientX,l=d.clientY,_("start",d))}}function y(d){if(ut(d),!u){var k=d.clientX-s,_=d.clientY-l;u=k*k+_*_>g}o.mouse("drag",d)}function b(d){E(d.view).on("mousemove.drag mouseup.drag",null),Pt(d.view,u),ut(d),o.mouse("end",d)}function v(d,k){if(t.call(this,d,k)){var _=d.changedTouches,M=e.call(this,d,k),N=_.length,G,X;for(G=0;G<N;++G)(X=R(this,M,d,k,_[G].identifier,_[G]))&&(qt(d),X("start",d,_[G]))}}function A(d){var k=d.changedTouches,_=k.length,M,N;for(M=0;M<_;++M)(N=o[k[M].identifier])&&(ut(d),N("drag",d,k[M]))}function O(d){var k=d.changedTouches,_=k.length,M,N;for(c&&clearTimeout(c),c=setTimeout(function(){c=null},500),M=0;M<_;++M)(N=o[k[M].identifier])&&(qt(d),N("end",d,k[M]))}function R(d,k,_,M,N,G){var X=a.copy(),H=Y(G||_,k),K,st,h;if((h=n.call(d,new Ot("beforestart",{sourceEvent:_,target:f,identifier:N,active:i,x:H[0],y:H[1],dx:0,dy:0,dispatch:X}),M))!=null)return K=h.x-H[0]||0,st=h.y-H[1]||0,function I(m,C,x){var w=H,S;switch(m){case"start":o[N]=I,S=i++;break;case"end":delete o[N],--i;case"drag":H=Y(x||C,k),S=i;break}X.call(m,d,new Ot(m,{sourceEvent:C,subject:h,target:f,identifier:N,active:S,x:H[0]+K,y:H[1]+st,dx:H[0]-w[0],dy:H[1]-w[1],dispatch:X}),M)}}return f.filter=function(d){return arguments.length?(t=typeof d=="function"?d:Tt(!!d),f):t},f.container=function(d){return arguments.length?(e=typeof d=="function"?d:Tt(d),f):e},f.subject=function(d){return arguments.length?(n=typeof d=="function"?d:Tt(d),f):n},f.touchable=function(d){return arguments.length?(r=typeof d=="function"?d:Tt(!!d),f):r},f.on=function(){var d=a.on.apply(a,arguments);return d===a?f:d},f.clickDistance=function(d){return arguments.length?(g=(d=+d)*d,f):Math.sqrt(g)},f}function te(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Pe(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Dt(){}var Rt=.7,re=1/Rt,bt="\\s*([+-]?\\d+)\\s*",Nt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",nt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Uo=/^#([0-9a-f]{3,8})$/,Ko=new RegExp(`^rgb\\(${bt},${bt},${bt}\\)$`),jo=new RegExp(`^rgb\\(${nt},${nt},${nt}\\)$`),Jo=new RegExp(`^rgba\\(${bt},${bt},${bt},${Nt}\\)$`),qo=new RegExp(`^rgba\\(${nt},${nt},${nt},${Nt}\\)$`),$o=new RegExp(`^hsl\\(${Nt},${nt},${nt}\\)$`),ti=new RegExp(`^hsla\\(${Nt},${nt},${nt},${Nt}\\)$`),Hn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};te(Dt,ct,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Ln,formatHex:Ln,formatHex8:ei,formatHsl:ni,formatRgb:Yn,toString:Yn});function Ln(){return this.rgb().formatHex()}function ei(){return this.rgb().formatHex8()}function ni(){return Fn(this).formatHsl()}function Yn(){return this.rgb().formatRgb()}function ct(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Uo.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Wn(e):n===3?new Z(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?ee(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?ee(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Ko.exec(t))?new Z(e[1],e[2],e[3],1):(e=jo.exec(t))?new Z(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Jo.exec(t))?ee(e[1],e[2],e[3],e[4]):(e=qo.exec(t))?ee(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=$o.exec(t))?Qn(e[1],e[2]/100,e[3]/100,1):(e=ti.exec(t))?Qn(e[1],e[2]/100,e[3]/100,e[4]):Hn.hasOwnProperty(t)?Wn(Hn[t]):t==="transparent"?new Z(NaN,NaN,NaN,0):null}function Wn(t){return new Z(t>>16&255,t>>8&255,t&255,1)}function ee(t,e,n,r){return r<=0&&(t=e=n=NaN),new Z(t,e,n,r)}function ri(t){return t instanceof Dt||(t=ct(t)),t?(t=t.rgb(),new Z(t.r,t.g,t.b,t.opacity)):new Z}function vt(t,e,n,r){return arguments.length===1?ri(t):new Z(t,e,n,r??1)}function Z(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}te(Z,vt,Pe(Dt,{brighter(t){return t=t==null?re:Math.pow(re,t),new Z(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Rt:Math.pow(Rt,t),new Z(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Z(At(this.r),At(this.g),At(this.b),oe(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Zn,formatHex:Zn,formatHex8:oi,formatRgb:Xn,toString:Xn}));function Zn(){return`#${dt(this.r)}${dt(this.g)}${dt(this.b)}`}function oi(){return`#${dt(this.r)}${dt(this.g)}${dt(this.b)}${dt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Xn(){let t=oe(this.opacity);return`${t===1?"rgb(":"rgba("}${At(this.r)}, ${At(this.g)}, ${At(this.b)}${t===1?")":`, ${t})`}`}function oe(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function At(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function dt(t){return t=At(t),(t<16?"0":"")+t.toString(16)}function Qn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new q(t,e,n,r)}function Fn(t){if(t instanceof q)return new q(t.h,t.s,t.l,t.opacity);if(t instanceof Dt||(t=ct(t)),!t)return new q;if(t instanceof q)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),a=Math.max(e,n,r),i=NaN,s=a-o,l=(a+o)/2;return s?(e===a?i=(n-r)/s+(n<r)*6:n===a?i=(r-e)/s+2:i=(e-n)/s+4,s/=l<.5?a+o:2-a-o,i*=60):s=l>0&&l<1?0:i,new q(i,s,l,t.opacity)}function Un(t,e,n,r){return arguments.length===1?Fn(t):new q(t,e,n,r??1)}function q(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}te(q,Un,Pe(Dt,{brighter(t){return t=t==null?re:Math.pow(re,t),new q(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Rt:Math.pow(Rt,t),new q(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,o=2*n-r;return new Z(Te(t>=240?t-240:t+120,o,r),Te(t,o,r),Te(t<120?t+240:t-120,o,r),this.opacity)},clamp(){return new q(Vn(this.h),ne(this.s),ne(this.l),oe(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let t=oe(this.opacity);return`${t===1?"hsl(":"hsla("}${Vn(this.h)}, ${ne(this.s)*100}%, ${ne(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Vn(t){return t=(t||0)%360,t<0?t+360:t}function ne(t){return Math.max(0,Math.min(1,t||0))}function Te(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function Oe(t,e,n,r,o){var a=t*t,i=a*t;return((1-3*t+3*a-i)*e+(4-6*a+3*i)*n+(1+3*t+3*a-3*i)*r+i*o)/6}function Kn(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),o=t[r],a=t[r+1],i=r>0?t[r-1]:2*o-a,s=r<e-1?t[r+2]:2*a-o;return Oe((n-r/e)*e,i,o,a,s)}}function jn(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),o=t[(r+e-1)%e],a=t[r%e],i=t[(r+1)%e],s=t[(r+2)%e];return Oe((n-r/e)*e,o,a,i,s)}}var Re=t=>()=>t;function ii(t,e){return function(n){return t+n*e}}function ai(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Jn(t){return(t=+t)==1?ie:function(e,n){return n-e?ai(e,n,t):Re(isNaN(e)?n:e)}}function ie(t,e){var n=e-t;return n?ii(t,n):Re(isNaN(t)?e:t)}var ae=(function t(e){var n=Jn(e);function r(o,a){var i=n((o=vt(o)).r,(a=vt(a)).r),s=n(o.g,a.g),l=n(o.b,a.b),u=ie(o.opacity,a.opacity);return function(c){return o.r=i(c),o.g=s(c),o.b=l(c),o.opacity=u(c),o+""}}return r.gamma=t,r})(1);function qn(t){return function(e){var n=e.length,r=new Array(n),o=new Array(n),a=new Array(n),i,s;for(i=0;i<n;++i)s=vt(e[i]),r[i]=s.r||0,o[i]=s.g||0,a[i]=s.b||0;return r=t(r),o=t(o),a=t(a),s.opacity=1,function(l){return s.r=r(l),s.g=o(l),s.b=a(l),s+""}}}var si=qn(Kn),li=qn(jn);function F(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var De=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ne=new RegExp(De.source,"g");function ui(t){return function(){return t}}function ci(t){return function(e){return t(e)+""}}function ze(t,e){var n=De.lastIndex=Ne.lastIndex=0,r,o,a,i=-1,s=[],l=[];for(t=t+"",e=e+"";(r=De.exec(t))&&(o=Ne.exec(e));)(a=o.index)>n&&(a=e.slice(n,a),s[i]?s[i]+=a:s[++i]=a),(r=r[0])===(o=o[0])?s[i]?s[i]+=o:s[++i]=o:(s[++i]=null,l.push({i,x:F(r,o)})),n=Ne.lastIndex;return n<e.length&&(a=e.slice(n),s[i]?s[i]+=a:s[++i]=a),s.length<2?l[0]?ci(l[0].x):ui(e):(e=l.length,function(u){for(var c=0,g;c<e;++c)s[(g=l[c]).i]=g.x(u);return s.join("")})}var $n=180/Math.PI,se={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ge(t,e,n,r,o,a){var i,s,l;return(i=Math.sqrt(t*t+e*e))&&(t/=i,e/=i),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,l/=s),t*r<e*n&&(t=-t,e=-e,l=-l,i=-i),{translateX:o,translateY:a,rotate:Math.atan2(e,t)*$n,skewX:Math.atan(l)*$n,scaleX:i,scaleY:s}}var le;function tr(t){let e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?se:Ge(e.a,e.b,e.c,e.d,e.e,e.f)}function er(t){return t==null?se:(le||(le=document.createElementNS("http://www.w3.org/2000/svg","g")),le.setAttribute("transform",t),(t=le.transform.baseVal.consolidate())?(t=t.matrix,Ge(t.a,t.b,t.c,t.d,t.e,t.f)):se)}function nr(t,e,n,r){function o(u){return u.length?u.pop()+" ":""}function a(u,c,g,f,p,y){if(u!==g||c!==f){var b=p.push("translate(",null,e,null,n);y.push({i:b-4,x:F(u,g)},{i:b-2,x:F(c,f)})}else(g||f)&&p.push("translate("+g+e+f+n)}function i(u,c,g,f){u!==c?(u-c>180?c+=360:c-u>180&&(u+=360),f.push({i:g.push(o(g)+"rotate(",null,r)-2,x:F(u,c)})):c&&g.push(o(g)+"rotate("+c+r)}function s(u,c,g,f){u!==c?f.push({i:g.push(o(g)+"skewX(",null,r)-2,x:F(u,c)}):c&&g.push(o(g)+"skewX("+c+r)}function l(u,c,g,f,p,y){if(u!==g||c!==f){var b=p.push(o(p)+"scale(",null,",",null,")");y.push({i:b-4,x:F(u,g)},{i:b-2,x:F(c,f)})}else(g!==1||f!==1)&&p.push(o(p)+"scale("+g+","+f+")")}return function(u,c){var g=[],f=[];return u=t(u),c=t(c),a(u.translateX,u.translateY,c.translateX,c.translateY,g,f),i(u.rotate,c.rotate,g,f),s(u.skewX,c.skewX,g,f),l(u.scaleX,u.scaleY,c.scaleX,c.scaleY,g,f),u=c=null,function(p){for(var y=-1,b=f.length,v;++y<b;)g[(v=f[y]).i]=v.x(p);return g.join("")}}}var He=nr(tr,"px, ","px)","deg)"),Le=nr(er,", ",")",")");var hi=1e-12;function rr(t){return((t=Math.exp(t))+1/t)/2}function fi(t){return((t=Math.exp(t))-1/t)/2}function gi(t){return((t=Math.exp(2*t))-1)/(t+1)}var Ye=(function t(e,n,r){function o(a,i){var s=a[0],l=a[1],u=a[2],c=i[0],g=i[1],f=i[2],p=c-s,y=g-l,b=p*p+y*y,v,A;if(b<hi)A=Math.log(f/u)/e,v=function(M){return[s+M*p,l+M*y,u*Math.exp(e*M*A)]};else{var O=Math.sqrt(b),R=(f*f-u*u+r*b)/(2*u*n*O),d=(f*f-u*u-r*b)/(2*f*n*O),k=Math.log(Math.sqrt(R*R+1)-R),_=Math.log(Math.sqrt(d*d+1)-d);A=(_-k)/e,v=function(M){var N=M*A,G=rr(k),X=u/(n*O)*(G*gi(e*N+k)-fi(k));return[s+X*p,l+X*y,u*G/rr(e*N+k)]}}return v.duration=A*1e3*e/Math.SQRT2,v}return o.rho=function(a){var i=Math.max(.001,+a),s=i*i,l=s*s;return t(i,s,l)},o})(Math.SQRT2,2,4);var xt=0,Gt=0,zt=0,ir=1e3,ue,Ht,ce=0,It=0,he=0,Lt=typeof performance=="object"&&performance.now?performance:Date,ar=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Wt(){return It||(ar(pi),It=Lt.now()+he)}function pi(){It=0}function Yt(){this._call=this._time=this._next=null}Yt.prototype=fe.prototype={constructor:Yt,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Wt():+n)+(e==null?0:+e),!this._next&&Ht!==this&&(Ht?Ht._next=this:ue=this,Ht=this),this._call=t,this._time=n,We()},stop:function(){this._call&&(this._call=null,this._time=1/0,We())}};function fe(t,e,n){var r=new Yt;return r.restart(t,e,n),r}function sr(){Wt(),++xt;for(var t=ue,e;t;)(e=It-t._time)>=0&&t._call.call(void 0,e),t=t._next;--xt}function or(){It=(ce=Lt.now())+he,xt=Gt=0;try{sr()}finally{xt=0,di(),It=0}}function mi(){var t=Lt.now(),e=t-ce;e>ir&&(he-=e,ce=t)}function di(){for(var t,e=ue,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:ue=n);Ht=t,We(r)}function We(t){if(!xt){Gt&&(Gt=clearTimeout(Gt));var e=t-It;e>24?(t<1/0&&(Gt=setTimeout(or,t-Lt.now()-he)),zt&&(zt=clearInterval(zt))):(zt||(ce=Lt.now(),zt=setInterval(mi,ir)),xt=1,ar(or))}}function ge(t,e,n){var r=new Yt;return e=e==null?0:+e,r.restart(o=>{r.stop(),t(o+e)},e,n),r}var Ai=gt("start","end","cancel","interrupt"),Ii=[],cr=0,lr=1,me=2,pe=3,ur=4,de=5,Zt=6;function ht(t,e,n,r,o,a){var i=t.__transition;if(!i)t.__transition={};else if(n in i)return;Ci(t,n,{name:e,index:r,group:o,on:Ai,tween:Ii,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:cr})}function Xt(t,e){var n=z(t,e);if(n.state>cr)throw new Error("too late; already scheduled");return n}function L(t,e){var n=z(t,e);if(n.state>pe)throw new Error("too late; already running");return n}function z(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Ci(t,e,n){var r=t.__transition,o;r[e]=n,n.timer=fe(a,0,n.time);function a(u){n.state=lr,n.timer.restart(i,n.delay,n.time),n.delay<=u&&i(u-n.delay)}function i(u){var c,g,f,p;if(n.state!==lr)return l();for(c in r)if(p=r[c],p.name===n.name){if(p.state===pe)return ge(i);p.state===ur?(p.state=Zt,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete r[c]):+c<e&&(p.state=Zt,p.timer.stop(),p.on.call("cancel",t,t.__data__,p.index,p.group),delete r[c])}if(ge(function(){n.state===pe&&(n.state=ur,n.timer.restart(s,n.delay,n.time),s(u))}),n.state=me,n.on.call("start",t,t.__data__,n.index,n.group),n.state===me){for(n.state=pe,o=new Array(f=n.tween.length),c=0,g=-1;c<f;++c)(p=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(o[++g]=p);o.length=g+1}}function s(u){for(var c=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(l),n.state=de,1),g=-1,f=o.length;++g<f;)o[g].call(t,c);n.state===de&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=Zt,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function ft(t,e){var n=t.__transition,r,o,a=!0,i;if(n){e=e==null?null:e+"";for(i in n){if((r=n[i]).name!==e){a=!1;continue}o=r.state>me&&r.state<de,r.state=Zt,r.timer.stop(),r.on.call(o?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[i]}a&&delete t.__transition}}function hr(t){return this.each(function(){ft(this,t)})}function yi(t,e){var n,r;return function(){var o=L(this,t),a=o.tween;if(a!==n){r=n=a;for(var i=0,s=r.length;i<s;++i)if(r[i].name===e){r=r.slice(),r.splice(i,1);break}}o.tween=r}}function bi(t,e,n){var r,o;if(typeof n!="function")throw new Error;return function(){var a=L(this,t),i=a.tween;if(i!==r){o=(r=i).slice();for(var s={name:e,value:n},l=0,u=o.length;l<u;++l)if(o[l].name===e){o[l]=s;break}l===u&&o.push(s)}a.tween=o}}function fr(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=z(this.node(),n).tween,o=0,a=r.length,i;o<a;++o)if((i=r[o]).name===t)return i.value;return null}return this.each((e==null?yi:bi)(n,t,e))}function wt(t,e,n){var r=t._id;return t.each(function(){var o=L(this,r);(o.value||(o.value={}))[e]=n.apply(this,arguments)}),function(o){return z(o,r).value[e]}}function Ae(t,e){var n;return(typeof e=="number"?F:e instanceof ct?ae:(n=ct(e))?(e=n,ae):ze)(t,e)}function vi(t){return function(){this.removeAttribute(t)}}function xi(t){return function(){this.removeAttributeNS(t.space,t.local)}}function wi(t,e,n){var r,o=n+"",a;return function(){var i=this.getAttribute(t);return i===o?null:i===r?a:a=e(r=i,n)}}function Si(t,e,n){var r,o=n+"",a;return function(){var i=this.getAttributeNS(t.space,t.local);return i===o?null:i===r?a:a=e(r=i,n)}}function Ei(t,e,n){var r,o,a;return function(){var i,s=n(this),l;return s==null?void this.removeAttribute(t):(i=this.getAttribute(t),l=s+"",i===l?null:i===r&&l===o?a:(o=l,a=e(r=i,s)))}}function ki(t,e,n){var r,o,a;return function(){var i,s=n(this),l;return s==null?void this.removeAttributeNS(t.space,t.local):(i=this.getAttributeNS(t.space,t.local),l=s+"",i===l?null:i===r&&l===o?a:(o=l,a=e(r=i,s)))}}function gr(t,e){var n=ot(t),r=n==="transform"?Le:Ae;return this.attrTween(t,typeof e=="function"?(n.local?ki:Ei)(n,r,wt(this,"attr."+t,e)):e==null?(n.local?xi:vi)(n):(n.local?Si:wi)(n,r,e))}function _i(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Mi(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Bi(t,e){var n,r;function o(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&Mi(t,a)),n}return o._value=e,o}function Pi(t,e){var n,r;function o(){var a=e.apply(this,arguments);return a!==r&&(n=(r=a)&&_i(t,a)),n}return o._value=e,o}function pr(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=ot(t);return this.tween(n,(r.local?Bi:Pi)(r,e))}function Ti(t,e){return function(){Xt(this,t).delay=+e.apply(this,arguments)}}function Oi(t,e){return e=+e,function(){Xt(this,t).delay=e}}function mr(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Ti:Oi)(e,t)):z(this.node(),e).delay}function Ri(t,e){return function(){L(this,t).duration=+e.apply(this,arguments)}}function Ni(t,e){return e=+e,function(){L(this,t).duration=e}}function dr(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Ri:Ni)(e,t)):z(this.node(),e).duration}function Di(t,e){if(typeof e!="function")throw new Error;return function(){L(this,t).ease=e}}function Ar(t){var e=this._id;return arguments.length?this.each(Di(e,t)):z(this.node(),e).ease}function zi(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;L(this,t).ease=n}}function Ir(t){if(typeof t!="function")throw new Error;return this.each(zi(this._id,t))}function Cr(t){typeof t!="function"&&(t=_t(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var a=e[o],i=a.length,s=r[o]=[],l,u=0;u<i;++u)(l=a[u])&&t.call(l,l.__data__,u,a)&&s.push(l);return new W(r,this._parents,this._name,this._id)}function yr(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,o=n.length,a=Math.min(r,o),i=new Array(r),s=0;s<a;++s)for(var l=e[s],u=n[s],c=l.length,g=i[s]=new Array(c),f,p=0;p<c;++p)(f=l[p]||u[p])&&(g[p]=f);for(;s<r;++s)i[s]=e[s];return new W(i,this._parents,this._name,this._id)}function Gi(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Hi(t,e,n){var r,o,a=Gi(e)?Xt:L;return function(){var i=a(this,t),s=i.on;s!==r&&(o=(r=s).copy()).on(e,n),i.on=o}}function br(t,e){var n=this._id;return arguments.length<2?z(this.node(),n).on.on(t):this.each(Hi(n,t,e))}function Li(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function vr(){return this.on("end.remove",Li(this._id))}function xr(t){var e=this._name,n=this._id;typeof t!="function"&&(t=pt(t));for(var r=this._groups,o=r.length,a=new Array(o),i=0;i<o;++i)for(var s=r[i],l=s.length,u=a[i]=new Array(l),c,g,f=0;f<l;++f)(c=s[f])&&(g=t.call(c,c.__data__,f,s))&&("__data__"in c&&(g.__data__=c.__data__),u[f]=g,ht(u[f],e,n,f,u,z(c,n)));return new W(a,this._parents,e,n)}function wr(t){var e=this._name,n=this._id;typeof t!="function"&&(t=kt(t));for(var r=this._groups,o=r.length,a=[],i=[],s=0;s<o;++s)for(var l=r[s],u=l.length,c,g=0;g<u;++g)if(c=l[g]){for(var f=t.call(c,c.__data__,g,l),p,y=z(c,n),b=0,v=f.length;b<v;++b)(p=f[b])&&ht(p,e,n,b,f,y);a.push(f),i.push(c)}return new W(a,i,e,n)}var Yi=it.prototype.constructor;function Sr(){return new Yi(this._groups,this._parents)}function Wi(t,e){var n,r,o;return function(){var a=lt(this,t),i=(this.style.removeProperty(t),lt(this,t));return a===i?null:a===n&&i===r?o:o=e(n=a,r=i)}}function Er(t){return function(){this.style.removeProperty(t)}}function Zi(t,e,n){var r,o=n+"",a;return function(){var i=lt(this,t);return i===o?null:i===r?a:a=e(r=i,n)}}function Xi(t,e,n){var r,o,a;return function(){var i=lt(this,t),s=n(this),l=s+"";return s==null&&(l=s=(this.style.removeProperty(t),lt(this,t))),i===l?null:i===r&&l===o?a:(o=l,a=e(r=i,s))}}function Qi(t,e){var n,r,o,a="style."+e,i="end."+a,s;return function(){var l=L(this,t),u=l.on,c=l.value[a]==null?s||(s=Er(e)):void 0;(u!==n||o!==c)&&(r=(n=u).copy()).on(i,o=c),l.on=r}}function kr(t,e,n){var r=(t+="")=="transform"?He:Ae;return e==null?this.styleTween(t,Wi(t,r)).on("end.style."+t,Er(t)):typeof e=="function"?this.styleTween(t,Xi(t,r,wt(this,"style."+t,e))).each(Qi(this._id,t)):this.styleTween(t,Zi(t,r,e),n).on("end.style."+t,null)}function Vi(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Fi(t,e,n){var r,o;function a(){var i=e.apply(this,arguments);return i!==o&&(r=(o=i)&&Vi(t,i,n)),r}return a._value=e,a}function _r(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,Fi(t,e,n??""))}function Ui(t){return function(){this.textContent=t}}function Ki(t){return function(){var e=t(this);this.textContent=e??""}}function Mr(t){return this.tween("text",typeof t=="function"?Ki(wt(this,"text",t)):Ui(t==null?"":t+""))}function ji(t){return function(e){this.textContent=t.call(this,e)}}function Ji(t){var e,n;function r(){var o=t.apply(this,arguments);return o!==n&&(e=(n=o)&&ji(o)),e}return r._value=t,r}function Br(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Ji(t))}function Pr(){for(var t=this._name,e=this._id,n=Ie(),r=this._groups,o=r.length,a=0;a<o;++a)for(var i=r[a],s=i.length,l,u=0;u<s;++u)if(l=i[u]){var c=z(l,e);ht(l,t,n,u,i,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new W(r,this._parents,t,n)}function Tr(){var t,e,n=this,r=n._id,o=n.size();return new Promise(function(a,i){var s={value:i},l={value:function(){--o===0&&a()}};n.each(function(){var u=L(this,r),c=u.on;c!==t&&(e=(t=c).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),u.on=e}),o===0&&a()})}var qi=0;function W(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Or(t){return it().transition(t)}function Ie(){return++qi}var at=it.prototype;W.prototype=Or.prototype={constructor:W,select:xr,selectAll:wr,selectChild:at.selectChild,selectChildren:at.selectChildren,filter:Cr,merge:yr,selection:Sr,transition:Pr,call:at.call,nodes:at.nodes,node:at.node,size:at.size,empty:at.empty,each:at.each,on:br,attr:gr,attrTween:pr,style:kr,styleTween:_r,text:Mr,textTween:Br,remove:vr,tween:fr,delay:mr,duration:dr,ease:Ar,easeVarying:Ir,end:Tr,[Symbol.iterator]:at[Symbol.iterator]};function Ce(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var $i={time:null,delay:0,duration:250,ease:Ce};function ta(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Rr(t){var e,n;t instanceof W?(e=t._id,t=t._name):(e=Ie(),(n=$i).time=Wt(),t=t==null?null:t+"");for(var r=this._groups,o=r.length,a=0;a<o;++a)for(var i=r[a],s=i.length,l,u=0;u<s;++u)(l=i[u])&&ht(l,t,e,u,i,n||ta(l,e));return new W(r,this._parents,t,e)}it.prototype.interrupt=hr;it.prototype.transition=Rr;var{abs:_h,max:Mh,min:Bh}=Math;function Nr(t){return[+t[0],+t[1]]}function ea(t){return[Nr(t[0]),Nr(t[1])]}var Ph={name:"x",handles:["w","e"].map(Ze),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Th={name:"y",handles:["n","s"].map(Ze),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Oh={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Ze),input:function(t){return t==null?null:ea(t)},output:function(t){return t}};function Ze(t){return{type:t}}var Qt=t=>()=>t;function Xe(t,{sourceEvent:e,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function tt(t,e,n){this.k=t,this.x=e,this.y=n}tt.prototype={constructor:tt,scale:function(t){return t===1?this:new tt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new tt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ct=new tt(1,0,0);yt.prototype=tt.prototype;function yt(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Ct;return t.__zoom}function ye(t){t.stopImmediatePropagation()}function St(t){t.preventDefault(),t.stopImmediatePropagation()}function na(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function ra(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Dr(){return this.__zoom||Ct}function oa(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function ia(){return navigator.maxTouchPoints||"ontouchstart"in this}function aa(t,e,n){var r=t.invertX(e[0][0])-n[0][0],o=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],i=t.invertY(e[1][1])-n[1][1];return t.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),i>a?(a+i)/2:Math.min(0,a)||Math.max(0,i))}function be(){var t=na,e=ra,n=aa,r=oa,o=ia,a=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],s=250,l=Ye,u=gt("start","zoom","end"),c,g,f,p=500,y=150,b=0,v=10;function A(h){h.property("__zoom",Dr).on("wheel.zoom",N,{passive:!1}).on("mousedown.zoom",G).on("dblclick.zoom",X).filter(o).on("touchstart.zoom",H).on("touchmove.zoom",K).on("touchend.zoom touchcancel.zoom",st).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}A.transform=function(h,I,m,C){var x=h.selection?h.selection():h;x.property("__zoom",Dr),h!==x?k(h,I,m,C):x.interrupt().each(function(){_(this,arguments).event(C).start().zoom(null,typeof I=="function"?I.apply(this,arguments):I).end()})},A.scaleBy=function(h,I,m,C){A.scaleTo(h,function(){var x=this.__zoom.k,w=typeof I=="function"?I.apply(this,arguments):I;return x*w},m,C)},A.scaleTo=function(h,I,m,C){A.transform(h,function(){var x=e.apply(this,arguments),w=this.__zoom,S=m==null?d(x):typeof m=="function"?m.apply(this,arguments):m,B=w.invert(S),P=typeof I=="function"?I.apply(this,arguments):I;return n(R(O(w,P),S,B),x,i)},m,C)},A.translateBy=function(h,I,m,C){A.transform(h,function(){return n(this.__zoom.translate(typeof I=="function"?I.apply(this,arguments):I,typeof m=="function"?m.apply(this,arguments):m),e.apply(this,arguments),i)},null,C)},A.translateTo=function(h,I,m,C,x){A.transform(h,function(){var w=e.apply(this,arguments),S=this.__zoom,B=C==null?d(w):typeof C=="function"?C.apply(this,arguments):C;return n(Ct.translate(B[0],B[1]).scale(S.k).translate(typeof I=="function"?-I.apply(this,arguments):-I,typeof m=="function"?-m.apply(this,arguments):-m),w,i)},C,x)};function O(h,I){return I=Math.max(a[0],Math.min(a[1],I)),I===h.k?h:new tt(I,h.x,h.y)}function R(h,I,m){var C=I[0]-m[0]*h.k,x=I[1]-m[1]*h.k;return C===h.x&&x===h.y?h:new tt(h.k,C,x)}function d(h){return[(+h[0][0]+ +h[1][0])/2,(+h[0][1]+ +h[1][1])/2]}function k(h,I,m,C){h.on("start.zoom",function(){_(this,arguments).event(C).start()}).on("interrupt.zoom end.zoom",function(){_(this,arguments).event(C).end()}).tween("zoom",function(){var x=this,w=arguments,S=_(x,w).event(C),B=e.apply(x,w),P=m==null?d(B):typeof m=="function"?m.apply(x,w):m,V=Math.max(B[1][0]-B[0][0],B[1][1]-B[0][1]),D=x.__zoom,Q=typeof I=="function"?I.apply(x,w):I,j=l(D.invert(P).concat(V/D.k),Q.invert(P).concat(V/Q.k));return function(J){if(J===1)J=Q;else{var rt=j(J),Ee=V/rt[2];J=new tt(Ee,P[0]-rt[0]*Ee,P[1]-rt[1]*Ee)}S.zoom(null,J)}})}function _(h,I,m){return!m&&h.__zooming||new M(h,I)}function M(h,I){this.that=h,this.args=I,this.active=0,this.sourceEvent=null,this.extent=e.apply(h,I),this.taps=0}M.prototype={event:function(h){return h&&(this.sourceEvent=h),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(h,I){return this.mouse&&h!=="mouse"&&(this.mouse[1]=I.invert(this.mouse[0])),this.touch0&&h!=="touch"&&(this.touch0[1]=I.invert(this.touch0[0])),this.touch1&&h!=="touch"&&(this.touch1[1]=I.invert(this.touch1[0])),this.that.__zoom=I,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(h){var I=E(this.that).datum();u.call(h,this.that,new Xe(h,{sourceEvent:this.sourceEvent,target:A,type:h,transform:this.that.__zoom,dispatch:u}),I)}};function N(h,...I){if(!t.apply(this,arguments))return;var m=_(this,I).event(h),C=this.__zoom,x=Math.max(a[0],Math.min(a[1],C.k*Math.pow(2,r.apply(this,arguments)))),w=Y(h);if(m.wheel)(m.mouse[0][0]!==w[0]||m.mouse[0][1]!==w[1])&&(m.mouse[1]=C.invert(m.mouse[0]=w)),clearTimeout(m.wheel);else{if(C.k===x)return;m.mouse=[w,C.invert(w)],ft(this),m.start()}St(h),m.wheel=setTimeout(S,y),m.zoom("mouse",n(R(O(C,x),m.mouse[0],m.mouse[1]),m.extent,i));function S(){m.wheel=null,m.end()}}function G(h,...I){if(f||!t.apply(this,arguments))return;var m=h.currentTarget,C=_(this,I,!0).event(h),x=E(h.view).on("mousemove.zoom",P,!0).on("mouseup.zoom",V,!0),w=Y(h,m),S=h.clientX,B=h.clientY;Bt(h.view),ye(h),C.mouse=[w,this.__zoom.invert(w)],ft(this),C.start();function P(D){if(St(D),!C.moved){var Q=D.clientX-S,j=D.clientY-B;C.moved=Q*Q+j*j>b}C.event(D).zoom("mouse",n(R(C.that.__zoom,C.mouse[0]=Y(D,m),C.mouse[1]),C.extent,i))}function V(D){x.on("mousemove.zoom mouseup.zoom",null),Pt(D.view,C.moved),St(D),C.event(D).end()}}function X(h,...I){if(t.apply(this,arguments)){var m=this.__zoom,C=Y(h.changedTouches?h.changedTouches[0]:h,this),x=m.invert(C),w=m.k*(h.shiftKey?.5:2),S=n(R(O(m,w),C,x),e.apply(this,I),i);St(h),s>0?E(this).transition().duration(s).call(k,S,C,h):E(this).call(A.transform,S,C,h)}}function H(h,...I){if(t.apply(this,arguments)){var m=h.touches,C=m.length,x=_(this,I,h.changedTouches.length===C).event(h),w,S,B,P;for(ye(h),S=0;S<C;++S)B=m[S],P=Y(B,this),P=[P,this.__zoom.invert(P),B.identifier],x.touch0?!x.touch1&&x.touch0[2]!==P[2]&&(x.touch1=P,x.taps=0):(x.touch0=P,w=!0,x.taps=1+!!c);c&&(c=clearTimeout(c)),w&&(x.taps<2&&(g=P[0],c=setTimeout(function(){c=null},p)),ft(this),x.start())}}function K(h,...I){if(this.__zooming){var m=_(this,I).event(h),C=h.changedTouches,x=C.length,w,S,B,P;for(St(h),w=0;w<x;++w)S=C[w],B=Y(S,this),m.touch0&&m.touch0[2]===S.identifier?m.touch0[0]=B:m.touch1&&m.touch1[2]===S.identifier&&(m.touch1[0]=B);if(S=m.that.__zoom,m.touch1){var V=m.touch0[0],D=m.touch0[1],Q=m.touch1[0],j=m.touch1[1],J=(J=Q[0]-V[0])*J+(J=Q[1]-V[1])*J,rt=(rt=j[0]-D[0])*rt+(rt=j[1]-D[1])*rt;S=O(S,Math.sqrt(J/rt)),B=[(V[0]+Q[0])/2,(V[1]+Q[1])/2],P=[(D[0]+j[0])/2,(D[1]+j[1])/2]}else if(m.touch0)B=m.touch0[0],P=m.touch0[1];else return;m.zoom("touch",n(R(S,B,P),m.extent,i))}}function st(h,...I){if(this.__zooming){var m=_(this,I).event(h),C=h.changedTouches,x=C.length,w,S;for(ye(h),f&&clearTimeout(f),f=setTimeout(function(){f=null},p),w=0;w<x;++w)S=C[w],m.touch0&&m.touch0[2]===S.identifier?delete m.touch0:m.touch1&&m.touch1[2]===S.identifier&&delete m.touch1;if(m.touch1&&!m.touch0&&(m.touch0=m.touch1,delete m.touch1),m.touch0)m.touch0[1]=this.__zoom.invert(m.touch0[0]);else if(m.end(),m.taps===2&&(S=Y(S,this),Math.hypot(g[0]-S[0],g[1]-S[1])<v)){var B=E(this).on("dblclick.zoom");B&&B.apply(this,arguments)}}}return A.wheelDelta=function(h){return arguments.length?(r=typeof h=="function"?h:Qt(+h),A):r},A.filter=function(h){return arguments.length?(t=typeof h=="function"?h:Qt(!!h),A):t},A.touchable=function(h){return arguments.length?(o=typeof h=="function"?h:Qt(!!h),A):o},A.extent=function(h){return arguments.length?(e=typeof h=="function"?h:Qt([[+h[0][0],+h[0][1]],[+h[1][0],+h[1][1]]]),A):e},A.scaleExtent=function(h){return arguments.length?(a[0]=+h[0],a[1]=+h[1],A):[a[0],a[1]]},A.translateExtent=function(h){return arguments.length?(i[0][0]=+h[0][0],i[1][0]=+h[1][0],i[0][1]=+h[0][1],i[1][1]=+h[1][1],A):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},A.constrain=function(h){return arguments.length?(n=h,A):n},A.duration=function(h){return arguments.length?(s=+h,A):s},A.interpolate=function(h){return arguments.length?(l=h,A):l},A.on=function(){var h=u.on.apply(u,arguments);return h===u?A:h},A.clickDistance=function(h){return arguments.length?(b=(h=+h)*h,A):Math.sqrt(b)},A.tapDistance=function(h){return arguments.length?(v=+h,A):v},A}function la(t){let{x:e,y:n,minX:r,minY:o,sizeY:a,resolution:i,scale:s}=t,l=(e-r)/i+.5,u=a-(n-o)/i-.5;return{x:l*s,y:u*s}}function ua(t){let{x:e,y:n,minX:r,minY:o,sizeY:a,resolution:i,scale:s}=t,l=e/s,u=n/s,c=(l-.5)*i+r,g=(a-u-.5)*i+o;return{x:c,y:g}}var Et=50,zr=3;function ve(t,e){if(!e)return{x:0,y:0};let n=(e.imageHeight||e.mapMaxY||1024)/e.scaleFactor,r=e.left*Et,o=e.topMap*Et,a=ua({x:t.x,y:t.y,minX:r,minY:o,sizeY:n,resolution:Et,scale:e.scaleFactor});return{x:Math.round(a.x),y:Math.round(a.y)}}function Qe(t,e){if(!e)return{x:0,y:0};let n=(e.imageHeight||e.mapMaxY||1024)/zr,r=e.left*Et,o=e.topMap*Et;return la({x:t.x,y:t.y,minX:r,minY:o,sizeY:n,resolution:Et,scale:zr})}var Gr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAMAAADXqc3KAAAAdVBMVEUAAAA44Yo44Yo44Yo44Yo44Yo44Yo44Yo44Yp26q844Yr///9767Kv89DG9t2g8Md26q5C44/5/vvz/fjY+ei19NNV5ZtJ45T2/fmY78KP7r1v6atq6Kjs/PPi+u7e+uvM9+Gb8MSS7r+H7bhm6KVh56JZ5p3ZkKITAAAACnRSTlMABTr188xpJ4aepd0A4wAAANZJREFUKM9VklmCgzAMQwkQYCSmLKWl2+zL/Y9YcIUL7wvkJHIUJyKkVcyy+JIGCZILGF//QLEqlTmMdsBEXi56igfH/QVGqvXSu49+1KftCbn+dtxB5LOPfNGQNRaKaQNkTJ46OMGczZg8wJB/9TB+J3nFkyqJMp44vBrnWYhJJmOn/5uVzAotV/zACnbUtTbOpHcQzVx8kxw6mavdpYP90dsNcE5k6xd8RoIb2Xgk6xAbfm5C9NiHtxGiXD/U2P96UJunrS/LOeV2GG4wfBi241P5+NwBnAEUFx9FUdUAAAAASUVORK5CYII=";var Hr="data:image/png;base64,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",Lr="data:image/png;base64,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AAAOVWlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNC40LjAtRXhpdjIiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIgogICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgeG1sbnM6R0lNUD0iaHR0cDovL3d3dy5naW1wLm9yZy94bXAvIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgIHhtcE1NOkRvY3VtZW50SUQ9ImdpbXA6ZG9jaWQ6Z2ltcDplODk0ZjlkMy1iNjZlLTQ1ODQtODY0MS0zMGI5MTk2ZDM2NTQiCiAgIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6YjM1MWM4ODEtZmQwYi00MjlkLWExZDMtNjkwOTFiNWE1YzYxIgogICB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YTZlMmNkZTctOGZhZC00ZDVhLWI5N2UtY2VhZTc0NWNmYjVmIgogICBkYzpGb3JtYXQ9ImltYWdlL3BuZyIKICAgR0lNUDpBUEk9IjIuMCIKICAgR0lNUDpQbGF0Zm9ybT0iV2luZG93cyIKICAgR0lNUDpUaW1lU3RhbXA9IjE2NzczNjQ5MzQzNDYyMjgiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zMiIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiCiAgIHhtcDpNZXRhZGF0YURhdGU9IjIwMjM6MDI6MjVUMjM6NDI6MTIrMDE6MDAiCiAgIHhtcDpNb2RpZnlEYXRlPSIyMDIzOjAyOjI1VDIzOjQyOjEyKzAxOjAwIj4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6MjcxYWIyOGQtODExMy00NWRiLWJkMjQtNGJkOTJjZjk5NThmIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKFdpbmRvd3MpIgogICAgICBzdEV2dDp3aGVuPSIyMDIzLTAyLTI1VDIzOjI1OjIzIi8+CiAgICAgPHJkZjpsaQogICAgICBzdEV2dDphY3Rpb249InNhdmVkIgogICAgICBzdEV2dDpjaGFuZ2VkPSIvIgogICAgICBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjA4MjZiNWE2LTgwZjctNDU2My1hY2UwLThjMTMzYjQyZmZhNCIKICAgICAgc3RFdnQ6c29mdHdhcmVBZ2VudD0iR2ltcCAyLjEwIChXaW5kb3dzKSIKICAgICAgc3RFdnQ6d2hlbj0iMjAyMy0wMi0yNVQyMzo0MjoxNCIvPgogICAgPC9yZGY6U2VxPgogICA8L3htcE1NOkhpc3Rvcnk+CiAgPC9yZGY6RGVzY3JpcHRpb24+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz6W+nyxAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5wIZFioOADz0AgAAAyVJREFUaN7tmr9uE0EQhz8ncmKSwglQkMSCIg0URMgFFUUkZARyj1DeIhQuIsQj0LqnJHkBK6FJ5QK5IIpBsuhiWVEiOY7y3/INxaybBOE9+27vbPknjWSfd2fmu/Xt7c4djDXWWGMNkRLhupcJ4CnwHHgNrADLwLxp0AT+AD+B78Ae8BsS3pCdR5kCeQPyA+QExAORHuaZtj9M36lhgX0FsmMB2Mt21Fd8QVMgGyA3AcB27cb4TMUNdgbkG0gnQNiudYzvmbjA3gPZDAH0tm1qrGhhJ0C+Wk5Kg5pnYk1ECfwB5NoBbNeuNWY0sPdBjhzCdu1IY7uFTYAUI4DtWlFzcAf8CKQeIXBdc/CvfieAt8Cinw6ZDBQKUC5Do6FWLuuxTMZ3/EWTg7MRrvgZkXxepFIR8Ty5I8/T3/J536NccQW7CHJpm9jKikitJj1Vq2lbH8CXmkv4wDk/y8dSSaxVKvleduZcXMNPgEmbhrkcZLP2jrNZ7WOpSZNL6MBztvvopSVIp+0dp9Pax8defs4F8LQtcCoFyaS942RS+/gAnnYBfAaITcOrK2i37R2329rHdjIxuYQOfAJYlWDqdWi17B23WtrHUp7JJfRZejVGs/SqC+CHIBcxuA9faC5uFh97MVhp7blcWq77XfBnMiKFgki5LNJoqJXLeiyT6WsDse4SeBnkPMLd0rnm4G63dAhUIyy1VE0OroATZ8BWhMBbJgenVY95kNMI/s6nGrs/DVABTDSBYgSjWzSxIynkPQNpOhzdpsbsXwPWeBO/gJLDM1wyMSMtxi+AtByMbktjDaYgqviH5lqWMM+qiXFIPCQLIMchju5xEKMbNPRaiMBrxE8yC7IbAuyu+o6lJAvSDhC2rT5jLfkU0IPxjvqKvWQOZD8A4H31NRSSFwNuH8/Vx9BIEuZlFK/PJ/0bjh+HBgI91eesvTtE72jdgX4McuAD9kD7DLXkvWVZ90bbjoTkc49bVUfbjIxkFmT7P8DbMV5N9Q39AKT6D9iq/jaSkpe39s4tPTbSknfmdYVL/exWEdzcZQL4aL58GcKXwccaa6yx3Okve0d25MUPGTcAAAAASUVORK5CYII=";function xe(t,e,n,r,o,a){if(n===-1||o==="")o+=`M${t},${e}`;else{let i=(t-n)**2+(e-r)**2>a;o+=i?`M${t},${e}`:`L${t},${e}`}return[o,t,e]}function we(t,e,n){return(!n||!t.length||t[t.length-1].length===0)&&t.push([]),t[t.length-1].push(e),e}function Yr(t,e,n,r,o){let a="",i="",s="",l="",u=[[]],c=[[]],g=[[]],f=[[]],p=-1,y=-1,b=-1,v=-1,A=-1,O=-1,R=-1,d=-1,k=null,_=null,M=null,N=null,G=10*r*(10*r),X=Math.min(t.length,e.length);for(let K=0;K<X;K++){let st=t[K],h=n(st,o),I=h.x,m=h.y,C=e[K],x=(C>>1&1)===1||(C>>3&1)===1,w=(C>>2&1)===1,S=(C&1)===1,B=p,P=k,V=b,D=_,Q=A,j=M;p=-1,k=null,b=-1,_=null,A=-1,M=null,x?([i,b,v]=xe(I,m,V,v,i,G),_=we(c,h,D)):w?([s,A,O]=xe(I,m,Q,O,s,G),M=we(g,h,j)):([a,p,y]=xe(I,m,B,y,a,G),k=we(u,h,P)),S?([l,R,d]=xe(I,m,R,d,l,G),N=we(f,h,N)):(R=-1,N=null)}let H=K=>K.filter(st=>st.length>0);return{mainPathD:a,backwashPathD:i,pureCleanPathD:s,mopPathD:l,mainPath:H(u),backwashPath:H(c),pureCleanPath:H(g),mopPath:H(f)}}var Se=class{_socket=null;_isConnected=!1;_disconnectedSince=null;_connCallbacks={};_isAuthDone=!1;_type="socket.io";_reconnectInterval=1e4;_reloadInterval=30;_isSecure=!1;_useStorage=!1;_objects=null;_authPromise=null;_resolveAuth=()=>{};_rejectAuth=()=>{};namespace="vis.0";user="";_connectInterval=null;_countInterval=null;_timer=null;_lastTimer=0;constructor(e){e?.useStorage&&(this._useStorage=!0)}init(e,n,r){if(this._connCallbacks=n,this._authPromise=new Promise((i,s)=>{this._resolveAuth=i,this._rejectAuth=s}),typeof socketNamespace<"u"&&(this.namespace=socketNamespace),e=e||{},e.name||(e.name=this.namespace),(document.URL.split("/local/")[1]||typeof socketUrl>"u"&&!e.connLink||typeof socketUrl<"u"&&socketUrl==="local")&&(this._type="local"),this._type==="local"){this._isConnected=!0,this._isAuthDone=!0,this._connCallbacks.onConnChange&&this._connCallbacks.onConnChange(!0),typeof app<"u"&&app.onConnChange(!0),this._resolveAuth(!0);return}if(typeof io>"u"){console.error("socket.io not loaded!");return}let o=e.connLink||window.localStorage.getItem("connLink");!o&&typeof socketUrl<"u"&&(o=socketUrl),e.socketSession=e.socketSession||(typeof socketSession<"u"?socketSession:"nokey"),e.socketForceWebSockets===void 0&&typeof socketForceWebSockets<"u"&&(e.socketForceWebSockets=socketForceWebSockets);let a;o?(a=o,o[0]===":"&&(a=`${location.protocol}//${location.hostname}${o}`)):a=`${location.protocol}//${location.host}`,this._socket=io.connect(a,{query:"key="+e.socketSession,"reconnection limit":1e4,"max reconnection attempts":1/0,reconnection:!1,upgrade:!e.socketForceWebSockets,rememberUpgrade:e.socketForceWebSockets,transports:e.socketForceWebSockets?["websocket"]:void 0}),this._socket.on("connect",()=>this._onSocketConnect(e,r)),this._socket.on("reauthenticate",()=>this._onSocketReauthenticate()),this._socket.on("connect_error",()=>this._onSocketConnectError(e)),this._socket.on("disconnect",()=>this._onSocketDisconnect(e)),this._socket.on("reconnect",()=>this._onSocketReconnect()),this._socket.on("objectChange",(i,s)=>this._onSocketObjectChange(i,s)),this._socket.on("stateChange",(i,s)=>this._onSocketStateChange(i,s)),this._socket.on("permissionError",i=>this._onSocketPermissionError(i))}_onSocketConnect(e,n){if(this._disconnectedSince){let a=new Date().getTime()-this._disconnectedSince;console.log(`was offline for ${a/1e3}s`),this._reloadInterval&&a>this._reloadInterval*1e3&&window.location.reload(),this._disconnectedSince=null}this._connectInterval&&(clearInterval(this._connectInterval),this._connectInterval=null),this._countInterval&&(clearInterval(this._countInterval),this._countInterval=null);let r=document.getElementById("server-disconnect");r&&(r.style.display="none"),this._socket.emit("name",e.name),console.log(new Date().toISOString()+" Connected => authenticate");let o=setTimeout(()=>{console.error("No answer from server"),window.location.reload()},3e3);this._socket.emit("authenticate",(a,i)=>{clearTimeout(o),console.log(new Date().toISOString()+" Authenticated: "+a),a?this._onAuth(n,i):(console.log("permissionError"),this._rejectAuth(new Error("Permission Error")))})}_onAuth(e,n){if(this._isAuthDone=!0,this._isSecure=n,this._isSecure&&(this._lastTimer=new Date().getTime(),this._monitor()),e&&this._socket.emit("subscribeObjects","*"),this._isConnected===!0){this._resolveAuth(!0);return}this._isConnected=!0,this._connCallbacks.onConnChange&&setTimeout(()=>{this._socket.emit("authEnabled",(r,o)=>{this.user=o,this._connCallbacks.onConnChange(this._isConnected),typeof app<"u"&&app.onConnChange(this._isConnected)})},0),this._resolveAuth(!0)}_onSocketReauthenticate(){this._connCallbacks.onConnChange&&(this._connCallbacks.onConnChange(!1),typeof app<"u"&&app.onConnChange(!1)),console.warn("reauthenticate"),window.location.reload()}_onSocketConnectError(e){typeof $<"u"&&$(".splash-screen-text").css("color","#002951"),this.reconnect(e)}_onSocketDisconnect(e){if(this._disconnectedSince=new Date().getTime(),this._isConnected=!1,this._authPromise=new Promise((n,r)=>{this._resolveAuth=n,this._rejectAuth=r}),this._connCallbacks.onConnChange)setTimeout(()=>{let n=document.getElementById("server-disconnect");n&&(n.style.display=""),this._connCallbacks.onConnChange(this._isConnected),typeof app<"u"&&app.onConnChange(this._isConnected)},5e3);else{let n=document.getElementById("server-disconnect");n&&(n.style.display="")}this.reconnect(e)}_onSocketReconnect(){let e=new Date().getTime()-(this._disconnectedSince||0);console.log(`was offline for ${e/1e3}s`),this._reloadInterval&&e>this._reloadInterval*1e3&&window.location.reload()}_onSocketObjectChange(e,n){this._useStorage&&typeof storage<"u",this._connCallbacks.onObjectChange&&this._connCallbacks.onObjectChange(e,n)}_onSocketStateChange(e,n){!e||n===null||typeof n!="object"||this._connCallbacks.onUpdate&&this._connCallbacks.onUpdate(e,n)}_onSocketPermissionError(e){this._connCallbacks.onError?this._connCallbacks.onError(e):console.log("permissionError",e)}async _checkReady(e){if(this._type==="local")return!0;if(!this._authPromise)throw console.error(`Connection not initialized. Call .init() first for ${e}`),new Error("Connection not initialized");if(await this._authPromise,!this._isConnected)throw console.log(`No connection for ${e}`),new Error("No connection");if(this._socket===null)throw console.log(`socket.io not initialized for ${e}`),new Error("Socket.io not initialized");if(!this._isAuthDone)throw console.warn(`Auth not done for ${e}. Race condition?`),new Error("Authentication not complete");return!0}getType=()=>this._type;getIsConnected=()=>this._isConnected;getIsLoginRequired=()=>this._isSecure;getUser=()=>this.user;setReloadTimeout=e=>{this._reloadInterval=parseInt(e,10)};setReconnectInterval=e=>{this._reconnectInterval=parseInt(e,10)};reconnect(e){(!e.mayReconnect||e.mayReconnect())&&!this._connectInterval&&(this._connectInterval=setInterval(()=>{console.log("Trying connect..."),this._socket.connect()},this._reconnectInterval))}async getVersion(){return await this._checkReady("getVersion"),new Promise(e=>{this._socket.emit("getVersion",(n,r)=>{e(r)})})}async sendTo(e,n,r){return await this._checkReady("sendTo"),new Promise((o,a)=>{this._socket.emit("sendTo",e,n,r,i=>{i&&i.error?a(new Error(i.error)):o(i)})})}async getObjectView(e,n,r){return await this._checkReady("getObjectView"),new Promise((o,a)=>{this._socket.emit("getObjectView",e,n,r,(i,s)=>{i?a(i):o(s)})})}async getObject(e){return await this._checkReady("getObject"),new Promise((n,r)=>{this._socket.emit("getObject",e,(o,a)=>{o?r(o):n(a)})})}async getStates(e){return this._type==="local"?{}:(await this._checkReady("getStates"),new Promise((n,r)=>{this._socket.emit("getStates",e,(o,a)=>{o||!a?r(o||"Authentication required"):n(a)})}))}async subscribeState(e){return await this._checkReady("subscribeState"),new Promise(n=>{this._socket.emit("subscribe",e,()=>{n()})})}async unsubscribeState(e){return await this._checkReady("unsubscribeState"),new Promise(n=>{this._socket.emit("unsubscribe",e,()=>{n()})})}async getObjects(e=!1){if(this._useStorage&&e){if(typeof storage<"u"){let n=this._objects||storage.get("objects");if(n)return n}else if(this._objects)return this._objects}await this._checkReady("getObjects");try{let[n,r]=await new Promise(u=>{this._socket.emit("getObjects",(c,g)=>u([c,g]))});if(n)throw n;let o=await this.getObjectView("system","enum",{startkey:"enum.",endkey:"enum.\u9999"}),a={};for(let u of o.rows)r[u.id]=u.value,a[u.id]=u.value;let i=await this.getObjectView("system","instance",{startkey:"system.adapter.",endkey:"system.adapter.\u9999"});for(let u of i.rows)r[u.id]=u.value;let s=await this.getObjectView("system","channel",{startkey:"",endkey:"\u9999"});for(let u of s.rows)r[u.id]=u.value;let l=await this.getObjectView("system","device",{startkey:"",endkey:"\u9999"});for(let u of l.rows)r[u.id]=u.value;return this._useStorage&&(this._fillChildren(r),this._objects=r,typeof storage<"u"&&(storage.set("objects",r),storage.set("enums",a),storage.set("timeSync",new Date().getTime()))),r}catch(n){throw console.error("Error in getObjects:",n),n}}async readFile(e,n=!1){if(this._type==="local")try{let o=storage.get(e);return{data:o?JSON.parse(o):null}}catch(o){throw o}if(await this._checkReady("readFile"),!n&&typeof app<"u")return new Promise((o,a)=>{app.readLocalFile(e.replace(/^\/vis\.0\//,""),(i,s,l)=>{i?a(i):o({data:s,mimeType:l})})});let r=this.namespace;if(e[0]==="/"){let o=e.split("/");r=o[1],o.splice(0,2),e=o.join("/")}return new Promise((o,a)=>{this._socket.emit("readFile",r,e,(i,s,l)=>{i?a(i):o({data:s,mimeType:l})})})}_monitor(){if(this._timer)return;let e=new Date().getTime();this._reloadInterval&&e-this._lastTimer>this._reloadInterval*1e3?window.location.reload():this._lastTimer=e,this._timer=setTimeout(()=>{this._timer=null,this._monitor()},1e4)}_fillChildren(e){let n=Object.keys(e).sort();for(let r=0;r<n.length;r++){let o=n[r];if(e[o].common){let a=r+1,i=[],s=o.length+1,l=o+".";for(;a<n.length&&n[a].substring(0,s)===l;)i.push(n[a++]);e[o].children=i}}}};var U=3,et={ROBOT_SIZE_BASE:5,CHARGER_SIZE_BASE:3,OBSTACLE_RADIUS_BASE:3,ZONE_STROKE_BASE:1.5,ZONE_HANDLE_RADIUS_BASE:5,PIN_WIDTH_BASE:29,PIN_HEIGHT_BASE:24,PIN_Y_OFFSET_BASE:5,PATH_MOP_WIDTH_BASE:6.5,PATH_MAIN_WIDTH_RATIO_BASE:.8,PATH_BACKWASH_WIDTH_BASE:.5},ca={[-99]:"99",0:"0",1:"1",2:"2",3:"3",4:"3",5:"5_cn",9:"9",10:"10",18:"18",25:"25",26:"26",27:"26",34:"10",42:"18",48:"48",49:"49",50:"49",51:"51",54:"54",65:"65",67:"67",69:"69",70:"70",99:"99"};function Wr(t){return`projects_comroborocktanos_resources_obstacle_new_p${t}.png`}function ha(t){return`projects_comroborocktanos_resources_map_object_top_${t}.png`}var Ve=class{connection;instanceId="";currentRobotDuid=null;onStateChange=null;currentMapSubscriptions=[];map;mapImage;mapMinX=0;mapMinY=0;mapSizeX=0;mapSizeY=0;mapMaxY=0;goToTarget=!1;zoomLevel=.55;image=new Image;initialTransform;svg;svgContainer;mainGroup;mapImageElement;carpetGroup;pathGroup;mopPathGroup;backwashPathGroup;pureCleanPathGroup;chargerGroup;robotGroup;roomNameGroup;zoneGroup;obstacleGroup;pinGroup;zoom;wheelZoom=1;minZoom=.1;maxZoom=10;popupTimeout=null;popupX=0;popupY=0;selectedObstacleID;model=null;robotModels={};rects=[];zones=[];rectCounter=0;popup;popupImage;triangle;largePhoto;largePhotoImage;largePhotoBBox;robotSelect;deleteButton;addButton;startButton;pauseButton;stopButton;dockButton;goToButton;resetZoomButton;constructor(){this.connection=new Se,this.svg=E(null),this.svgContainer=E(null),this.mainGroup=E(null),this.mapImageElement=E(null),this.carpetGroup=E(null),this.pathGroup=E(null),this.mopPathGroup=E(null),this.backwashPathGroup=E(null),this.pureCleanPathGroup=E(null),this.chargerGroup=E(null),this.robotGroup=E(null),this.roomNameGroup=E(null),this.zoneGroup=E(null),this.obstacleGroup=E(null),this.pinGroup=E(null),this.zoom=be()}async init(){this.bindDomElements(),this.setupD3(),this.setupConnection(),this.bindUiEvents()}bindDomElements(){let e=n=>{let r=document.getElementById(n);if(!r)throw new Error(`Missing DOM element: ${n}`);return r};this.popup=e("popup"),this.popupImage=e("popup-image"),this.triangle=e("triangle"),this.largePhoto=e("largePhoto"),this.largePhotoImage=e("largePhoto-image"),this.largePhotoBBox=e("largePhoto-bbox"),this.robotSelect=e("robotSelect"),this.deleteButton=e("deleteButton"),this.addButton=e("addButton"),this.startButton=e("startButton"),this.pauseButton=e("pauseButton"),this.stopButton=e("stopButton"),this.dockButton=e("dockButton"),this.goToButton=e("goToButton"),this.resetZoomButton=e("resetZoomButton")}setupD3(){this.svgContainer=E("#mapSvgContainer"),this.svg=E("#mapSvg"),this.mainGroup=this.svg.append("g").attr("class","main-group"),this.mapImageElement=this.mainGroup.append("image").attr("class","map-image"),this.carpetGroup=this.mainGroup.append("g").attr("class","carpet"),this.mopPathGroup=this.mainGroup.append("g").attr("class","mop-paths").style("opacity",.18),this.pathGroup=this.mainGroup.append("g").attr("class","paths").style("opacity",.5),this.backwashPathGroup=this.mainGroup.append("g").attr("class","backwash-paths").style("opacity",.2),this.pureCleanPathGroup=this.mainGroup.append("g").attr("class","pure-clean-paths"),this.chargerGroup=this.mainGroup.append("g").attr("class","charger"),this.obstacleGroup=this.mainGroup.append("g").attr("class","obstacles"),this.zoneGroup=this.mainGroup.append("g").attr("class","zones"),this.robotGroup=this.mainGroup.append("g").attr("class","robot"),this.pinGroup=this.mainGroup.append("g").attr("class","pins"),this.roomNameGroup=this.mainGroup.append("g").attr("class","room-names"),this.pinGroup.append("image").attr("class","goto-pin").attr("href",Lr).attr("width",29).attr("height",24).style("opacity",0).style("display","none").style("pointer-events","none"),this.zoom=be().scaleExtent([this.minZoom,this.maxZoom]).on("zoom",e=>this.handleZoom(e)),this.svgContainer.call(this.zoom)}setupConnection(){let e=this.getQueryParam("instance");if(e===null){document.body.innerHTML="<h1>Error: No instance specified in URL.</h1>";return}this.instanceId=`roborock.${e}`;let n={onConnChange:async o=>{o&&this.fetchRobotList()},onUpdate:(o,a)=>{this.onStateChange&&this.onStateChange(o,a)},onError:o=>{console.error("Connection error:",o)}},r=`${window.location.protocol}//${window.location.hostname}:${window.location.port}`;this.connection.init({name:this.instanceId,connLink:r},n,!0)}fetchRobotList(){let e=`${this.instanceId}.Devices.`,n=`${this.instanceId}.Devices.\u9999`;this.connection.getObjectView("system","device",{startkey:e,endkey:n}).then(r=>{let o=[];if(r&&r.rows&&r.rows.forEach(i=>{let s=i.id.split("."),l=s[s.length-1],u=i.value&&i.value.common&&i.value.common.name?i.value.common.name:l,c=i.value?.native?.model||i.value?.native?.deviceInfo?.model||null;l&&(o.push({duid:l,name:u}),c&&(this.robotModels[l]=c))}),o.length===0){let i=this.getQueryParam("instance");if(i){this.robotSelect.innerHTML="";let s=document.createElement("option");s.value=i,s.text=`Roborock (Instance ${i})`,this.robotSelect.appendChild(s),this.currentRobotDuid=i,this.setupSocketListeners(i)}return}if(this.robotSelect.innerHTML="",o.forEach(i=>{let s=document.createElement("option");s.value=i.duid,s.text=i.name,this.robotSelect.appendChild(s)}),o.length>0){let i=o[0].duid;this.currentRobotDuid=i,this.robotSelect.value=i,this.setupSocketListeners(i)}let a=`${this.instanceId}.HomeData`;this.connection.getStates([a]).then(i=>{let s=i[a];if(s&&s.val)try{let l=typeof s.val=="string"?JSON.parse(s.val):s.val,u={};l.products&&l.products.forEach(g=>{g.id&&g.model&&(u[g.id]=g.model)});let c=g=>{g&&g.forEach(f=>{f.duid&&f.productId&&u[f.productId]&&(this.robotModels[f.duid]=u[f.productId])})};c(l.devices),c(l.receivedDevices),this.currentRobotDuid&&this.robotModels[this.currentRobotDuid]&&(this.model=this.robotModels[this.currentRobotDuid],this.map&&this.map.OBSTACLES2&&this.drawObstacles(this.map.OBSTACLES2))}catch(l){console.error("Failed to parse HomeData:",l)}})}).catch(r=>console.error("Error fetching robot list:",r))}setupSocketListeners(e){this.onStateChange&&this.currentMapSubscriptions.length>0&&(this.currentMapSubscriptions.forEach(o=>{this.connection.unsubscribeState(o)}),this.currentMapSubscriptions=[]),this.map=void 0,this.mapImage=void 0,this.mapImageElement.attr("href",null),this.carpetGroup.selectAll("*").remove(),this.obstacleGroup.selectAll("*").remove(),this.pinGroup.select("image.goto-pin").style("display","none").style("opacity",0),this.robotGroup.selectAll("*").remove(),this.chargerGroup.selectAll("*").remove(),this.roomNameGroup.selectAll("*").remove(),this.pathGroup.selectAll("*").remove(),this.mopPathGroup.selectAll("*").remove(),this.backwashPathGroup.selectAll("*").remove(),this.pureCleanPathGroup.selectAll("*").remove(),this.rects=[],this.drawZones(),this.deleteButton.disabled=!0,this.addButton.disabled=!1;let n=`${this.instanceId}.Devices.${e}.map.mapBase64Clean`,r=`${this.instanceId}.Devices.${e}.map.mapData`;this.currentMapSubscriptions=[n,r],this.onStateChange=(o,a)=>{if(!a||!a.val){o===n&&this.mapImageElement.attr("href",null),o===r&&(this.map=void 0,this.robotGroup.selectAll("*").remove());return}switch(o){case n:this.pinGroup.select("image.goto-pin").style("display","none").style("opacity",0),this.drawBackgroundImage(a.val);break;case r:try{this.map=typeof a.val=="string"?JSON.parse(a.val):a.val,this.map&&this.map.IMAGE&&(this.model=this.map.model??this.robotModels[this.currentRobotDuid]??null,this.mapImage=this.map.IMAGE,this.updateMapImageSize(),this.drawRobotAndCharger(this.map.ROBOT_POSITION,this.map.CHARGER_LOCATION),this.drawPaths(this.map.PATH,this.map.MOP_PATH),this.drawObstacles(this.map.OBSTACLES2),this.drawRoomNames(this.map.IMAGE.segments.list),this.drawCarpet(this.map.CARPET_MAP))}catch(i){console.error("Failed to parse map data JSON:",a.val,i)}break}},this.connection.subscribeState(n),this.connection.subscribeState(r),this.connection.getStates([n,r]).then(o=>{this.onStateChange&&(this.robotModels[e]&&(this.model=this.robotModels[e]),this.onStateChange(n,o[n]),this.onStateChange(r,o[r]))})}updateMapImageSize(){if(!this.image.naturalWidth||!this.image.naturalHeight)return;let e=this.image.naturalWidth,n=this.image.naturalHeight;this.mapImageElement.attr("href",this.image.src).attr("width",e).attr("height",n).attr("transform",null).style("image-rendering","pixelated")}drawBackgroundImage(e){if(!e){this.mapImageElement.attr("href",null);return}this.image.src=e,this.image.onload=()=>{let n=document.createElement("canvas"),r=n.getContext("2d",{willReadFrequently:!0});if(!r)return;n.width=this.image.width,n.height=this.image.height,r.imageSmoothingEnabled=!1,r.drawImage(this.image,0,0);let o=0;this.mapMaxY=0,this.mapMinX=this.image.width,this.mapMinY=this.image.height;let i=r.getImageData(0,0,this.image.width,this.image.height).data;for(let p=0;p<i.length;p+=4)if(i[p+3]>50){let b=p/4%this.image.width,v=Math.floor(p/4/this.image.width);b<this.mapMinX&&(this.mapMinX=b),b>o&&(o=b),v<this.mapMinY&&(this.mapMinY=v),v>this.mapMaxY&&(this.mapMaxY=v)}this.mapMinX>o&&(this.mapMinX=0,o=this.image.width,this.mapMinY=0,this.mapMaxY=this.image.height),this.mapSizeX=o-this.mapMinX,this.mapSizeY=this.mapMaxY-this.mapMinY,this.mapSizeX<=0&&(this.mapSizeX=this.image.width),this.mapSizeY<=0&&(this.mapSizeY=this.image.height),this.updateMapImageSize(),this.carpetGroup.attr("transform",null);let s=parseFloat(this.svg.attr("width"))||800,l=parseFloat(this.svg.attr("height"))||600,u=s/l;this.mapSizeX/this.mapSizeY>u?this.zoomLevel=this.roundTwoDecimals(s*.95/this.mapSizeX):this.zoomLevel=this.roundTwoDecimals(l*.95/this.mapSizeY),this.zoomLevel<.1&&(this.zoomLevel=.1);let g=this.mapMinX+this.mapSizeX/2,f=this.mapMinY+this.mapSizeY/2;this.initialTransform=Ct.translate(s/2,l/2).scale(this.zoomLevel).translate(-g,-f),this.svgContainer.call(this.zoom.transform,this.initialTransform),this.map&&(this.drawRobotAndCharger(this.map.ROBOT_POSITION,this.map.CHARGER_LOCATION),this.drawPaths(this.map.PATH,this.map.MOP_PATH),this.drawObstacles(this.map.OBSTACLES2),this.drawRoomNames(this.map.IMAGE.segments.list),this.drawCarpet(this.map.CARPET_MAP))}}drawRobotAndCharger(e,n){if(this.robotGroup.selectAll("image.robot").remove(),this.chargerGroup.selectAll("image.charger").remove(),!e&&!n)return;let r=this.getMapParams();if(!r)return;let o=this.rescaler.chargerSize(),a=this.rescaler.robotSize(),i=n?[n]:[],s=this.chargerGroup.selectAll("image.charger").data(i);s.exit().remove(),s.enter().append("image").attr("class","charger").attr("href",Gr).merge(s).attr("width",o).attr("height",o).attr("x",c=>this.robotToSvg({x:c.position[0],y:c.position[1]},r).x-o/2).attr("y",c=>this.robotToSvg({x:c.position[0],y:c.position[1]},r).y-o/2);let l=e?[e]:[],u=this.robotGroup.selectAll("image.robot").data(l);u.exit().remove(),u.enter().append("image").attr("class","robot").attr("href",Hr).merge(u).attr("width",a).attr("height",a).attr("transform",c=>{let g=this.robotToSvg({x:c.position[0],y:c.position[1]},r),f=-(c.angle??0)+90;return`translate(${g.x}, ${g.y}) rotate(${f}) translate(${-a/2}, ${-a/2})`})}drawRoomNames(e){let n=this.getMapParams();if(!n||!e){this.roomNameGroup.selectAll("text.room-name").remove();return}let r=12,o=2.5,a=this.roomNameGroup.selectAll("text.room-name").data(e,i=>i.id);a.exit().remove(),a.enter().append("text").attr("class","room-name").attr("text-anchor","middle").attr("dominant-baseline","middle").style("fill","#000").style("stroke","white").style("pointer-events","none").style("font-weight","900").style("font-size",`${r}px`).style("stroke-width",`${o}px`).style("paint-order","stroke").attr("shape-rendering","geometricPrecision").merge(a).text(i=>i.name).attr("x",i=>i.center&&typeof i.center[0]=="number"&&!isNaN(i.center[0])?this.robotToSvg({x:i.center[0],y:i.center[1]},n).x:-1e3).attr("y",i=>i.center&&typeof i.center[1]=="number"&&!isNaN(i.center[1])?this.robotToSvg({x:i.center[0],y:i.center[1]},n).y:-1e3)}drawPaths(e,n){let r=this.getMapParams();if(!r||!e?.points||!n){this.pathGroup.selectAll("*").remove(),this.mopPathGroup.selectAll("*").remove(),this.backwashPathGroup.selectAll("*").remove(),this.pureCleanPathGroup.selectAll("*").remove();return}let o=U,a=Yr(e.points,n,(p,y)=>this.robotToSvg({x:p[0],y:p[1]},y),o,r),i=this.rescaler.pathMopWidth(),s=this.rescaler.pathMainWidth(),l=this.rescaler.pathBackwashWidth(),u=this.pathGroup.selectAll("path.main-path").data(a.mainPathD?[a.mainPathD]:[]);u.exit().remove(),u.enter().append("path").attr("class","main-path").merge(u).attr("d",p=>p).style("fill","none").style("stroke","rgba(255,255,255,1.0)").style("stroke-width",`${s}px`).style("stroke-linecap","round").style("stroke-linejoin","round");let c=this.backwashPathGroup.selectAll("path.backwash-path").data(a.backwashPathD?[a.backwashPathD]:[]);c.exit().remove(),c.enter().append("path").attr("class","backwash-path").merge(c).attr("d",p=>p).style("fill","none").style("stroke","rgba(255,255,255,1.0)").style("stroke-width",`${l}px`).style("stroke-dasharray","4, 8").style("stroke-linecap","round").style("stroke-linejoin","round");let g=this.pureCleanPathGroup.selectAll("path.pure-clean-path").data(a.pureCleanPathD?[a.pureCleanPathD]:[]);g.exit().remove(),g.enter().append("path").attr("class","pure-clean-path").merge(g).attr("d",p=>p).style("fill","none").style("stroke","rgba(255,255,255,1.0)").style("stroke-width",`${l}px`).style("stroke-linecap","round").style("stroke-linejoin","round");let f=this.mopPathGroup.selectAll("path.mop-path").data(a.mopPathD?[a.mopPathD]:[]);f.exit().remove(),f.enter().append("path").attr("class","mop-path").merge(f).attr("d",p=>p).style("fill","none").style("stroke","rgba(255,255,255,1.0)").style("stroke-width",`${i}px`).style("stroke-linecap","round").style("stroke-linejoin","round")}drawObstacles(e){let n=this.getMapParams();if(!n||!e){this.obstacleGroup.selectAll(".obstacle-group").remove();return}let r=this.rescaler.scale()*et.OBSTACLE_RADIUS_BASE,o=r*1.1,a=r*1.8,i=this.obstacleGroup.selectAll(".obstacle-group").data(e);i.exit().remove();let s=i.enter().append("g").attr("class","obstacle-group").style("cursor","default").on("click",(f,p)=>{if(!this.currentRobotDuid)return;f.stopPropagation(),this.selectedObstacleID=p[6];let y={x:p[0],y:p[1]},b=Qe(y,n);this.popupX=b.x,this.popupY=b.y,this.popupTimeout&&clearTimeout(this.popupTimeout),this.connection.sendTo(this.instanceId,"get_obstacle_image",{obstacleId:this.selectedObstacleID,duid:this.currentRobotDuid,type:1}).then(v=>{if(v&&v.image){let A=v.image;typeof A=="string"&&!A.startsWith("data:image/")&&(A="data:image/png;base64,"+A),this.popupImage.src=A,this.popup.style.display="block",this.triangle.style.display="block",this.updatePopupPosition(),this.popupTimeout=window.setTimeout(()=>{this.popup.style.display="none",this.triangle.style.display="none",this.popupTimeout=null},3e3)}else v&&v.data&&v.version}).catch(v=>console.error("Error getting obstacle image:",v)),this.updatePopupPosition()});s.append("circle").attr("class","obstacle-bg").attr("r",o).attr("fill","rgba(100, 100, 100, 0.2)").attr("stroke","white").attr("stroke-width",.5),s.append("image").attr("class","obstacle-icon").attr("width",a).attr("height",a).attr("x",-a/2).attr("y",-a/2);let l=s.merge(i);l.attr("transform",f=>{let p=this.robotToSvg({x:f[0]+25,y:f[1]+25},n);return`translate(${p.x}, ${p.y})`});let c=`assets/${this.model||this.currentRobotDuid&&this.robotModels[this.currentRobotDuid]||(Object.keys(this.robotModels).length?this.robotModels[Object.keys(this.robotModels)[0]]:null)||"roborock.vacuum.a147"}/drawable-mdpi/`,g=c+Wr("18");l.select("image").attr("href",g).each(function(f){let p=ca[Number(f[2])]??"18";if(p==="18")return;let y=c+Wr(p),b=c+ha(p),v=this,A=new Image,O=()=>{A.onload=()=>{E(v).attr("href",b)},A.onerror=()=>{},A.src=b};A.onload=()=>{E(v).attr("href",y)},A.onerror=O,A.src=y})}drawCarpet(e){if(!e||!this.mapImage||!this.mapImage.dimensions){this.carpetGroup.selectAll("*").remove();return}let n=this.mapImage.dimensions.width,r=this.mapImage.dimensions.height,o=3,a=[],i=0,s=0;e.forEach(c=>{let g=c%n,f=Math.floor(c/n),p=r-f-1,y=g*U+i,b=p*U+s;for(let v=0;v<U;v++)for(let A=0;A<U;A++)(v+A)%o===2&&a.push(`M${y+v} ${b+A}h1v1h-1z`)});let l=a.join(""),u=this.carpetGroup.selectAll("path.carpet-path").data([l]);u.exit().remove(),u.enter().append("path").attr("class","carpet-path").style("fill","rgba(0, 0, 0, 0.4)").attr("shape-rendering","crispEdges").merge(u).attr("d",c=>c)}drawZones(){let e=$t().on("start",i=>{let s=i.sourceEvent.target.closest("g.zone");s&&E(s).raise().style("cursor","grabbing"),this.deleteButton.disabled=!1}).on("drag",(i,s)=>{if(!this.mapImage)return;let l=this.mapMinX,u=this.mapMinY,c=this.mapMinX+this.mapSizeX,g=this.mapMinY+this.mapSizeY,f=Math.max(l,s.x+i.dx),p=Math.max(u,s.y+i.dy);f+s.width>c&&(f=c-s.width),p+s.height>g&&(p=g-s.height),s.x=f,s.y=p;let y=i.sourceEvent.target.closest("g.zone");y&&E(y).attr("transform",`translate(${s.x}, ${s.y})`)}).on("end",i=>{let s=i.sourceEvent.target.closest("g.zone");s&&E(s).style("cursor","move"),this.updateRobotZones()}),n=$t().on("start",i=>{i.sourceEvent.stopPropagation();let s=i.sourceEvent.target;s&&E(s).raise()}).on("drag",(i,s)=>{if(!this.mapImage)return;let l=this.mapMinX+this.mapSizeX,u=this.mapMinY+this.mapSizeY,c=Math.max(s.width+i.dx,20),g=Math.max(s.height+i.dy,20);s.x+c>l&&(c=l-s.x),s.y+g>u&&(g=u-s.y),s.width=c,s.height=g;let f=i.sourceEvent.target;if(f){let p=E(f.parentNode);p.select("rect").attr("width",s.width).attr("height",s.height),p.select("circle.zone-handle").attr("cx",s.width).attr("cy",s.height)}}).on("end",()=>this.updateRobotZones()),r=this.zoneGroup.selectAll("g.zone").data(this.rects,i=>i.id);r.exit().remove();let o=r.enter().append("g").attr("class","zone").call(e);o.append("rect").attr("class","zone-rect").attr("x",0).attr("y",0).style("stroke-width",this.rescaler.zoneStrokeWidth()),o.append("circle").attr("class","zone-handle").attr("r",this.rescaler.zoneHandleRadius()).call(n);let a=r.merge(o);a.attr("transform",i=>`translate(${i.x}, ${i.y})`),a.select("rect").attr("width",i=>i.width).attr("height",i=>i.height).style("stroke-width",this.rescaler.zoneStrokeWidth()),a.select("circle.zone-handle").attr("cx",i=>i.width).attr("cy",i=>i.height).attr("r",this.rescaler.zoneHandleRadius())}updateRobotZones(){let e=this.getMapParams();if(!e)return;let n=document.getElementById("cleanCount");this.zones=[];let r=parseInt(n.value)||1;for(let o of this.rects){let a={x:o.x,y:o.y},i={x:o.x+o.width,y:o.y+o.height},s=ve(a,e),l=ve(i,e);this.zones.push([Math.min(s.x,l.x),Math.min(s.y,l.y),Math.max(s.x,l.x),Math.max(s.y,l.y),r])}}updatePopupPosition(){if(this.popup.style.display==="block"&&this.popupX!==void 0&&this.popupY!==void 0){let e=yt(this.svgContainer.node()),n=this.worldToSvgCoords(this.popupX,this.popupY),r=e.apply([n.x,n.y]);this.popup.style.left=`${r[0]}px`,this.popup.style.top=`${r[1]}px`}}handleZoom(e){let n=e.transform;this.mainGroup.attr("transform",n),this.wheelZoom=n.k,this.zoneGroup.selectAll("rect.zone-rect").style("stroke-width",this.rescaler.zoneStrokeWidth()),this.zoneGroup.selectAll("circle.zone-handle").attr("r",this.rescaler.zoneHandleRadius());let r=this.rescaler.robotSize();this.robotGroup.selectAll("image.robot").attr("width",r).attr("height",r).attr("transform",l=>{let u=this.getMapParams();if(!u)return"";let c=this.robotToSvg({x:l.position[0],y:l.position[1]},u),g=-(l.angle??0)+90;return`translate(${c.x}, ${c.y}) rotate(${g}) translate(${-r/2}, ${-r/2})`});let o=this.rescaler.chargerSize();this.chargerGroup.selectAll("image.charger").attr("width",o).attr("height",o).attr("x",l=>{let u=this.getMapParams();return u?this.robotToSvg({x:l.position[0],y:l.position[1]},u).x-o/2:0}).attr("y",l=>{let u=this.getMapParams();return u?this.robotToSvg({x:l.position[0],y:l.position[1]},u).y-o/2:0}),this.pathGroup.selectAll("path.main-path").style("stroke-width",`${this.rescaler.pathMainWidth()}px`),this.backwashPathGroup.selectAll("path.backwash-path").style("stroke-width",`${this.rescaler.pathBackwashWidth()}px`),this.mopPathGroup.selectAll("path.mop-path").style("stroke-width",`${this.rescaler.pathMopWidth()}px`),this.pureCleanPathGroup.selectAll("path.pure-clean-path").style("stroke-width",`${this.rescaler.pathBackwashWidth()}px`);let a=this.rescaler.pinWidth(),i=this.rescaler.pinHeight(),s=this.rescaler.pinYOffset();this.pinGroup.selectAll("image.goto-pin").attr("width",a).attr("height",i).attr("x",function(){let l=E(this).attr("data-center-x");return(parseFloat(l)||0)-a/2}).attr("y",function(){let l=E(this).attr("data-center-y");return(parseFloat(l)||0)-(i-s)}),this.updatePopupPosition()}getMapParams(){return!this.mapImage||!this.mapImage.dimensions||this.mapMaxY===void 0?null:{scaleFactor:U,left:this.mapImage.position.left,topMap:this.mapImage.position.top,mapMaxY:this.mapMaxY,imageHeight:this.mapImage.dimensions.height,imageWidth:this.mapImage.dimensions.width}}screenToWorldCoords(e,n){if(this.mapMinX===void 0||this.mapMinY===void 0)return{x:0,y:0};let o=yt(this.svgContainer.node()).invert([e,n]);return{x:o[0],y:o[1]}}worldToSvgCoords(e,n){return{x:e,y:n}}robotToSvg(e,n){let r=Qe(e,n);return this.worldToSvgCoords(r.x,r.y)}roundTwoDecimals(e){return Math.round(e*100)/100}getQueryParam(e){return new URLSearchParams(window.location.search).get(e)}bindUiEvents(){this.robotSelect.addEventListener("change",()=>{let e=this.robotSelect.value;e&&e!==this.currentRobotDuid&&(this.currentRobotDuid=e,this.setupSocketListeners(e))}),this.deleteButton.addEventListener("click",()=>{this.rects.length>0&&(this.rects.pop(),this.drawZones(),this.rects.length<5&&(this.addButton.disabled=!1),this.rects.length<1&&(this.deleteButton.disabled=!0))}),this.addButton.addEventListener("click",()=>{if(this.goToTarget){this.goToTarget=!1,this.svg.style("cursor","grab"),this.svgContainer.on("mousemove.gototarget",null),this.svgContainer.on("click.gototarget",null),this.pinGroup.select("image.goto-pin").style("display","none").style("opacity",0),this.goToButton.textContent="GoTo Point";return}let e=parseFloat(this.svg.attr("width")),n=parseFloat(this.svg.attr("height")),r=this.screenToWorldCoords(e/2,n/2),o=this.getMapParams();o&&(this.rects.push({id:this.rectCounter++,x:r.x-25*o.scaleFactor,y:r.y-25*o.scaleFactor,width:50*o.scaleFactor,height:50*o.scaleFactor}),this.drawZones(),this.rects.length>0&&(this.deleteButton.disabled=!1),this.rects.length>4&&(this.addButton.disabled=!0),this.updateRobotZones())}),this.startButton.addEventListener("click",()=>{if(!this.currentRobotDuid)return;this.updateRobotZones();let e=this.zones.length>0?"app_zoned_clean":"app_start",n=this.zones.length>0?{zones:this.zones,duid:this.currentRobotDuid}:{duid:this.currentRobotDuid};this.connection.sendTo(this.instanceId,e,n).catch(r=>console.error("Error sending command:",r)),this.rects=[],this.drawZones(),this.deleteButton.disabled=!0,this.addButton.disabled=!1,this.startButton.style.display="none",this.pauseButton.style.display="inline-block"}),this.pauseButton.addEventListener("click",()=>{this.currentRobotDuid&&(this.connection.sendTo(this.instanceId,"app_pause",{duid:this.currentRobotDuid}),this.startButton.style.display="inline-block",this.pauseButton.style.display="none")}),this.stopButton.addEventListener("click",()=>{this.currentRobotDuid&&(this.connection.sendTo(this.instanceId,"app_stop",{duid:this.currentRobotDuid}),this.startButton.style.display="inline-block",this.pauseButton.style.display="none")}),this.dockButton.addEventListener("click",()=>{this.currentRobotDuid&&this.connection.sendTo(this.instanceId,"app_charge",{duid:this.currentRobotDuid})}),this.goToButton.addEventListener("click",()=>{if(this.goToTarget){this.goToTarget=!1,this.svg.style("cursor","grab"),this.svgContainer.on("mousemove.gototarget",null),this.svgContainer.on("click.gototarget",null),this.pinGroup.select("image.goto-pin").style("display","none").style("opacity",0),this.goToButton.textContent="GoTo Point";return}this.goToTarget=!0,this.svg.style("cursor","none"),this.goToButton.textContent="Cancel";let e=yt(this.svgContainer.node()),n=parseFloat(this.svg.attr("width")),r=parseFloat(this.svg.attr("height")),[o,a]=e.invert([n/2,r/2]),i=this.rescaler.pinWidth(),s=this.rescaler.pinHeight(),l=this.rescaler.pinYOffset(),u=this.pinGroup.select("image.goto-pin");u.style("display","block").style("opacity",.7).attr("data-center-x",o).attr("data-center-y",a).attr("x",o-i/2).attr("y",a-(s-l)),this.svgContainer.on("mousemove.gototarget",c=>{let[g,f]=Y(c,this.mainGroup.node()),p=this.rescaler.pinWidth(),y=this.rescaler.pinHeight(),b=this.rescaler.pinYOffset();u.attr("data-center-x",g).attr("data-center-y",f).attr("x",g-p/2).attr("y",f-(y-b))}),this.svgContainer.on("click.gototarget",c=>{c.stopImmediatePropagation();let g=this.getMapParams();if(!this.currentRobotDuid||!g)return;let[f,p]=Y(c,this.mainGroup.node()),v=ve({x:f,y:p},g);this.connection.sendTo(this.instanceId,"app_goto_target",{points:[v.x,v.y],duid:this.currentRobotDuid}),u.style("opacity",1),this.goToTarget=!1,this.svg.style("cursor","grab"),this.svgContainer.on("mousemove.gototarget",null),this.svgContainer.on("click.gototarget",null),this.goToButton.textContent="GoTo Point"})}),this.resetZoomButton.addEventListener("click",()=>{this.initialTransform&&this.svgContainer.transition().duration(750).call(this.zoom.transform,this.initialTransform)}),this.popupImage.addEventListener("click",()=>{this.largePhoto.style.display="block",this.popup.style.display="none",this.triangle.style.display="none",this.popupTimeout&&clearTimeout(this.popupTimeout),this.popupTimeout=null,!(!this.currentRobotDuid||!this.selectedObstacleID)&&(this.largePhotoImage.src="",this.largePhotoBBox.style.display="none",this.connection.sendTo(this.instanceId,"get_obstacle_image",{obstacleId:this.selectedObstacleID,duid:this.currentRobotDuid,type:0}).then(e=>{if(e&&e.image){let n=e.image;typeof n=="string"&&!n.startsWith("data:image/")&&(n="data:image/png;base64,"+n),this.largePhotoImage.onload=()=>{if(e.bbox){let r=e.bbox,o=this.largePhotoImage.clientWidth,a=this.largePhotoImage.clientHeight;if(r.imageWidth>0&&r.imageHeight>0){let i=o/r.imageWidth,s=a/r.imageHeight;this.largePhotoBBox.style.left=r.x*i+"px",this.largePhotoBBox.style.top=r.y*s+"px",this.largePhotoBBox.style.width=r.w*i+"px",this.largePhotoBBox.style.height=r.h*s+"px",this.largePhotoBBox.style.display="block"}}},this.largePhotoImage.src=n.replace(/\s/g,"")}}).catch(e=>console.error("Error getting large obstacle image:",e)))}),this.largePhoto.addEventListener("click",()=>{this.largePhoto.style.display="none"})}get rescaler(){return{scale:()=>U,robotSize:()=>U*et.ROBOT_SIZE_BASE,chargerSize:()=>U*et.CHARGER_SIZE_BASE,zoneStrokeWidth:()=>et.ZONE_STROKE_BASE/this.wheelZoom,zoneHandleRadius:()=>et.ZONE_HANDLE_RADIUS_BASE/this.wheelZoom,pinWidth:()=>et.PIN_WIDTH_BASE/this.wheelZoom,pinHeight:()=>et.PIN_HEIGHT_BASE/this.wheelZoom,pinYOffset:()=>et.PIN_Y_OFFSET_BASE/this.wheelZoom,pathMopWidth:()=>et.PATH_MOP_WIDTH_BASE*U,pathMainWidth:()=>Math.max(1,U*et.PATH_MAIN_WIDTH_RATIO_BASE),pathBackwashWidth:()=>et.PATH_BACKWASH_WIDTH_BASE*U}}};window.onload=async()=>{new Ve().init().catch(e=>console.error("Failed to initialize Map Application:",e))};
//# sourceMappingURL=app.js.map
