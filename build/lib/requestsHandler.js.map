{"version":3,"file":"requestsHandler.js","sourceRoot":"","sources":["../../src/lib/requestsHandler.ts"],"names":[],"mappings":"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","sourcesContent":["// src/lib/requestsHandler.ts\r\nimport type { Roborock } from \"../main\";\r\nimport type { BaseDeviceFeatures } from \"./features/baseDeviceFeatures\";\r\nimport { MapCreator } from \"./mapCreator\";\r\nimport { MapDataParser } from \"./mapDataParser\";\r\nimport { gunzip } from \"zlib\";\r\nimport { promisify } from \"util\";\r\nimport PQueue from \"p-queue\";\r\nimport { messageParser } from \"./messageParser\";\r\n\r\ntype AbortSignalWithStatic = typeof AbortSignal & {\r\n\tany?(signals: AbortSignal[]): AbortSignal;\r\n\ttimeout?(ms: number): AbortSignal;\r\n};\r\n\r\nconst REQUEST_TIMEOUT = 30000;\r\nconst mappedCleanSummary: Record<string, string> = { 0: \"clean_time\", 1: \"clean_area\", 2: \"clean_count\", 3: \"records\" };\r\nconst mappedCleaningRecordAttribute: Record<string, string> = {\r\n\t0: \"begin\",\r\n\t1: \"end\",\r\n\t2: \"duration\",\r\n\t3: \"area\",\r\n\t4: \"error\",\r\n\t5: \"complete\",\r\n\t6: \"start_type\",\r\n\t7: \"clean_type\",\r\n\t8: \"finish_reason\",\r\n\t9: \"dust_collection_status\",\r\n};\r\n\r\nconst parameterFolders: Record<string, string> = {\r\n\tget_mop_mode: \"deviceStatus\",\r\n\tget_water_box_custom_mode: \"deviceStatus\",\r\n\tget_consumable: \"consumables\",\r\n\tget_carpet_mode: \"deviceStatus\",\r\n\tget_carpet_clean_mode: \"deviceStatus\",\r\n\tget_carpet_cleaning_mode: \"deviceStatus\",\r\n\tget_wash_towel_mode: \"deviceStatus\",\r\n\tget_smart_wash_params: \"deviceStatus\",\r\n\tget_dust_collection_switch_status: \"deviceStatus\",\r\n};\r\n\r\nconst gunzipAsync = promisify(gunzip);\r\n\r\n// ============================================================\r\n// Helper for AbortSignal compatibility (Node < 20)\r\n// ============================================================\r\nfunction anySignal(signals: AbortSignal[]): AbortSignal {\r\n\tif ((AbortSignal as AbortSignalWithStatic).any) {\r\n\t\treturn (AbortSignal as AbortSignalWithStatic).any!(signals);\r\n\t}\r\n\tconst controller = new AbortController();\r\n\tfor (const signal of signals) {\r\n\t\tif (signal.aborted) {\r\n\t\t\tcontroller.abort(signal.reason);\r\n\t\t\treturn controller.signal;\r\n\t\t}\r\n\t\tsignal.addEventListener(\"abort\", () => controller.abort(signal.reason), { once: true });\r\n\t}\r\n\treturn controller.signal;\r\n}\r\n\r\nfunction timeoutSignal(ms: number): AbortSignal {\r\n\tif ((AbortSignal as AbortSignalWithStatic).timeout) {\r\n\t\treturn (AbortSignal as AbortSignalWithStatic).timeout!(ms);\r\n\t}\r\n\tconst controller = new AbortController();\r\n\tsetTimeout(() => controller.abort(new Error(\"Timeout\")), ms);\r\n\treturn controller.signal;\r\n}\r\n\r\n// ============================================================\r\n// RequestManager Class\r\n// ============================================================\r\nclass RequestManager {\r\n\tqueue: PQueue;\r\n\ttimeoutMs: number;\r\n\ttasks: Map<string, AbortController>;\r\n\r\n\tconstructor(concurrency = 10, timeoutMs = 30000) {\r\n\t\tthis.queue = new PQueue({ concurrency });\r\n\t\tthis.timeoutMs = timeoutMs;\r\n\t\tthis.tasks = new Map();\r\n\t}\r\n\r\n\tadd<T>(id: string, taskFunction: (signal: AbortSignal) => Promise<T>, priority = 0): Promise<T> {\r\n\t\tconst manualController = new AbortController();\r\n\t\tthis.tasks.set(id, manualController);\r\n\r\n\t\treturn this.queue.add(async () => {\r\n\t\t\ttry {\r\n\t\t\t\tif (manualController.signal.aborted) {\r\n\t\t\t\t\tthrow new Error(\"ADAPTER_STOPPED\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst tSignal = timeoutSignal(this.timeoutMs);\r\n\t\t\t\tconst combinedSignal = anySignal([manualController.signal, tSignal]);\r\n\r\n\t\t\t\tconst result = await taskFunction(combinedSignal);\r\n\t\t\t\treturn result;\r\n\t\t\t} catch (error: unknown) {\r\n\t\t\t\tif (manualController.signal.aborted || (error instanceof Error && error.message === \"CANCELLED_BY_USER\")) {\r\n\t\t\t\t\tthrow new Error(`Task ${id} was cancelled manually.`);\r\n\t\t\t\t} else if (error instanceof Error && (error.name === \"TimeoutError\" || error.name === \"AbortError\")) {\r\n\t\t\t\t\tthrow new Error(`Task ${id} timed out after ${this.timeoutMs}ms.`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow error;\r\n\t\t\t\t}\r\n\t\t\t} finally {\r\n\t\t\t\tthis.tasks.delete(id);\r\n\t\t\t}\r\n\t\t}, { priority });\r\n\t}\r\n\r\n\tcancel(id: string) {\r\n\t\tconst controller = this.tasks.get(id);\r\n\t\tif (controller) {\r\n\t\t\tcontroller.abort();\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tasync onIdle() {\r\n\t\tawait this.queue.onIdle();\r\n\t}\r\n\r\n\tclear() {\r\n\t\tthis.tasks.forEach((c) => c.abort(new Error(\"ADAPTER_STOPPED\")));\r\n\t\tthis.tasks.clear();\r\n\t\tthis.queue.clear();\r\n\t}\r\n}\r\n\r\nclass RoborockRequest {\r\n\tadapter: Roborock;\r\n\thandler: requestsHandler;\r\n\tduid: string;\r\n\tmethod: string;\r\n\tparams: unknown;\r\n\tmessageID: number;\r\n\tresolvePromise!: (value: unknown) => void;\r\n\trejectPromise!: (reason?: unknown) => void;\r\n\tpromise: Promise<unknown>;\r\n\r\n\tconstructor(handler: requestsHandler, duid: string, method: string, params: unknown, messageID: number) {\r\n\t\tthis.handler = handler;\r\n\t\tthis.adapter = handler.adapter;\r\n\t\tthis.duid = duid;\r\n\t\tthis.method = method;\r\n\t\tthis.params = params;\r\n\t\tthis.messageID = messageID;\r\n\r\n\t\tthis.promise = new Promise((resolve, reject) => {\r\n\t\t\tthis.resolvePromise = resolve;\r\n\t\t\tthis.rejectPromise = reject;\r\n\t\t});\r\n\t}\r\n\r\n\tasync send(signal?: AbortSignal) {\r\n\t\tif (signal?.aborted) throw new Error(\"Aborted\");\r\n\r\n\t\tconst remoteConnection = await this.handler.isCloudDevice(this.duid);\r\n\t\tlet protocol = 101;\r\n\t\tconst version = await this.adapter.getDeviceProtocolVersion(this.duid);\r\n\t\tconst timestamp = Math.floor(Date.now() / 1000);\r\n\r\n\t\tif (!this.handler.isCloudRequest(this.duid, this.method)) {\r\n\t\t\tprotocol = 4;\r\n\t\t}\r\n\r\n\t\tconst payload = await this.handler.messageParser.buildPayload(protocol, this.messageID, this.method, this.params, version);\r\n\t\tconst roborockMessage = await this.handler.messageParser.buildRoborockMessage(this.duid, protocol, timestamp, payload, version);\r\n\r\n\t\tconst mqttConnectionState = this.adapter.mqtt_api.isConnected();\r\n\t\tconst localConnectionState = this.adapter.local_api.isConnected(this.duid);\r\n\r\n\t\tif (!roborockMessage) {\r\n\t\t\tconst errorMsg = \"Failed to build buildRoborockMessage!\";\r\n\t\t\tthis.adapter.catchError(errorMsg, \"function sendRequest\", this.duid);\r\n\t\t\tthis.rejectPromise(new Error(errorMsg));\r\n\t\t\treturn this.promise;\r\n\t\t}\r\n\r\n\t\tif (version == \"A01\") {\r\n\t\t\tthis.adapter.mqtt_api.sendMessage(this.duid, roborockMessage);\r\n\t\t\tthis.resolvePromise(null);\r\n\t\t\treturn this.promise;\r\n\t\t}\r\n\r\n\t\tthis.adapter.log.debug(`duid: ${this.duid}, mqtt: ${mqttConnectionState}, local: ${localConnectionState}, remote: ${remoteConnection}`);\r\n\r\n\t\tif (!mqttConnectionState && remoteConnection) {\r\n\t\t\tconst errorMsg = `Cloud connection not available. Not sending for method ${this.method} request!`;\r\n\t\t\tthis.adapter.log.debug(errorMsg);\r\n\t\t\tthis.rejectPromise(new Error(errorMsg));\r\n\t\t\treturn this.promise;\r\n\t\t} else if (!localConnectionState && !mqttConnectionState && this.method != \"get_network_info\") {\r\n\t\t\tconst errorMsg = `Adapter locally or remotely not connected to robot ${this.duid}. Sending request for ${this.method} not possible!`;\r\n\t\t\tthis.adapter.log.debug(errorMsg);\r\n\t\t\tthis.rejectPromise(new Error(errorMsg));\r\n\t\t\treturn this.promise;\r\n\t\t}\r\n\r\n\t\t// Register in pendingRequests\r\n\t\tthis.adapter.pendingRequests.set(this.messageID, this);\r\n\r\n\t\t// Handle AbortSignal\r\n\t\tif (signal) {\r\n\t\t\tsignal.addEventListener(\"abort\", () => {\r\n\t\t\t\tif (signal.reason) {\r\n\t\t\t\t\tthis.rejectPromise(signal.reason);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.rejectPromise(new Error(\"Aborted by RequestManager\"));\r\n\t\t\t\t}\r\n\t\t\t}, { once: true });\r\n\t\t}\r\n\r\n\t\t// Send\r\n\t\tif (this.handler.isCloudRequest(this.duid, this.method) || !localConnectionState) {\r\n\t\t\tthis.adapter.mqtt_api.sendMessage(this.duid, roborockMessage);\r\n\t\t\tthis.adapter.log.debug(`Sent payload for ${this.duid} with ${payload} using cloud connection using version ${version}`);\r\n\t\t} else {\r\n\t\t\tconst lengthBuffer = Buffer.alloc(4);\r\n\t\t\tlengthBuffer.writeUInt32BE(roborockMessage.length, 0);\r\n\t\t\tconst fullMessage = Buffer.concat([lengthBuffer, roborockMessage]);\r\n\t\t\tthis.adapter.local_api.sendMessage(this.duid, fullMessage);\r\n\t\t\tthis.adapter.log.debug(`Sent payload for ${this.duid} with ${payload} using local connection using version ${version}`);\r\n\t\t}\r\n\r\n\t\treturn this.promise;\r\n\t}\r\n\r\n\tresolve(result: unknown) {\r\n\t\tthis.adapter.pendingRequests.delete(this.messageID);\r\n\t\tthis.resolvePromise(result);\r\n\t}\r\n\r\n\treject(reason: unknown) {\r\n\t\tthis.adapter.pendingRequests.delete(this.messageID);\r\n\t\tthis.rejectPromise(reason);\r\n\t}\r\n}\r\n\r\nexport class requestsHandler {\r\n\tadapter: Roborock;\r\n\tidCounter: number;\r\n\tphotoIdCounter: number;\r\n\tprivate deviceManagers: Map<string, RequestManager>;\r\n\tmessageParser: messageParser;\r\n\tmapParser: MapDataParser;\r\n\tmapCreator: MapCreator;\r\n\tmqttResetInterval: ioBroker.Interval | undefined = undefined;\r\n\r\n\tpublic startupFinished: boolean = false;\r\n\tprivate startupPromises: Promise<void>[] = [];\r\n\r\n\tconstructor(adapter: Roborock) {\r\n\t\tthis.adapter = adapter;\r\n\t\t// Offset ID counter by instance to avoid collisions (Instance 0: 300-20000, Instance 1: 20300-40000)\r\n\t\tthis.idCounter = (this.adapter.instance * 20000) + 300;\r\n\t\tthis.photoIdCounter = 0;\r\n\t\tthis.deviceManagers = new Map();\r\n\t\tthis.messageParser = new messageParser(this.adapter);\r\n\t\tthis.mapParser = new MapDataParser(this.adapter);\r\n\t\tthis.mapCreator = new MapCreator(this.adapter);\r\n\t\tthis.scheduleMqttReset();\r\n\t}\r\n\r\n\tprivate scheduleMqttReset() {\r\n\t\tif (this.mqttResetInterval) this.adapter.clearInterval(this.mqttResetInterval);\r\n\t\tthis.mqttResetInterval = this.adapter.setInterval(() => {\r\n\t\t\tthis.adapter.log.debug(\"Resetting MQTT message ID counter\");\r\n\t\t\tthis.idCounter = 300;\r\n\t\t}, 24 * 60 * 60 * 1000); // 24 hours\r\n\t}\r\n\r\n\tasync waitForStartup() {\r\n\t\tthis.adapter.log.info(`[Startup] Waiting for ${this.startupPromises.length} initial requests to finish...`);\r\n\r\n\t\tawait Promise.all(this.startupPromises);\r\n\r\n\t\tthis.startupFinished = true;\r\n\t\tthis.startupPromises = [];\r\n\t\tthis.adapter.log.info(\"[Startup] All initial requests finished. Adapter is ready.\");\r\n\t}\r\n\r\n\tprivate _processResult<T>(requestPromise: Promise<T>, callback: (result: T) => Promise<void>, identifier: string, duid: string, alwaysBackground: boolean = false): void {\r\n\t\tconst executionWrapper = async () => {\r\n\t\t\ttry {\r\n\t\t\t\tconst result = await requestPromise;\r\n\t\t\t\tawait callback(result);\r\n\t\t\t} catch (e: any) {\r\n\t\t\t\tconst errorMsg = e?.message || e?.toString() || \"\";\r\n\t\t\t\t// Handle timeouts and aborts gracefully without scary stack traces\r\n\t\t\t\tif (errorMsg.includes(\"Timeout\") || errorMsg.includes(\"timed out\") || errorMsg.includes(\"Aborted\") || errorMsg.includes(\"CANCELLED\") || errorMsg.includes(\"ADAPTER_STOPPED\")) {\r\n\t\t\t\t\tconst idMatch = errorMsg.match(/Task (req_\\d+_\\d+)/);\r\n\t\t\t\t\tconst reqId = idMatch ? idMatch[1] : \"unknown\";\r\n\t\t\t\t\tif (errorMsg.includes(\"ADAPTER_STOPPED\")) {\r\n\t\t\t\t\t\tthis.adapter.log.warn(`[${identifier}] Request cancelled (Adapter stopped). ID: ${reqId}`);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.adapter.log.warn(`[${identifier}] Request timed out. ID: ${reqId}`);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.adapter.catchError(e, `Processing-${identifier}`, duid);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tconst promise = executionWrapper();\r\n\r\n\t\tif (alwaysBackground) {\r\n\t\t\tpromise.catch(() => {});\r\n\t\t} else if (!this.startupFinished) {\r\n\t\t\tthis.startupPromises.push(promise);\r\n\t\t} else {\r\n\t\t\tpromise.catch(() => {});\r\n\t\t}\r\n\t}\r\n\r\n\tgetManager(duid: string): RequestManager {\r\n\t\tif (!this.deviceManagers.has(duid)) {\r\n\t\t\t// Initialize with default concurrency and timeout\r\n\t\t\t// Concurrency 10, Timeout 30s\r\n\t\t\tthis.deviceManagers.set(duid, new RequestManager(10, REQUEST_TIMEOUT));\r\n\t\t}\r\n\t\treturn this.deviceManagers.get(duid)!;\r\n\t}\r\n\r\n\tasync sendRequest(duid: string, method: string, params: unknown, options: { priority?: number } = {}) {\r\n\t\tconst manager = this.getManager(duid);\r\n\t\tconst priority = options.priority || 0;\r\n\r\n\t\tconst attempt = async (retryCount: number): Promise<unknown> => {\r\n\t\t\tlet messageID: number;\r\n\r\n\t\t\tif (method === \"get_photo\") {\r\n\t\t\t\tthis.photoIdCounter = this.photoIdCounter >= 250 ? 1 : this.photoIdCounter + 1;\r\n\t\t\t\tmessageID = this.photoIdCounter;\r\n\t\t\t} else {\r\n\t\t\t\tconst minId = (this.adapter.instance * 20000) + 300;\r\n\t\t\t\tconst maxId = (this.adapter.instance * 20000) + 20000;\r\n\t\t\t\tthis.idCounter = this.idCounter > maxId ? minId : this.idCounter + 1;\r\n\t\t\t\tmessageID = this.idCounter;\r\n\t\t\t}\r\n\r\n\t\t\tconst req = new RoborockRequest(this, duid, method, params, messageID);\r\n\t\t\tconst taskId = `req_${messageID}_${Date.now()}`;\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst result = await manager.add(taskId, (signal) => req.send(signal), priority);\r\n\r\n\t\t\t\tif (Array.isArray(result) && result[0] === \"retry\" && retryCount < 3) {\r\n\t\t\t\t\tthis.adapter.log.debug(`[sendRequest] Received 'retry' for ${method} on ${duid}. Retrying (${retryCount + 1}/3)...`);\r\n\t\t\t\t\tawait new Promise((resolve) => setTimeout(resolve, 1000));\r\n\t\t\t\t\treturn attempt(retryCount + 1);\r\n\t\t\t\t}\r\n\t\t\t\treturn result;\r\n\t\t\t} catch (error) {\r\n\t\t\t\tthrow error;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn attempt(0);\r\n\t}\r\n\r\n\tasync getParameter(handler: BaseDeviceFeatures, duid: string, parameter: string, extraParameters?: unknown) {\r\n\t\tconst folder = parameterFolders[parameter];\r\n\t\tif (folder) {\r\n\t\t\tawait this.adapter.ensureFolder(`Devices.${duid}.${folder}`);\r\n\t\t}\r\n\r\n\t\tconst params = extraParameters ? extraParameters : [];\r\n\t\tconst requestPromise = this.sendRequest(duid, parameter, params, { priority: parameter === \"get_prop\" ? 1 : 0 });\r\n\r\n\t\tthis._processResult(\r\n\t\t\trequestPromise,\r\n\t\t\tasync (result) => {\r\n\t\t\t\tif (typeof result === \"object\" && result !== null && !Array.isArray(result)) {\r\n\t\t\t\t\tconst resultObj = result as Record<string, unknown>;\r\n\t\t\t\t\tfor (const key in resultObj) {\r\n\t\t\t\t\t\tconst subFolder = parameterFolders[key];\r\n\t\t\t\t\t\tif (subFolder) {\r\n\t\t\t\t\t\t\tawait this.adapter.ensureFolder(`Devices.${duid}.${subFolder}`);\r\n\t\t\t\t\t\t\tawait this.adapter.ensureState(`Devices.${duid}.${subFolder}.${key}`, handler.getCommonDeviceStates(key) || {});\r\n\t\t\t\t\t\t\tawait this.adapter.setStateChangedAsync(`Devices.${duid}.${subFolder}.${key}`, { val: resultObj[key] as ioBroker.StateValue, ack: true });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t`getParameter-${parameter}-${duid}`,\r\n\t\t\tduid\r\n\t\t);\r\n\t}\r\n\r\n\tasync command(_handler: BaseDeviceFeatures, duid: string, method: string, params?: unknown) {\r\n\t\tconst requestPromise = this.sendRequest(duid, method, params, { priority: 1 });\r\n\r\n\t\tthis._processResult(\r\n\t\t\trequestPromise,\r\n\t\t\tasync () => {\r\n\t\t\t\t// Command successful, nothing specific to do\r\n\t\t\t},\r\n\t\t\t`command-${method}-${duid}`,\r\n\t\t\tduid\r\n\t\t);\r\n\t}\r\n\r\n\tasync getStatus(handler: BaseDeviceFeatures, duid: string) {\r\n\t\tconst productCategory = await this.adapter.http_api.getProductCategory(duid);\r\n\t\tswitch (productCategory) {\r\n\t\t\tcase \"roborock.wetdryvac\":\r\n\t\t\t\tthis.sendRequest(\r\n\t\t\t\t\tduid,\r\n\t\t\t\t\t\"10000\",\r\n\t\t\t\t\t\"[200,201,202,203,204,205,206,207,208,209,210,212,213,214,215,216,221,222,223,224,225,226,227,228,235,210,10002,229,10004,10005,10007,230,237,238]\",\r\n\t\t\t\t\t{ priority: 0 }\r\n\t\t\t\t).catch(() => {});\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"robot.vacuum.cleaner\":\r\n\t\t\tdefault:\r\n\t\t\t\tawait this.getParameter(handler, duid, \"get_prop\", [\"get_status\"]);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n\tasync getCleanSummary(handler: BaseDeviceFeatures, duid: string) {\r\n\t\tconst requestPromise = this.sendRequest(duid, \"get_clean_summary\", [], { priority: 0 });\r\n\r\n\t\tthis._processResult(\r\n\t\t\trequestPromise,\r\n\t\t\tasync (result) => {\r\n\t\t\t\tconst cleaningAttributes = result as Record<string, unknown>;\r\n\r\n\t\t\t\tfor (const cleaningAttribute in cleaningAttributes) {\r\n\t\t\t\t\tconst mappedAttribute = mappedCleanSummary[cleaningAttribute] || cleaningAttribute;\r\n\t\t\t\t\tconst cleaningAttributeCommon = handler.getCommonCleaningInfo(mappedAttribute);\r\n\r\n\t\t\t\t\tif ([\"clean_time\", \"clean_area\", \"clean_count\"].includes(mappedAttribute)) {\r\n\t\t\t\t\t\tif (cleaningAttributeCommon) cleaningAttributeCommon.type = \"number\";\r\n\r\n\t\t\t\t\t\tawait this.adapter.ensureState(`Devices.${duid}.cleaningInfo.${mappedAttribute}`, cleaningAttributeCommon || {});\r\n\t\t\t\t\t\tawait this.adapter.setStateChangedAsync(`Devices.${duid}.cleaningInfo.${mappedAttribute}`, {\r\n\t\t\t\t\t\t\tval: this.calculateCleaningValue(mappedAttribute, cleaningAttributes[cleaningAttribute]) as ioBroker.StateValue,\r\n\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else if (mappedAttribute == \"records\") {\r\n\t\t\t\t\t\tawait this.adapter.ensureFolder(`Devices.${duid}.cleaningInfo.records`);\r\n\t\t\t\t\t\tconst recordsList = cleaningAttributes[cleaningAttribute] as Record<string, number>;\r\n\t\t\t\t\t\tconst cleaningRecordsJSON: unknown[] = [];\r\n\r\n\t\t\t\t\t\t// Process records sequentially\r\n\t\t\t\t\t\tfor (const cleaningRecord in recordsList) {\r\n\t\t\t\t\t\t\tconst cleaningRecordID = recordsList[cleaningRecord];\r\n\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tawait this.adapter.ensureFolder(`Devices.${duid}.cleaningInfo.records.${cleaningRecord}`);\r\n\r\n\t\t\t\t\t\t\t\tconst cleaningRecordAttributesArr = (await this.sendRequest(duid, \"get_clean_record\", [cleaningRecordID], { priority: 0 })) as unknown[];\r\n\t\t\t\t\t\t\t\tconst cleaningRecordAttributes = cleaningRecordAttributesArr[0] as Record<string, unknown>;\r\n\r\n\t\t\t\t\t\t\t\tcleaningRecordsJSON[parseInt(cleaningRecord)] = cleaningRecordAttributes;\r\n\r\n\t\t\t\t\t\t\t\tconst cleaningRecordCommon = handler.getCommonCleaningRecords(mappedAttribute);\r\n\t\t\t\t\t\t\t\tif (cleaningRecordCommon) {\r\n\t\t\t\t\t\t\t\t\tfor (const cleaningRecordAttribute in cleaningRecordAttributes) {\r\n\t\t\t\t\t\t\t\t\t\tconst mappedRecordAttribute = mappedCleaningRecordAttribute[cleaningRecordAttribute] || cleaningRecordAttribute;\r\n\t\t\t\t\t\t\t\t\t\tlet val = cleaningRecordAttributes[cleaningRecordAttribute];\r\n\r\n\t\t\t\t\t\t\t\t\t\tif ([\"begin\", \"end\"].includes(mappedRecordAttribute)) {\r\n\t\t\t\t\t\t\t\t\t\t\tval = new Date((val as number) * 1000).toString();\r\n\t\t\t\t\t\t\t\t\t\t} else if (mappedRecordAttribute == \"duration\") {\r\n\t\t\t\t\t\t\t\t\t\t\tval = Math.round((val as number) / 60);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tawait this.adapter.ensureState(`Devices.${duid}.cleaningInfo.records.${cleaningRecord}.${mappedRecordAttribute}`, cleaningRecordCommon);\r\n\t\t\t\t\t\t\t\t\t\tawait this.adapter.setStateChangedAsync(`Devices.${duid}.cleaningInfo.records.${cleaningRecord}.${mappedRecordAttribute}`, {\r\n\t\t\t\t\t\t\t\t\t\t\tval: val as ioBroker.StateValue,\r\n\t\t\t\t\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\tif (this.adapter.config.enable_map_creation == true) {\r\n\t\t\t\t\t\t\t\t\tconst mapArray = await this.getCleaningRecordMap(duid, recordsList[cleaningRecord]);\r\n\t\t\t\t\t\t\t\t\tif (mapArray) {\r\n\t\t\t\t\t\t\t\t\t\tawait this.adapter.ensureState(`Devices.${duid}.cleaningInfo.records.${cleaningRecord}.map.mapData`, {\r\n\t\t\t\t\t\t\t\t\t\t\tname: \"Map Data JSON\",\r\n\t\t\t\t\t\t\t\t\t\t\ttype: \"string\",\r\n\t\t\t\t\t\t\t\t\t\t\trole: \"json\",\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tawait this.adapter.setStateChangedAsync(`Devices.${duid}.cleaningInfo.records.${cleaningRecord}.map.mapData`, { val: mapArray.mapData, ack: true });\r\n\r\n\t\t\t\t\t\t\t\t\t\tawait this.adapter.ensureState(`Devices.${duid}.cleaningInfo.records.${cleaningRecord}.map.mapBase64`, {\r\n\t\t\t\t\t\t\t\t\t\t\tname: \"Map Image (Full, Uncropped)\",\r\n\t\t\t\t\t\t\t\t\t\t\ttype: \"string\",\r\n\t\t\t\t\t\t\t\t\t\t\trole: \"text.png\",\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tawait this.adapter.setStateChangedAsync(`Devices.${duid}.cleaningInfo.records.${cleaningRecord}.map.mapBase64`, { val: mapArray.mapBase64, ack: true });\r\n\r\n\t\t\t\t\t\t\t\t\t\tawait this.adapter.ensureState(`Devices.${duid}.cleaningInfo.records.${cleaningRecord}.map.mapBase64Truncated`, {\r\n\t\t\t\t\t\t\t\t\t\t\tname: \"Map Image (Full, Cropped)\",\r\n\t\t\t\t\t\t\t\t\t\t\ttype: \"string\",\r\n\t\t\t\t\t\t\t\t\t\t\trole: \"text.png\",\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\tawait this.adapter.setStateChangedAsync(`Devices.${duid}.cleaningInfo.records.${cleaningRecord}.map.mapBase64Truncated`, {\r\n\t\t\t\t\t\t\t\t\t\t\tval: mapArray.mapBase64Truncated,\r\n\t\t\t\t\t\t\t\t\t\t\tack: true,\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} catch (e: any) {\r\n\t\t\t\t\t\t\t\tconst errorMsg = e?.message || e?.toString() || \"\";\r\n\t\t\t\t\t\t\t\tif (errorMsg.includes(\"Timeout\") || errorMsg.includes(\"timed out\") || errorMsg.includes(\"Aborted\") || errorMsg.includes(\"CANCELLED\") || errorMsg.includes(\"ADAPTER_STOPPED\")) {\r\n\t\t\t\t\t\t\t\t\tconst idMatch = errorMsg.match(/Task (req_\\d+_\\d+)/);\r\n\t\t\t\t\t\t\t\t\tconst reqId = idMatch ? idMatch[1] : \"unknown\";\r\n\t\t\t\t\t\t\t\t\tif (errorMsg.includes(\"ADAPTER_STOPPED\")) {\r\n\t\t\t\t\t\t\t\t\t\tthis.adapter.log.warn(`[getCleanSummary_record] Request cancelled (Adapter stopped). ID: ${reqId}`);\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tthis.adapter.log.warn(`[getCleanSummary_record] Request timed out. ID: ${reqId}`);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.adapter.catchError(e, \"getCleanSummary_record\", duid);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tawait this.adapter.ensureState(`Devices.${duid}.cleaningInfo.records.json`, { name: \"Cleaning Records JSON\", type: \"string\", role: \"json\" });\r\n\t\t\t\t\t\tawait this.adapter.setStateChangedAsync(`Devices.${duid}.cleaningInfo.records.json`, { val: JSON.stringify(cleaningRecordsJSON), ack: true });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t`getCleanSummary-${duid}`,\r\n\t\t\tduid,\r\n\t\t\ttrue\r\n\t\t);\r\n\t}\r\n\r\n\tasync getCleaningRecordMap(duid: string, startTime: number): Promise<{ mapBase64CleanUncropped: string; mapBase64: string; mapBase64Truncated: string; mapData: string } | null> {\r\n\t\ttry {\r\n\t\t\tconst cleaningRecordMap = (await this.sendRequest(duid, \"get_clean_record_map\", { start_time: startTime }, { priority: 0 })) as Buffer;\r\n\r\n\t\t\tif (!Buffer.isBuffer(cleaningRecordMap)) {\r\n\t\t\t\tthis.adapter.log.warn(`[getCleaningRecordMap] Received non-buffer data for record ${startTime}: ${JSON.stringify(cleaningRecordMap)}`);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\t// Check if map is gzipped (starts with 0x1f 0x8b)\r\n\t\t\tlet mapBuf: Buffer = cleaningRecordMap;\r\n\t\t\tif (cleaningRecordMap[0] === 0x1f && cleaningRecordMap[1] === 0x8b) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tmapBuf = await gunzipAsync(cleaningRecordMap);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tthis.adapter.log.error(`[getCleaningRecordMap] Failed to unzip map data: ${e}`);\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst mapData = await this.mapParser.parsedata(mapBuf, null, { isHistoryMap: true });\r\n\t\t\tif (!mapData) {\r\n\t\t\t\tthis.adapter.log.warn(`[getCleaningRecordMap] Failed to parse map data for record ${startTime}`);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\t// Generate images\r\n\t\t\tconst [mapBase64CleanUncropped, mapBase64, mapBase64Truncated] = await this.mapCreator.canvasMap(mapData);\r\n\r\n\t\t\treturn {\r\n\t\t\t\tmapBase64CleanUncropped,\r\n\t\t\t\tmapBase64,\r\n\t\t\t\tmapBase64Truncated,\r\n\t\t\t\tmapData: JSON.stringify(mapData),\r\n\t\t\t};\r\n\t\t} catch (e: any) {\r\n\t\t\tconst errorMsg = e?.message || e?.toString() || \"\";\r\n\t\t\tif (errorMsg.includes(\"Timeout\") || errorMsg.includes(\"timed out\") || errorMsg.includes(\"Aborted\") || errorMsg.includes(\"CANCELLED\") || errorMsg.includes(\"ADAPTER_STOPPED\")) {\r\n\t\t\t\tconst idMatch = errorMsg.match(/Task (req_\\d+_\\d+)/);\r\n\t\t\t\tconst reqId = idMatch ? idMatch[1] : \"unknown\";\r\n\t\t\t\tif (errorMsg.includes(\"ADAPTER_STOPPED\")) {\r\n\t\t\t\t\tthis.adapter.log.warn(`[getCleaningRecordMap] Request cancelled (Adapter stopped). ID: ${reqId}`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.adapter.log.warn(`[getCleaningRecordMap] Request timed out. ID: ${reqId}`);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthis.adapter.catchError(e, \"getCleaningRecordMap\", duid);\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\tasync getMap(_handler: BaseDeviceFeatures, duid: string) {\r\n\t\tconst requestPromise = this.sendRequest(duid, \"get_map_v1\", [], { priority: 0 });\r\n\r\n\t\tthis._processResult(\r\n\t\t\trequestPromise,\r\n\t\t\tasync (result) => {\r\n\t\t\t\tconst map = result as Buffer;\r\n\r\n\t\t\t\tif (!Buffer.isBuffer(map)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Check if map is gzipped\r\n\t\t\t\tlet mapBuf: Buffer = map;\r\n\t\t\t\tif (map[0] === 0x1f && map[1] === 0x8b) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tmapBuf = await gunzipAsync(map);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tthis.adapter.log.error(`[getMap] Failed to unzip map data: ${e}`);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst mapData = await this.mapParser.parsedata(mapBuf, null);\r\n\t\t\t\tif (mapData) {\r\n\t\t\t\t\t// Update map states\r\n\t\t\t\t\tawait this.adapter.ensureState(`Devices.${duid}.map.mapData`, { name: \"Map Data\", type: \"string\", role: \"json\" });\r\n\t\t\t\t\tawait this.adapter.setStateChangedAsync(`Devices.${duid}.map.mapData`, { val: JSON.stringify(mapData), ack: true });\r\n\r\n\t\t\t\t\tconst [, mapBase64] = await this.mapCreator.canvasMap(mapData);\r\n\t\t\t\t\tawait this.adapter.ensureState(`Devices.${duid}.map.mapBase64`, { name: \"Map Image\", type: \"string\", role: \"text.png\" });\r\n\t\t\t\t\tawait this.adapter.setStateChangedAsync(`Devices.${duid}.map.mapBase64`, { val: mapBase64, ack: true });\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t`getMap-${duid}`,\r\n\t\t\tduid\r\n\t\t);\r\n\t}\r\n\r\n\tasync isCleaning(_duid: string): Promise<boolean> {\r\n\t\tvoid _duid;\r\n\t\treturn false;\r\n\t}\r\n\r\n\tisCloudDevice(_duid: string): Promise<boolean> {\r\n\t\tvoid _duid;\r\n\t\treturn Promise.resolve(true);\r\n\t}\r\n\r\n\tisCloudRequest(_duid: string, _method: string): boolean {\r\n\t\tvoid _duid;\r\n\t\tvoid _method;\r\n\t\t// Force cloud request (Protocol 101) for now to fix ID mismatch\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprivate calculateCleaningValue(_attribute: string, value: unknown): unknown {\r\n\t\treturn value;\r\n\t}\r\n\r\n\tresolvePendingRequest(messageID: number, result: unknown, protocol?: unknown) {\r\n\t\tconst req = this.adapter.pendingRequests.get(messageID);\r\n\t\tif (req) {\r\n\t\t\tif (protocol) {\r\n\t\t\t\tthis.adapter.log.debug(`[resolvePendingRequest] Received response for request ${messageID} with protocol ${protocol}`);\r\n\t\t\t}\r\n\r\n\t\t\tif (req instanceof RoborockRequest) {\r\n\t\t\t\treq.resolve(result);\r\n\t\t\t} else {\r\n\t\t\t\t// Legacy handling if any\r\n\t\t\t\tif (typeof req.resolve === \"function\") {\r\n\t\t\t\t\treq.resolve(result);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tclearQueue() {\r\n\t\tthis.adapter.local_api.clearLocalDevicedTimeout();\r\n\t\tthis.adapter.mqtt_api.clearIntervals();\r\n\r\n\t\t// Clear map-based queues\r\n\t\tthis.deviceManagers.forEach((m) => m.clear());\r\n\t\tthis.deviceManagers.clear();\r\n\r\n\t\t// Reject all pending requests to prevent hanging promises\r\n\t\tthis.adapter.pendingRequests.forEach((req) => {\r\n\t\t\tif (req instanceof RoborockRequest) {\r\n\t\t\t\treq.reject(new Error(\"Queue cleared (adapter stopped or disconnected)\"));\r\n\t\t\t} else {\r\n\t\t\t\t// Legacy fallback\r\n\t\t\t\tif (req.timeout) this.adapter.clearTimeout(req.timeout);\r\n\t\t\t\t// Try to reject if possible, otherwise just delete\r\n\t\t\t\tif (typeof req.reject === \"function\") {\r\n\t\t\t\t\treq.reject(new Error(\"Queue cleared (adapter stopped or disconnected)\"));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.adapter.pendingRequests.clear();\r\n\t}\r\n}\r\n"]}