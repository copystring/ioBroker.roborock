{"version":3,"file":"baseVacuumFeatures.js","sourceRoot":"","sources":["../../../../src/lib/features/vacuum/baseVacuumFeatures.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,8DAAgH;AAChH,oDAA2C;AAC3C,6BAAwB;AACxB,uDAAqD;AAErD,2BAA2B;AACd,QAAA,QAAQ,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,UAAU,EAAE,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC;AACvE,QAAA,UAAU,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,UAAU,EAAE,GAAG,EAAE,SAAS,EAAE,CAAC;AAC1E,QAAA,QAAQ,GAAG,EAAE,GAAG,EAAE,UAAU,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,EAAE,OAAO,EAAE,CAAC;AAkB1D,QAAA,eAAe,GAAkB;IAC7C,QAAQ,EAAE;QACT,SAAS,EAAE,gBAAQ;QACnB,cAAc,EAAE,kBAAU;QAC1B,QAAQ,EAAE,gBAAQ;KAClB;IACD,QAAQ,EAAE;QACT,eAAe,EAAE,GAAG;KACpB;CACD,CAAC;AAEF,uCAAuC;AAC1B,QAAA,kBAAkB,GAAG,OAAC;KACjC,MAAM,CAAC;IACP,KAAK,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE;IAClC,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE;IACtC,cAAc,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE;IAC3C,QAAQ,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE;IACrC,SAAS,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE;IACtC,UAAU,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE;IACvC,OAAO,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,QAAQ,EAAE;IACpD,UAAU,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE;IACvC,UAAU,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE;IACvC,GAAG,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE,EAAE,8BAA8B;IAChE,UAAU,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE;IACvC,mDAAmD;IACnD,WAAW,EAAE,OAAC;SACZ,MAAM,EAAE;SACR,QAAQ,EAAE;SACV,MAAM,CACN,CAAC,GAAG,EAAE,EAAE;QACP,IAAI,GAAG,KAAK,SAAS;YAAE,OAAO,IAAI,CAAC;QACnC,IAAI,CAAC;YACJ,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAChB,OAAO,IAAI,CAAC;QACb,CAAC;QAAC,MAAM,CAAC;YACR,OAAO,KAAK,CAAC;QACd,CAAC;IACF,CAAC,EACD,EAAE,OAAO,EAAE,sDAAsD,EAAE,CACnE;IACF,iBAAiB,EAAE,OAAC;SAClB,MAAM,EAAE;SACR,QAAQ,EAAE;SACV,MAAM,CACN,CAAC,GAAG,EAAE,EAAE;QACP,IAAI,GAAG,KAAK,SAAS;YAAE,OAAO,IAAI,CAAC;QACnC,IAAI,CAAC;YACJ,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YAChB,OAAO,IAAI,CAAC;QACb,CAAC;QAAC,MAAM,CAAC;YACR,OAAO,KAAK,CAAC;QACd,CAAC;IACF,CAAC,EACD,EAAE,OAAO,EAAE,4DAA4D,EAAE,CACzE;IACF,qBAAqB,EAAE,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,QAAQ,EAAE,EAAE,+BAA+B;IACnF,6CAA6C;CAC7C,CAAC;KACD,WAAW,EAAE,CAAC,CAAC,yCAAyC;AAE1D,MAAsB,kBAAmB,SAAQ,uCAAkB;IACxD,OAAO,CAAgB;IAEjC,oCAAoC;IAC1B,MAAM,CAAU,SAAS,GAAG,kCAAgB,CAAC;IAEvD,YACC,YAAiC,EACjC,IAAY,EACZ,UAAkB,EAClB,MAAyB,EACzB,UAAyB,uBAAe;QAExC,6DAA6D;QAC7D,MAAM,eAAe,GAAG;YACvB,uBAAO,CAAC,WAAW;YACnB,uBAAO,CAAC,YAAY;SACpB,CAAC;QACF,MAAM,YAAY,GAAG;YACpB,GAAG,MAAM;YACT,cAAc,EAAE,CAAC,GAAG,eAAe,EAAE,GAAG,MAAM,CAAC,cAAc,CAAC;SAC9D,CAAC;QAEF,KAAK,CAAC,YAAY,EAAE,IAAI,EAAE,UAAU,EAAE,YAAY,CAAC,CAAC;QACpD,IAAI,CAAC,OAAO,GAAG,OAAO,CAAC;QAEvB,uCAAuC;QACvC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,kBAAkB,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC,CAAC;QAEtF,yCAAyC;QACzC,kBAAkB,CAAC,SAAS,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,GAAG,kBAAkB,CAAC,SAAS,CAAC,SAAS,CAAC;QACpG,kBAAkB,CAAC,SAAS,CAAC,YAAY,CAAC,UAAU,CAAC,MAAM,GAAG,kBAAkB,CAAC,SAAS,CAAC,UAAU,CAAC;QACtG,kBAAkB,CAAC,SAAS,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,GAAG,kBAAkB,CAAC,SAAS,CAAC,UAAU,CAAC;QAEjG,IAAI,CAAC,0BAA0B,EAAE,CAAC;QAElC,8BAA8B;QAC9B,IAAI,CAAC,MAAM,CAAC,cAAc,GAAG,CAAC,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC;IACvE,CAAC;IAES,0BAA0B;QACnC,MAAM,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,qBAAqB,IAAI;YACrD,uDAAuD,EAAE,QAAQ;YACjE,uDAAuD,EAAE,KAAK;YAC9D,uDAAuD,EAAE,WAAW;SACpE,CAAC;QAEF,IAAI,CAAC,UAAU,CAAC,sBAAsB,EAAE;YACvC,IAAI,EAAE,MAAM;YACZ,GAAG,EAAE,kBAAkB,CAAC,SAAS,CAAC,YAAY,CAAC,oBAAoB,CAAC,GAAG;YACvE,MAAM,EAAE,OAAO;SACf,CAAC,CAAC;IACJ,CAAC;IAES,kBAAkB;QAC3B,MAAM,QAAQ,GAAG,IAAI,GAAG,EAAW,CAAC;QACpC,IAAI,CAAC;YACJ,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC/D,MAAM,aAAa,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACrE,IAAI,UAAU,KAAK,SAAS,EAAE,CAAC;gBAC9B,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,IAAI,iDAAiD,CAAC,CAAC;gBACpF,OAAO,QAAQ,CAAC;YACjB,CAAC;YAED,MAAM,cAAc,GAAG,IAAI,CAAC,KAAK,CAAC,UAAU,GAAG,CAAC,IAAI,EAAE,CAAC,CAAC;YACxD,MAAM,gBAAgB,GAAG,aAAa,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,GAAG,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAEtF,qCAAqC;YACrC,IAAI,CAAC,CAAC,CAAC,CAAC,cAAc,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,4BAA4B,CAAC,CAAC;YACtF,IAAI,CAAC,CAAC,CAAC,UAAU,GAAG,QAAQ,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,gCAAgC,CAAC,CAAC;YACtF,IAAI,CAAC,CAAC,CAAC,CAAC,cAAc,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,iBAAiB,CAAC,CAAC;YAC5E,IAAI,CAAC,CAAC,CAAC,UAAU,GAAG,MAAM,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,sBAAsB,CAAC,CAAC;YAC1E,IAAI,CAAC,CAAC,CAAC,UAAU,GAAG,CAAC,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,uBAAuB,CAAC,CAAC;YACtE,IAAI,CAAC,CAAC,CAAC,UAAU,GAAG,EAAE,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,uBAAuB,CAAC,CAAC;YACvE,IAAI,CAAC,CAAC,CAAC,UAAU,GAAG,GAAG,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,iBAAiB,CAAC,CAAC;YAClE,IAAI,CAAC,CAAC,CAAC,UAAU,GAAG,KAAK,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,sBAAsB,CAAC,CAAC;YACzE,IAAI,CAAC,CAAC,CAAC,UAAU,GAAG,SAAS,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,yBAAyB,CAAC,CAAC;YAChF,IAAI,CAAC,CAAC,CAAC,UAAU,GAAG,UAAU,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,0BAA0B,CAAC,CAAC;YAClF,IAAI,CAAC,CAAC,CAAC,UAAU,GAAG,SAAS,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,yBAAyB,CAAC,CAAC;YAChF,IAAI,CAAC,CAAC,CAAC,UAAU,GAAG,UAAU,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,iCAAiC,CAAC,CAAC;YACzF,IAAI,CAAC,CAAC,CAAC,gBAAgB,GAAG,IAAI,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,6BAA6B,CAAC,CAAC;YACrF,IAAI,CAAC,CAAC,CAAC,gBAAgB,GAAG,GAAG,CAAC;gBAAE,QAAQ,CAAC,GAAG,CAAC,uBAAO,CAAC,6BAA6B,CAAC,CAAC;YAEpF,8CAA8C;YAC9C,MAAM,QAAQ,GAAG,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACnE,IAAI,QAAQ,EAAE,CAAC;gBACd,KAAK,MAAM,EAAE,IAAI,QAAQ,EAAE,CAAC;oBAC3B,MAAM,WAAW,GAAG,kBAAkB,CAAC,SAAS,CAAC,gBAAgB,CAAC,EAAgE,CAAC,CAAC;oBACpI,IAAI,WAAW,EAAE,CAAC;wBACjB,wDAAwD;wBACxD,MAAM,WAAW,GAAG,uBAAO,CAAC,WAAmC,CAAC,CAAC;wBACjE,IAAI,WAAW,EAAE,CAAC;4BACjB,QAAQ,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;wBAC3B,CAAC;oBACF,CAAC;gBACF,CAAC;YACF,CAAC;QACF,CAAC;QAAC,OAAO,KAAU,EAAE,CAAC;YACrB,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,IAAI,kCAAkC,KAAK,CAAC,OAAO,EAAE,CAAC,CAAC;QACrF,CAAC;QACD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,IAAI,6CAA6C,CAAC,GAAG,QAAQ,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAC1G,OAAO,QAAQ,CAAC;IACjB,CAAC;IAEM,KAAK,CAAC,6BAA6B,CAAC,UAAyC;QACnF,IAAI,cAAc,GAAG,KAAK,CAAC;QAC3B,MAAM,YAAY,GAAG,CAAC,IAAI,CAAC,wBAAwB,IAAI,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,2BAA2B,CAAC,CAAC,oBAAoB;QACzH,MAAM,mBAAmB,GAAa,EAAE,CAAC;QAEzC,IAAI,CAAC,YAAY,EAAE,CAAC;YACnB,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,IAAI,gDAAgD,CAAC,CAAC;YACnF,OAAO,KAAK,CAAC;QACd,CAAC;QAED,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,kBAAkB,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,IAAI,cAAc,CAAC,CAAC;QAElF,+BAA+B;QAC/B,MAAM,gBAAgB,GAAG,0BAAkB,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;QAClE,IAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,CAAC;YAC/B,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CACjB,kBAAkB,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,IAAI,+DAA+D,IAAI,CAAC,SAAS,CAAC,gBAAgB,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAC5J,CAAC;YACF,OAAO,KAAK,CAAC;QACd,CAAC;QACD,MAAM,WAAW,GAAG,gBAAgB,CAAC,IAAI,CAAC;QAE1C,sDAAsD;QACtD,MAAM,eAAe,GAAG,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC,+BAA+B;QAClF,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,kBAAkB,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,IAAI,oCAAoC,CAAC,GAAG,eAAe,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACzI,KAAK,MAAM,OAAO,IAAI,eAAe,EAAE,CAAC;YACvC,MAAM,aAAa,GAAG,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;YAC/C,IAAI,aAAa,EAAE,CAAC;gBACnB,2EAA2E;gBAC3E,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,QAAQ,CAAC,aAAa,CAAC,EAAE,CAAC;oBACzD,MAAM,OAAO,GAAG,MAAM,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;oBACvD,IAAI,OAAO,EAAE,CAAC;wBACb,cAAc,GAAG,IAAI,CAAC;wBACtB,mBAAmB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;oBACzC,CAAC;gBACF,CAAC;qBAAM,CAAC;oBACP,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAClB,kBAAkB,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,IAAI,cAAc,aAAa,YAAY,OAAO,sDAAsD,CAClJ,CAAC;gBACH,CAAC;YACF,CAAC;QACF,CAAC;QAED,+CAA+C;QAC/C,gEAAgE;QAEhE,IAAI,eAAe,GAAG,KAAK,CAAC;QAC5B,WAAW;QACX,IAAI,CAAC,WAAW,CAAC,cAAc,KAAK,SAAS,IAAI,WAAW,CAAC,QAAQ,KAAK,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,uBAAO,CAAC,QAAQ,CAAC,EAAE,CAAC;YACrI,gHAAgH;YAChH,IAAI,MAAM,IAAI,CAAC,YAAY,CAAC,uBAAO,CAAC,QAAQ,CAAC,EAAE,CAAC;gBAC/C,eAAe,GAAG,IAAI,CAAC;gBACvB,mBAAmB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YACtC,CAAC;QACF,CAAC;QAED,uBAAuB;QACvB,IAAI,WAAW,CAAC,WAAW,KAAK,SAAS,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,iBAAiB,CAAC,EAAE,CAAC;YAChF,mHAAmH;YACnH,MAAM,IAAI,GAAgB,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,kBAAkB,CAAC,SAAS,CAAC,YAAY,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC;YACjH,IAAI,CAAC,UAAU,CAAC,iBAAiB,EAAE,IAAI,CAAC,CAAC;YACzC,eAAe,GAAG,IAAI,CAAC;YACvB,mBAAmB,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC;QACvD,CAAC;QACD,IAAI,WAAW,CAAC,iBAAiB,KAAK,SAAS,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,uBAAuB,CAAC,EAAE,CAAC;YAC5F,yHAAyH;YACzH,MAAM,IAAI,GAAgB,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,kBAAkB,CAAC,SAAS,CAAC,YAAY,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC;YACvH,IAAI,CAAC,UAAU,CAAC,uBAAuB,EAAE,IAAI,CAAC,CAAC;YAC/C,eAAe,GAAG,IAAI,CAAC;YACvB,mBAAmB,CAAC,IAAI,CAAC,iCAAiC,CAAC,CAAC;QAC7D,CAAC;QAED,0BAA0B;QAC1B,IAAI,WAAW,CAAC,SAAS,KAAK,GAAG,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,uBAAO,CAAC,UAAU,CAAC,EAAE,CAAC;YACpF,uCAAuC;YACvC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,cAAc,CAAC,QAAQ,CAAC,uBAAO,CAAC,UAAU,CAAC,EAAE,CAAC;gBAC9D,2GAA2G;gBAC3G,IAAI,MAAM,IAAI,CAAC,YAAY,CAAC,uBAAO,CAAC,UAAU,CAAC,EAAE,CAAC;oBACjD,eAAe,GAAG,IAAI,CAAC;oBACvB,mBAAmB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;gBACxC,CAAC;YACF,CAAC;QACF,CAAC;QAED,SAAS;QACT,IAAI,WAAW,CAAC,UAAU,KAAK,SAAS,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,uBAAO,CAAC,MAAM,CAAC,EAAE,CAAC;YACvF,wHAAwH;YACxH,IAAI,MAAM,IAAI,CAAC,YAAY,CAAC,uBAAO,CAAC,MAAM,CAAC,EAAE,CAAC;gBAC7C,eAAe,GAAG,IAAI,CAAC;gBACvB,mBAAmB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YACpC,CAAC;QACF,CAAC;QAED,gBAAgB;QAChB,IAAI,WAAW,CAAC,sBAAsB,KAAK,SAAS,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,uBAAO,CAAC,aAAa,CAAC,EAAE,CAAC;YAC1G,2IAA2I;YAC3I,IAAI,MAAM,IAAI,CAAC,YAAY,CAAC,uBAAO,CAAC,aAAa,CAAC,EAAE,CAAC;gBACpD,eAAe,GAAG,IAAI,CAAC;gBACvB,mBAAmB,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;YAC3C,CAAC;QACF,CAAC;QAED,UAAU;QACV,IAAI,WAAW,CAAC,WAAW,KAAK,SAAS,IAAI,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,uBAAO,CAAC,OAAO,CAAC,EAAE,CAAC;YACzF,0HAA0H;YAC1H,IAAI,MAAM,IAAI,CAAC,YAAY,CAAC,uBAAO,CAAC,OAAO,CAAC,EAAE,CAAC;gBAC9C,eAAe,GAAG,IAAI,CAAC;gBACvB,mBAAmB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACrC,CAAC;QACF,CAAC;QAED,gDAAgD;QAEhD,IAAI,eAAe,IAAI,cAAc,EAAE,CAAC;YACvC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,kBAAkB,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,IAAI,sDAAsD,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAC1J,CAAC;aAAM,CAAC;YACP,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,kBAAkB,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,IAAI,6BAA6B,CAAC,CAAC;QAClG,CAAC;QACD,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC;QACrC,OAAO,cAAc,IAAI,eAAe,CAAC,CAAC,kCAAkC;IAC7E,CAAC;IAEO,YAAY,CAAqB;IAElC,KAAK,CAAC,eAAe,CAAC,aAAiC;QAC7D,IAAI,aAAa,KAAK,SAAS,EAAE,CAAC;YACjC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,oBAAoB,IAAI,CAAC,IAAI,yDAAyD,CAAC,CAAC;YAC5G,OAAO;QACR,CAAC;QACD,MAAM,cAAc,GAAG,OAAC,CAAC,MAAM,EAAE,CAAC,GAAG,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QAC/C,MAAM,UAAU,GAAG,cAAc,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QAC3D,IAAI,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC;YACzB,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,oBAAoB,IAAI,CAAC,IAAI,qCAAqC,aAAa,aAAa,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;YAC1J,OAAO;QACR,CAAC;QACD,MAAM,QAAQ,GAAG,UAAU,CAAC,IAAI,CAAC;QAEjC,iDAAiD;QACjD,IAAI,IAAI,CAAC,YAAY,KAAK,QAAQ,EAAE,CAAC;YACpC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,IAAI,eAAe,QAAQ,kCAAkC,CAAC,CAAC;YAC5F,OAAO;QACR,CAAC;QACD,IAAI,CAAC,YAAY,GAAG,QAAQ,CAAC;QAE7B,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,0BAA0B,QAAQ,aAAa,CAAC,CAAC;QACjF,MAAM,cAAc,GAA8B;YACjD,CAAC,EAAE,CAAC,uBAAO,CAAC,aAAa,CAAC;YAC1B,CAAC,EAAE,CAAC,uBAAO,CAAC,OAAO,CAAC;YACpB,CAAC,EAAE,CAAC,uBAAO,CAAC,aAAa,EAAE,uBAAO,CAAC,OAAO,EAAE,uBAAO,CAAC,MAAM,CAAC;YAC3D,CAAC,EAAE,CAAC,uBAAO,CAAC,aAAa,CAAC;YAC1B,CAAC,EAAE,CAAC,uBAAO,CAAC,aAAa,EAAE,uBAAO,CAAC,OAAO,EAAE,uBAAO,CAAC,MAAM,CAAC;YAC3D,CAAC,EAAE,CAAC,uBAAO,CAAC,aAAa,EAAE,uBAAO,CAAC,OAAO,EAAE,uBAAO,CAAC,MAAM,CAAC;YAC3D,CAAC,EAAE,CAAC,uBAAO,CAAC,aAAa,EAAE,uBAAO,CAAC,OAAO,EAAE,uBAAO,CAAC,MAAM,CAAC;YAC3D,CAAC,EAAE,CAAC,uBAAO,CAAC,aAAa,EAAE,uBAAO,CAAC,OAAO,EAAE,uBAAO,CAAC,MAAM,CAAC;YAC3D,EAAE,EAAE,CAAC,uBAAO,CAAC,aAAa,EAAE,uBAAO,CAAC,OAAO,EAAE,uBAAO,CAAC,MAAM,CAAC,EAAE,sBAAsB;YACpF,EAAE,EAAE,CAAC,uBAAO,CAAC,aAAa,EAAE,uBAAO,CAAC,OAAO,EAAE,uBAAO,CAAC,MAAM,CAAC,EAAE,iBAAiB;YAC/E,EAAE,EAAE,CAAC,uBAAO,CAAC,aAAa,EAAE,uBAAO,CAAC,OAAO,EAAE,uBAAO,CAAC,MAAM,CAAC;YAC5D,EAAE,EAAE,CAAC,uBAAO,CAAC,aAAa,EAAE,uBAAO,CAAC,OAAO,EAAE,uBAAO,CAAC,MAAM,CAAC,EAAE,cAAc;YAC5E,EAAE,EAAE,CAAC,uBAAO,CAAC,aAAa,EAAE,uBAAO,CAAC,OAAO,EAAE,uBAAO,CAAC,MAAM,CAAC,EAAE,2BAA2B;YACzF,EAAE,EAAE,CAAC,uBAAO,CAAC,aAAa,EAAE,uBAAO,CAAC,OAAO,EAAE,uBAAO,CAAC,MAAM,CAAC,EAAE,SAAS;SACvE,CAAC;QACF,MAAM,QAAQ,GAAG,cAAc,CAAC,QAAQ,CAAC,CAAC;QAE1C,IAAI,QAAQ,EAAE,CAAC;YACd,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,qCAAqC,QAAQ,KAAK,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,sFAAsF;YAChM,KAAK,MAAM,OAAO,IAAI,QAAQ,EAAE,CAAC;gBAChC,MAAM,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC,0DAA0D;YAC7F,CAAC;QACF,CAAC;aAAM,IAAI,QAAQ,KAAK,CAAC,EAAE,CAAC;YAC3B,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,oBAAoB,IAAI,CAAC,IAAI,uBAAuB,QAAQ,4EAA4E,CAAC,CAAC;QAC9J,CAAC;IACF,CAAC;IAED,yCAAyC;IAClC,mBAAmB,CAAC,SAA0B;QACpD,OAAO,kBAAkB,CAAC,SAAS,CAAC,WAAW,CAAC,SAAkE,CAAC,CAAC;IACrH,CAAC;IACM,qBAAqB,CAAC,UAAkB;QAC9C,yBAAyB;QACzB,OAAO,kBAAkB,CAAC,SAAS,CAAC,gBAAgB,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;IACtE,CAAC;IACM,qBAAqB,CAAC,SAA0B;QACtD,MAAM,QAAQ,GAAG,kBAAkB,CAAC,SAAS,CAAC,YAAY,CAAC,SAAmE,CAAC,CAAC;QAChI,OAAO,QAA4G,CAAC;IACrH,CAAC;IACM,qBAAqB,CAAC,SAA0B;QACtD,OAAO,kBAAkB,CAAC,SAAS,CAAC,YAAY,CAAC,SAAmE,CAAC,CAAC;IACvH,CAAC;IACM,wBAAwB,CAAC,SAA0B;QACzD,MAAM,IAAI,GAAG,kBAAkB,CAAC,SAAS,CAAC,eAAe,CAAC,SAAsE,CAAC,CAAC;QAClI,OAAO,IAAiD,CAAC;IAC1D,CAAC;IACM,sBAAsB,CAAC,SAA0B;QACvD,iDAAiD;QACjD,MAAM,IAAI,GAAG,kBAAkB,CAAC,SAAS,CAAC,gBAAgB,CAAC,SAAuE,CAAC,CAAC;QACpI,OAAO,IAAI,IAAI,aAAa,SAAS,EAAE,CAAC;IACzC,CAAC;IAED,kCAAkC;IAClC,uCAAuC;IAG7B,wBAAwB;QACjC,IAAI,CAAC,UAAU,CAAC,wBAAwB,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,CAAC;QAC3E,IAAI,CAAC,UAAU,CAAC,uBAAuB,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,CAAC;QAC1E,IAAI,CAAC,UAAU,CAAC,mCAAmC,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,EAAE,cAAc,EAAE,MAAM,EAAE,EAAE,cAAc,EAAE,KAAK,EAAE,cAAc,EAAE,IAAI,EAAE,EAAE,CAAC,CAAC;QACrJ,IAAI,CAAC,UAAU,CAAC,0BAA0B,EAAE;YAC3C,IAAI,EAAE,MAAM;YACZ,GAAG,EAAE,YAAY;YACjB,MAAM,EAAE,EAAE,YAAY,EAAE,OAAO,EAAE,YAAY,EAAE,KAAK,EAAE,YAAY,EAAE,QAAQ,EAAE,YAAY,EAAE,KAAK,EAAE;SACnG,CAAC,CAAC;IACJ,CAAC;IAGY,kBAAkB;QAC3B,IAAI,CAAC,UAAU,CAAC,gBAAgB,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,CAAC;QACnE,IAAI,CAAC,UAAU,CAAC,eAAe,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE,CAAC,CAAC;QAClE,IAAI,CAAC,UAAU,CAAC,qBAAqB,EAAE;YACtC,IAAI,EAAE,MAAM;YACZ,GAAG,EAAE,iBAAiB;YACtB,MAAM,EAAE,EAAE,iBAAiB,EAAE,KAAK,EAAE,iBAAiB,EAAE,QAAQ,EAAE,iBAAiB,EAAE,SAAS,EAAE;SAC/F,CAAC,CAAC;QACH,IAAI,CAAC,UAAU,CAAC,uBAAuB,EAAE;YACxC,IAAI,EAAE,MAAM;YACZ,GAAG,EAAE,uCAAuC;YAC5C,MAAM,EAAE;gBACP,sCAAsC,EAAE,QAAQ;gBAChD,sCAAsC,EAAE,QAAQ;gBAChD,uCAAuC,EAAE,QAAQ;gBACjD,uCAAuC,EAAE,QAAQ;gBACjD,uCAAuC,EAAE,QAAQ;gBACjD,uCAAuC,EAAE,QAAQ;gBACjD,uCAAuC,EAAE,QAAQ;gBACjD,uCAAuC,EAAE,QAAQ;gBACjD,uCAAuC,EAAE,QAAQ;gBACjD,uCAAuC,EAAE,UAAU;aACnD;SACD,CAAC,CAAC;IACJ,CAAC;IAGS,iBAAiB;QAC1B,IAAI,CAAC,UAAU,CAAC,sBAAsB,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE,eAAe,EAAE,MAAM,EAAE,EAAE,eAAe,EAAE,IAAI,EAAE,eAAe,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;QAC7I,IAAI,CAAC,UAAU,CAAC,uBAAuB,EAAE;YACxC,IAAI,EAAE,MAAM;YACZ,GAAG,EAAE,sCAAsC;YAC3C,MAAM,EAAE;gBACP,sCAAsC,EAAE,KAAK;gBAC7C,qCAAqC,EAAE,IAAI;gBAC3C,sCAAsC,EAAE,IAAI;gBAC5C,sCAAsC,EAAE,IAAI;aAC5C;SACD,CAAC,CAAC;IACJ,CAAC;IAKS,mBAAmB;QAC5B,MAAM,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,QAAQ,IAAI,kCAAgB,CAAC,YAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;QAClG,IAAI,CAAC,UAAU,CAAC,cAAc,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,SAAS,EAAE,CAAC,CAAC;QAEjF,MAAM,WAAW,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,cAAc,IAAI,kCAAgB,CAAC,YAAY,CAAC,cAAc,CAAC,MAAM,CAAC;QAChH,IAAI,CAAC,UAAU,CAAC,2BAA2B,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,WAAW,EAAE,CAAC,CAAC;IACjG,CAAC;IAGS,4BAA4B;QACrC,MAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,YAAY,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC;QACvF,OAAO,CAAC,MAAM,GAAG,EAAE,GAAG,kBAAkB,CAAC,SAAS,CAAC,YAAY,CAAC,QAAQ,CAAC,MAAM,EAAE,GAAG,OAAO,CAAC,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,CAAC,CAAC,kBAAkB;QACrI,IAAI,CAAC,UAAU,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC;IAC1C,CAAC;IAGS,mBAAmB;QAC5B,MAAM,OAAO,GAAG,IAAI,CAAC,QAAQ,CAAC,YAAY,IAAI,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,EAAE,EAAE,CAAC;QACvF,OAAO,CAAC,MAAM,GAAG,EAAE,GAAG,OAAO,CAAC,MAAM,EAAE,GAAG,EAAE,WAAW,EAAE,CAAC;QACzD,IAAI,CAAC,UAAU,CAAC,cAAc,EAAE,OAAO,CAAC,CAAC;IAC1C,CAAC;IAIe,AAAN,KAAK,CAAC,kBAAkB;QACjC,MAAM,EAAE,GAAG,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC,gBAAgB;QACzD,IAAI,CAAC,EAAE,EAAE,CAAC;YACT,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,2DAA2D,CAAC,CAAC;YAC7F,OAAO;QACR,CAAC;QACD,MAAM,WAAW,GAAG;YACnB,WAAW,EAAE,UAAU,EAAE,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,oBAAoB,IAAI,CAAC,IAAI,EAAE;YAC7F,WAAW,EAAE,UAAU,EAAE,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,oBAAoB,IAAI,CAAC,IAAI,cAAc;YACzG,UAAU,EAAE,UAAU,EAAE,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,uBAAuB,IAAI,CAAC,IAAI,EAAE;YAC/F,IAAI,EAAE,UAAU,EAAE,IAAI,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,IAAI,IAAI,CAAC,IAAI,QAAQ;SAC5E,CAAC;QACF,MAAM,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,IAAI,CAAC,IAAI,SAAS,CAAC,CAAC;QAC5D,KAAK,MAAM,CAAC,IAAI,EAAE,UAAU,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,WAAW,CAAC,EAAE,CAAC;YAC9D,yBAAyB;YACzB,MAAM,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,IAAI,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,EAAE,UAAU,EAAE,CAAC,CAAC;QACxG,CAAC;IACF,CAAC;IAGe,AAAN,KAAK,CAAC,sBAAsB;QACrC,MAAM,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,IAAI,CAAC,IAAI,SAAS,CAAC,CAAC;QAC5D,KAAK,MAAM,OAAO,IAAI,CAAC,eAAe,EAAE,aAAa,EAAE,iBAAiB,CAAC,EAAE,CAAC;YAC3E,yBAAyB;YACzB,MAAM,IAAI,CAAC,WAAW,CAAC,QAAQ,EAAE,OAAO,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;QAC5F,CAAC;IACF,CAAC;IAIS,sBAAsB;QAC/B,IAAI,CAAC,UAAU,CAAC,iBAAiB,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,kBAAkB,CAAC,SAAS,CAAC,YAAY,CAAC,WAAW,CAAC,MAAM,EAAE,CAAC,CAAC;QAC3H,IAAI,CAAC,UAAU,CAAC,uBAAuB,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,MAAM,EAAE,kBAAkB,CAAC,SAAS,CAAC,YAAY,CAAC,iBAAiB,CAAC,MAAM,EAAE,CAAC,CAAC;IACxI,CAAC;IAGe,AAAN,KAAK,CAAC,uBAAuB;QACtC,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,wBAAwB,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;QAClH,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,aAAa,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;IACxG,CAAC;IAGe,AAAN,KAAK,CAAC,qBAAqB;QACpC,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,sBAAsB,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;IACjH,CAAC;IAGe,AAAN,KAAK,CAAC,qBAAqB;QACpC,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,mBAAmB,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;IAC9G,CAAC;IAGe,AAAN,KAAK,CAAC,uBAAuB;QACtC,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,eAAe,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;QACzG,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,cAAc,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;IACzG,CAAC;IAGe,AAAN,KAAK,CAAC,qBAAqB;QACpC,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,iBAAiB,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;IAC5G,CAAC;IAGe,AAAN,KAAK,CAAC,uBAAuB;QACtC,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,mBAAmB,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;IAC9G,CAAC;IAED,sCAAsC;IAEtB,AAAN,KAAK,CAAC,eAAe,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,UAAU,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAGzI,AAAN,KAAK,CAAC,oBAAoB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,eAAe,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAGnJ,AAAN,KAAK,CAAC,uBAAuB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,mBAAmB,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAG1J,AAAN,KAAK,CAAC,gBAAgB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,WAAW,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAG3I,AAAN,KAAK,CAAC,oBAAoB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,eAAe,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAGnJ,AAAN,KAAK,CAAC,qBAAqB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,gBAAgB,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAGrJ,AAAN,KAAK,CAAC,oBAAoB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,eAAe,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;IAG9J,AAAN,KAAK,CAAC,gBAAgB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,WAAW,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAG3I,AAAN,KAAK,CAAC,gBAAgB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,WAAW,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAG3I,AAAN,KAAK,CAAC,iBAAiB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,YAAY,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAG7I,AAAN,KAAK,CAAC,qBAAqB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,cAAc,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAGnJ,AAAN,KAAK,CAAC,oBAAoB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,eAAe,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAGnJ,AAAN,KAAK,CAAC,oBAAoB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,eAAe,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAGnJ,AAAN,KAAK,CAAC,mBAAmB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,QAAQ,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAG3I,AAAN,KAAK,CAAC,WAAW,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAGhI,AAAN,KAAK,CAAC,WAAW,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAGhI,AAAN,KAAK,CAAC,mBAAmB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,OAAO,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAG1I,AAAN,KAAK,CAAC,WAAW,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAGhI,AAAN,KAAK,CAAC,kBAAkB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,aAAa,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAG/I,AAAN,KAAK,CAAC,WAAW,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAGhI,AAAN,KAAK,CAAC,qBAAqB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,gBAAgB,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAGrJ,AAAN,KAAK,CAAC,mBAAmB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,cAAc,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;IAG7J,AAAN,KAAK,CAAC,kBAAkB,KAAoB,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,aAAa,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC,CAAC;IAG/I,AAAN,KAAK,CAAC,8BAA8B;QAC7C,yBAAyB;QACzB,MAAM,IAAI,CAAC,WAAW,CAAC,UAAU,EAAE,4BAA4B,EAAE;YAChE,IAAI,EAAE,QAAQ;YACd,IAAI,EAAE,OAAO;YACb,KAAK,EAAE,IAAI;YACX,GAAG,EAAE,CAAC;YACN,GAAG,EAAE,CAAC;YACN,GAAG,EAAE,EAAE;SACP,CAAC,CAAC;IACJ,CAAC;IAEM,KAAK,CAAC,sBAAsB;QAClC,MAAM,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,IAAI,CAAC,IAAI,mBAAmB,CAAC,CAAC;QACtE,KAAK,MAAM,UAAU,IAAI,kBAAkB,CAAC,SAAS,CAAC,gBAAgB,EAAE,CAAC;YACxE,MAAM,IAAI,CAAC,WAAW,CAAC,kBAAkB,EAAE,UAAU,EAAE;gBACtD,IAAI,EAAE,SAAS;gBACf,IAAI,EAAE,QAAQ;gBACd,GAAG,EAAE,KAAK;gBACV,KAAK,EAAE,IAAI;gBACX,IAAI,EAAE,SAAS,UAAU,EAAE;aAC3B,CAAC,CAAC;QACJ,CAAC;IACF,CAAC;IAEM,KAAK,CAAC,iBAAiB;QAC7B,MAAM,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,IAAI,CAAC,IAAI,cAAc,CAAC,CAAC;QACjE,KAAK,MAAM,CAAC,EAAE,EAAE,MAAM,CAAC,IAAI,MAAM,CAAC,OAAO,CAAC,kBAAkB,CAAC,SAAS,CAAC,WAAW,CAAC,EAAE,CAAC;YACrF,MAAM,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE,EAAE,EAAE;gBACzC,GAAG,MAAM;gBACT,IAAI,EAAE,QAAQ;gBACd,IAAI,EAAE,OAAO;gBACb,KAAK,EAAE,KAAK;aACZ,CAAC,CAAC;QACJ,CAAC;IACF,CAAC;IAGS,oBAAoB;QAC7B,MAAM,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,IAAI,kCAAgB,CAAC,YAAY,CAAC,SAAS,CAAC,MAAM,CAAC;QACpG,yDAAyD;QACzD,IAAI,CAAC,UAAU,CAAC,iBAAiB,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,GAAG,EAAE,GAAG,EAAE,MAAM,EAAE,SAAS,EAAE,CAAC,CAAC;IACrF,CAAC;IAKe,AAAN,KAAK,CAAC,oBAAoB;QACnC,MAAM,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,IAAI,CAAC,IAAI,cAAc,CAAC,CAAC;QACjE,MAAM,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE,MAAM,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;QACnG,MAAM,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE,IAAI,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,SAAS,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;QAC/F,MAAM,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE,KAAK,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,UAAU,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;QACjG,MAAM,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE,OAAO,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,cAAc,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;QACvG,MAAM,IAAI,CAAC,WAAW,CAAC,aAAa,EAAE,MAAM,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,YAAY,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC,CAAC;IAClH,CAAC;IAGe,AAAN,KAAK,CAAC,qBAAqB;QACpC,MAAM,IAAI,CAAC,IAAI,CAAC,YAAY,CAAC,WAAW,IAAI,CAAC,IAAI,eAAe,CAAC,CAAC;QAClE,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,UAAU,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;QACzG,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,WAAW,EAAE,EAAE,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;QAC1G,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,UAAU,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,KAAK,EAAE,KAAK,EAAE,IAAI,EAAE,GAAG,EAAE,CAAC,CAAC;QAC/G,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,SAAS,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,eAAe,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;QAC3G,MAAM,IAAI,CAAC,WAAW,CAAC,cAAc,EAAE,aAAa,EAAE,EAAE,IAAI,EAAE,QAAQ,EAAE,IAAI,EAAE,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;IACvG,CAAC;IAGS,mBAAmB;QAC5B,IAAI,CAAC,UAAU,CAAC,6BAA6B,EAAE;YAC9C,IAAI,EAAE,MAAM;YACZ,IAAI,EAAE,YAAY;YAClB,GAAG,EAAE,gEAAgE;YACrE,MAAM,EAAE;gBACP,2EAA2E,EAAE,gBAAgB;gBAC7F,gEAAgE,EAAE,YAAY;aAC9E;SACD,CAAC,CAAC;IACJ,CAAC;IAED,gEAAgE;IAetD,mBAAmB;QAC5B,kFAAkF;QAClF,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,IAAI,CAAC,IAAI,oCAAoC,CAAC,CAAC;IACxE,CAAC;;AA7mBL,gDA8mBC;AA5TU;IADN,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,aAAa,CAAC;;;;kEAU1D;AAGY;IADT,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,OAAO,CAAC;;;;4DAyBjD;AAGS;IADT,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,MAAM,CAAC;;;;2DAahD;AAKS;IAHT,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,QAAQ,CAAC;IAClD,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,gBAAgB,CAAC;IAC1D,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,kBAAkB,CAAC;;;;6DAO5D;AAGS;IADT,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,kBAAkB,CAAC;;;;sEAK5D;AAGS;IADT,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,SAAS,CAAC;;;;6DAKnD;AAIe;IAFf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,SAAS,CAAC;IACnD,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,MAAM,CAAC;;;;4DAkBhD;AAGe;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,UAAU,CAAC;;;;gEAOpD;AAIS;IAFT,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,WAAW,CAAC;IACrD,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,iBAAiB,CAAC;;;;gEAI3D;AAGe;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,yBAAyB,CAAC;;;;iEAInE;AAGe;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,YAAY,CAAC;;;;+DAGtD;AAGe;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,YAAY,CAAC;;;;+DAGtD;AAGe;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,MAAM,CAAC;;;;iEAIhD;AAGe;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,yBAAyB,CAAC;;;;+DAGnE;AAGe;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,0BAA0B,CAAC;;;;iEAGpE;AAIe;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,OAAO,CAAC;;;;yDACuG;AAGzI;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,YAAY,CAAC;;;;8DAC4G;AAGnJ;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,UAAU,CAAC;;;;iEACqH;AAG1J;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,QAAQ,CAAC;;;;0DACwG;AAG3I;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,YAAY,CAAC;;;;8DAC4G;AAGnJ;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,aAAa,CAAC;;;;+DAC6G;AAGrJ;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,YAAY,CAAC;;;;8DACuH;AAG9J;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,QAAQ,CAAC;;;;0DACwG;AAG3I;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,QAAQ,CAAC;;;;0DACwG;AAG3I;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,SAAS,CAAC;;;;2DACyG;AAG7I;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,aAAa,CAAC;;;;+DAC2G;AAGnJ;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,YAAY,CAAC;;;;8DAC4G;AAGnJ;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,YAAY,CAAC;;;;8DAC4G;AAGnJ;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,WAAW,CAAC;;;;6DACqG;AAG3I;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,GAAG,CAAC;;;;qDACkG;AAGhI;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,GAAG,CAAC;;;;qDACkG;AAGhI;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,WAAW,CAAC;;;;6DACoG;AAG1I;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,GAAG,CAAC;;;;qDACkG;AAGhI;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,UAAU,CAAC;;;;4DAC0G;AAG/I;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,GAAG,CAAC;;;;qDACkG;AAGhI;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,aAAa,CAAC;;;;+DAC6G;AAGrJ;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,WAAW,CAAC;;;;6DACuH;AAG7J;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,UAAU,CAAC;;;;4DAC0G;AAG/I;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,sBAAsB,CAAC;;;;wEAWhE;AA4BS;IADT,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,UAAU,CAAC;;;;8DAKpD;AAKe;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,WAAW,CAAC;;;;8DAQrD;AAGe;IADf,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,YAAY,CAAC;;;;+DAQtD;AAGS;IADT,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,gBAAgB,CAAC;;;;6DAW1D;AAiBS;IAdT,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,sBAAsB,CAAC;IAChE,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,uBAAuB,CAAC;IACjE,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,uBAAuB,CAAC;IACjE,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,sBAAsB,CAAC;IAChE,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,6BAA6B,CAAC;IACvE,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,oBAAoB,CAAC;IAC9D,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,0BAA0B,CAAC;IACpE,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,0BAA0B,CAAC;IACpE,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,qBAAqB,CAAC;IAC/D,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,wBAAwB,CAAC;IAClE,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,0BAA0B,CAAC;IACpE,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,qBAAqB,CAAC;IAC/D,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,iBAAiB,CAAC;IAC3D,uCAAkB,CAAC,aAAa,CAAC,uBAAO,CAAC,eAAe,CAAC;;;;6DAIzD","sourcesContent":["import { BaseDeviceFeatures, DeviceModelConfig, FeatureDependencies, CommandSpec } from \"../baseDeviceFeatures\";\r\nimport { Feature } from \"../features.enum\";\r\nimport { z } from \"zod\";\r\nimport { VACUUM_CONSTANTS } from \"./vacuumConstants\";\r\n\r\n// --- Shared Constants ---\r\nexport const BASE_FAN = { 101: \"Quiet\", 102: \"Balanced\", 103: \"Turbo\", 104: \"Max\" };\r\nexport const BASE_WATER = { 200: \"Off\", 201: \"Mild\", 202: \"Moderate\", 203: \"Intense\" };\r\nexport const BASE_MOP = { 300: \"Standard\", 301: \"Deep\", 303: \"Deep+\" };\r\n\r\nexport interface VacuumProfile {\r\n    name?: string;\r\n    docks?: Record<number, { features: Feature[] }>;\r\n    mappings: {\r\n        fan_power: Record<number, string>;\r\n        water_box_mode?: Record<number, string>;\r\n        mop_mode?: Record<number, string>;\r\n    };\r\n    features: {\r\n        maxSuctionValue: number;\r\n        ultraWaterValue?: number;\r\n        hasSmartPlan?: boolean;\r\n    };\r\n    cleanMotorModePresets?: Record<string, string>;\r\n}\r\n\r\nexport const DEFAULT_PROFILE: VacuumProfile = {\r\n\tmappings: {\r\n\t\tfan_power: BASE_FAN,\r\n\t\twater_box_mode: BASE_WATER,\r\n\t\tmop_mode: BASE_MOP\r\n\t},\r\n\tfeatures: {\r\n\t\tmaxSuctionValue: 104\r\n\t}\r\n};\r\n\r\n// --- Zod Schema for Vacuum Status ---\r\nexport const VacuumStatusSchema = z\r\n\t.object({\r\n\t\tstate: z.number().int().optional(),\r\n\t\tfan_power: z.number().int().optional(),\r\n\t\twater_box_mode: z.number().int().optional(),\r\n\t\tmop_mode: z.number().int().optional(),\r\n\t\tdock_type: z.number().int().optional(),\r\n\t\terror_code: z.number().int().optional(),\r\n\t\tbattery: z.number().int().min(0).max(100).optional(),\r\n\t\tclean_time: z.number().int().optional(),\r\n\t\tclean_area: z.number().int().optional(),\r\n\t\tdss: z.number().int().optional(), // Docking station status bits\r\n\t\tmap_status: z.number().int().optional(),\r\n\t\t// Optional string fields that should be valid JSON\r\n\t\tcarpet_mode: z\r\n\t\t\t.string()\r\n\t\t\t.optional()\r\n\t\t\t.refine(\r\n\t\t\t\t(val) => {\r\n\t\t\t\t\tif (val === undefined) return true;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tJSON.parse(val);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} catch {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t{ message: \"carpet_mode must be a valid JSON string or undefined\" }\r\n\t\t\t),\r\n\t\tcarpet_clean_mode: z\r\n\t\t\t.string()\r\n\t\t\t.optional()\r\n\t\t\t.refine(\r\n\t\t\t\t(val) => {\r\n\t\t\t\t\tif (val === undefined) return true;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tJSON.parse(val);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} catch {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t{ message: \"carpet_clean_mode must be a valid JSON string or undefined\" }\r\n\t\t\t),\r\n\t\twater_box_custom_mode: z.number().int().optional(), // Added for WaterBox detection\r\n\t\t// Add other relevant vacuum status fields...\r\n\t})\r\n\t.passthrough(); // Allow fields not defined in the schema\r\n\r\nexport abstract class BaseVacuumFeatures extends BaseDeviceFeatures {\r\n\tprotected profile: VacuumProfile;\r\n\r\n\t// --- Vacuum-specific Constants ---\r\n\tprotected static readonly CONSTANTS = VACUUM_CONSTANTS;\r\n\r\n\tconstructor(\r\n\t\tdependencies: FeatureDependencies,\r\n\t\tduid: string,\r\n\t\trobotModel: string,\r\n\t\tconfig: DeviceModelConfig,\r\n\t\tprofile: VacuumProfile = DEFAULT_PROFILE\r\n\t) {\r\n\t\t// Add default features that should be present on all vacuums\r\n\t\tconst defaultFeatures = [\r\n\t\t\tFeature.NetworkInfo,\r\n\t\t\tFeature.UpdateStatus,\r\n\t\t];\r\n\t\tconst mergedConfig = {\r\n\t\t\t...config,\r\n\t\t\tstaticFeatures: [...defaultFeatures, ...config.staticFeatures]\r\n\t\t};\r\n\r\n\t\tsuper(dependencies, duid, robotModel, mergedConfig);\r\n\t\tthis.profile = profile;\r\n\r\n\t\t// Initialize with Vacuum base commands\r\n\t\tthis.commands = JSON.parse(JSON.stringify(BaseVacuumFeatures.CONSTANTS.baseCommands));\r\n\r\n\t\t// Populate dynamic states map references\r\n\t\tBaseVacuumFeatures.CONSTANTS.deviceStates.dock_type.states = BaseVacuumFeatures.CONSTANTS.dockTypes;\r\n\t\tBaseVacuumFeatures.CONSTANTS.deviceStates.error_code.states = BaseVacuumFeatures.CONSTANTS.errorCodes;\r\n\t\tBaseVacuumFeatures.CONSTANTS.deviceStates.state.states = BaseVacuumFeatures.CONSTANTS.stateCodes;\r\n\r\n\t\tthis.applyCleanMotorModePresets();\r\n\r\n\t\t// Deduplicate static features\r\n\t\tthis.config.staticFeatures = [...new Set(this.config.staticFeatures)];\r\n\t}\r\n\r\n\tprotected applyCleanMotorModePresets(): void {\r\n\t\tconst presets = this.profile.cleanMotorModePresets || {\r\n\t\t\t'{\"fan_power\":102,\"mop_mode\":300,\"water_box_mode\":200}': \"Vacuum\",\r\n\t\t\t'{\"fan_power\":105,\"mop_mode\":300,\"water_box_mode\":202}': \"Mop\",\r\n\t\t\t'{\"fan_power\":102,\"mop_mode\":300,\"water_box_mode\":202}': \"Vac & Mop\"\r\n\t\t};\r\n\r\n\t\tthis.addCommand(\"set_clean_motor_mode\", {\r\n\t\t\ttype: \"json\",\r\n\t\t\tdef: BaseVacuumFeatures.CONSTANTS.baseCommands.set_clean_motor_mode.def,\r\n\t\t\tstates: presets\r\n\t\t});\r\n\t}\r\n\r\n\tprotected getDynamicFeatures(): Set<Feature> {\r\n\t\tconst features = new Set<Feature>();\r\n\t\ttry {\r\n\t\t\tconst featureSet = this.deps.http_api.getFeatureSet(this.duid);\r\n\t\t\tconst newFeatureSet = this.deps.http_api.getNewFeatureSet(this.duid);\r\n\t\t\tif (featureSet === undefined) {\r\n\t\t\t\tthis.deps.log.error(`[${this.duid}] getDynamicFeatures: Could not get featureSet.`);\r\n\t\t\t\treturn features;\r\n\t\t\t}\r\n\r\n\t\t\tconst highFeatureSet = Math.floor(featureSet / 2 ** 32);\r\n\t\t\tconst newFeatureSetInt = newFeatureSet ? parseInt(\"0x\" + newFeatureSet.slice(-8)) : 0;\r\n\r\n\t\t\t// Map Bitfields to 'is...' Enum keys\r\n\t\t\tif (!!((highFeatureSet >> 5) & 1)) features.add(Feature.isWashThenChargeCmdSupported);\r\n\t\t\tif (!!(featureSet & 33554432)) features.add(Feature.isDustCollectionSettingSupported);\r\n\t\t\tif (!!((highFeatureSet >> 15) & 1)) features.add(Feature.isSupportedDrying);\r\n\t\t\tif (!!(featureSet & 262144)) features.add(Feature.isShakeMopSetSupported);\r\n\t\t\tif (!!(featureSet & 8)) features.add(Feature.isVideoMonitorSupported);\r\n\t\t\tif (!!(featureSet & 64)) features.add(Feature.isVideoSettingSupported);\r\n\t\t\tif (!!(featureSet & 512)) features.add(Feature.isCarpetSupported);\r\n\t\t\tif (!!(featureSet & 65536)) features.add(Feature.isPhotoUploadSupported);\r\n\t\t\tif (!!(featureSet & 134217728)) features.add(Feature.isAvoidCollisionSupported);\r\n\t\t\tif (!!(featureSet & 2147483648)) features.add(Feature.isCornerCleanModeSupported);\r\n\t\t\tif (!!(featureSet & 268435456)) features.add(Feature.isSupportSetSwitchMapMode);\r\n\t\t\tif (!!(featureSet & 2147483648)) features.add(Feature.isCustomWaterBoxDistanceSupported);\r\n\t\t\tif (!!(newFeatureSetInt & 4096)) features.add(Feature.isBackChargeAutoWashSupported);\r\n\t\t\tif (!!(newFeatureSetInt & 256)) features.add(Feature.isCleanRouteFastModeSupported);\r\n\r\n\t\t\t// Map FW Features Result to 'is...' Enum keys\r\n\t\t\tconst fwResult = this.deps.http_api.getFwFeaturesResult(this.duid);\r\n\t\t\tif (fwResult) {\r\n\t\t\t\tfor (const id of fwResult) {\r\n\t\t\t\t\tconst featureName = BaseVacuumFeatures.CONSTANTS.firmwareFeatures[id as keyof typeof BaseVacuumFeatures.CONSTANTS.firmwareFeatures];\r\n\t\t\t\t\tif (featureName) {\r\n\t\t\t\t\t\t// Check if this feature name exists in our Feature enum\r\n\t\t\t\t\t\tconst featureEnum = Feature[featureName as keyof typeof Feature];\r\n\t\t\t\t\t\tif (featureEnum) {\r\n\t\t\t\t\t\t\tfeatures.add(featureEnum);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error: any) {\r\n\t\t\tthis.deps.log.error(`[${this.duid}] Error in getDynamicFeatures: ${error.message}`);\r\n\t\t}\r\n\t\tthis.deps.log.silly(`[${this.duid}] Detected dynamic vacuum features (raw): ${[...features].join(\", \")}`);\r\n\t\treturn features;\r\n\t}\r\n\r\n\tpublic async detectAndApplyRuntimeFeatures(statusData: Readonly<Record<string, any>>): Promise<boolean> {\r\n\t\tlet changedOverall = false;\r\n\t\tconst runDetection = !this.runtimeDetectionComplete || this.deps.config.forceRuntimeDetectEveryTime; // Check config flag\r\n\t\tconst appliedFeaturesList: string[] = [];\r\n\r\n\t\tif (!runDetection) {\r\n\t\t\tthis.deps.log.silly(`[${this.duid}] Skipping repeated runtime feature detection.`);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tthis.deps.log.debug(`[RuntimeDetect|${this.robotModel}|${this.duid}] Running...`);\r\n\r\n\t\t// --- Validate Status Data ---\r\n\t\tconst validationResult = VacuumStatusSchema.safeParse(statusData);\r\n\t\tif (!validationResult.success) {\r\n\t\t\tthis.deps.log.warn(\r\n\t\t\t\t`[RuntimeDetect|${this.robotModel}|${this.duid}] Received invalid status data. Skipping detection. Errors: ${JSON.stringify(validationResult.error.issues)}`\r\n\t\t\t);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tconst validStatus = validationResult.data;\r\n\r\n\t\t// --- Apply dynamic features first (Bitfields/FW) ---\r\n\t\tconst dynamicFeatures = this.getDynamicFeatures(); // Get current dynamic features\r\n\t\tthis.deps.log.silly(`[RuntimeDetect|${this.robotModel}|${this.duid}] Dynamic features from bits/fw: ${[...dynamicFeatures].join(\", \")}`);\r\n\t\tfor (const feature of dynamicFeatures) {\r\n\t\t\tconst mappedFeature = this.mapFeature(feature);\r\n\t\t\tif (mappedFeature) {\r\n\t\t\t\t// Apply only if NOT applied by model specifics already and NOT conflicting\r\n\t\t\t\tif (!this.config.staticFeatures.includes(mappedFeature)) {\r\n\t\t\t\t\tconst applied = await this.applyFeature(mappedFeature);\r\n\t\t\t\t\tif (applied) {\r\n\t\t\t\t\t\tchangedOverall = true;\r\n\t\t\t\t\t\tappliedFeaturesList.push(mappedFeature);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.deps.log.silly(\r\n\t\t\t\t\t\t`[RuntimeDetect|${this.robotModel}|${this.duid}] Feature '${mappedFeature}' (from '${feature}') defined statically, skipping dynamic application.`\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// --- Rules based on validated status data ---\r\n\t\t// Apply features/commands only if they haven't been applied yet\r\n\r\n\t\tlet changedByStatus = false;\r\n\t\t// WaterBox\r\n\t\tif ((validStatus.water_box_mode !== undefined || validStatus.mop_mode !== undefined) && !this.appliedFeatures.has(Feature.WaterBox)) {\r\n\t\t\t// this.deps.log.silly(`[RuntimeDetect|${this.robotModel}|${this.duid}] Detected WaterBox feature via status.`);\r\n\t\t\tif (await this.applyFeature(Feature.WaterBox)) {\r\n\t\t\t\tchangedByStatus = true;\r\n\t\t\t\tappliedFeaturesList.push(\"WaterBox\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Carpet Mode Commands\r\n\t\tif (validStatus.carpet_mode !== undefined && !this.commands[\"set_carpet_mode\"]) {\r\n\t\t\t// this.deps.log.silly(`[RuntimeDetect|${this.robotModel}|${this.duid}] Detected carpet_mode command via status.`);\r\n\t\t\tconst spec: CommandSpec = { type: \"json\", states: BaseVacuumFeatures.CONSTANTS.deviceStates.carpet_mode.states };\r\n\t\t\tthis.addCommand(\"set_carpet_mode\", spec);\r\n\t\t\tchangedByStatus = true;\r\n\t\t\tappliedFeaturesList.push(\"set_carpet_mode (Command)\");\r\n\t\t}\r\n\t\tif (validStatus.carpet_clean_mode !== undefined && !this.commands[\"set_carpet_clean_mode\"]) {\r\n\t\t\t// this.deps.log.silly(`[RuntimeDetect|${this.robotModel}|${this.duid}] Detected carpet_clean_mode command via status.`);\r\n\t\t\tconst spec: CommandSpec = { type: \"json\", states: BaseVacuumFeatures.CONSTANTS.deviceStates.carpet_clean_mode.states };\r\n\t\t\tthis.addCommand(\"set_carpet_clean_mode\", spec);\r\n\t\t\tchangedByStatus = true;\r\n\t\t\tappliedFeaturesList.push(\"set_carpet_clean_mode (Command)\");\r\n\t\t}\r\n\r\n\t\t// Refine Fan Power (Max+)\r\n\t\tif (validStatus.fan_power === 108 && !this.appliedFeatures.has(Feature.FanMaxPlus)) {\r\n\t\t\t// Apply only if not statically defined\r\n\t\t\tif (!this.config.staticFeatures.includes(Feature.FanMaxPlus)) {\r\n\t\t\t\t// this.deps.log.silly(`[RuntimeDetect|${this.robotModel}|${this.duid}] Detected FanMaxPlus state (108).`);\r\n\t\t\t\tif (await this.applyFeature(Feature.FanMaxPlus)) {\r\n\t\t\t\t\tchangedByStatus = true;\r\n\t\t\t\t\tappliedFeaturesList.push(\"FanMaxPlus\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// MopDry\r\n\t\tif (validStatus.dry_status !== undefined && !this.appliedFeatures.has(Feature.MopDry)) {\r\n\t\t\t// this.deps.log.silly(`[RuntimeDetect|${this.robotModel}|${this.duid}] Detected MopDry feature via 'dry_status' key.`);\r\n\t\t\tif (await this.applyFeature(Feature.MopDry)) {\r\n\t\t\t\tchangedByStatus = true;\r\n\t\t\t\tappliedFeaturesList.push(\"MopDry\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// AutoEmptyDock\r\n\t\tif (validStatus.dust_collection_status !== undefined && !this.appliedFeatures.has(Feature.AutoEmptyDock)) {\r\n\t\t\t// this.deps.log.silly(`[RuntimeDetect|${this.robotModel}|${this.duid}] Detected AutoEmptyDock feature via 'dust_collection_status' key.`);\r\n\t\t\tif (await this.applyFeature(Feature.AutoEmptyDock)) {\r\n\t\t\t\tchangedByStatus = true;\r\n\t\t\t\tappliedFeaturesList.push(\"AutoEmptyDock\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// MopWash\r\n\t\tif (validStatus.wash_status !== undefined && !this.appliedFeatures.has(Feature.MopWash)) {\r\n\t\t\t// this.deps.log.silly(`[RuntimeDetect|${this.robotModel}|${this.duid}] Detected MopWash feature via 'wash_status' key.`);\r\n\t\t\tif (await this.applyFeature(Feature.MopWash)) {\r\n\t\t\t\tchangedByStatus = true;\r\n\t\t\t\tappliedFeaturesList.push(\"MopWash\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Add more status-based detection rules here...\r\n\r\n\t\tif (changedByStatus || changedOverall) {\r\n\t\t\tthis.deps.log.info(`[RuntimeDetect|${this.robotModel}|${this.duid}] Runtime detection applied new features/commands: ${appliedFeaturesList.join(\", \")}`);\r\n\t\t} else {\r\n\t\t\tthis.deps.log.debug(`[RuntimeDetect|${this.robotModel}|${this.duid}] No new features detected.`);\r\n\t\t}\r\n\t\tthis.runtimeDetectionComplete = true;\r\n\t\treturn changedOverall || changedByStatus; // Return true if anything changed\r\n\t}\r\n\r\n\tprivate lastDockType: number | undefined;\r\n\r\n\tpublic async processDockType(dockTypeInput: number | undefined): Promise<void> {\r\n\t\tif (dockTypeInput === undefined) {\r\n\t\t\tthis.deps.log.debug(`[processDockType|${this.duid}] dockTypeInput is undefined, skipping dock processing.`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst dockTypeSchema = z.number().int().min(0);\r\n\t\tconst validation = dockTypeSchema.safeParse(dockTypeInput);\r\n\t\tif (!validation.success) {\r\n\t\t\tthis.deps.log.warn(`[processDockType|${this.duid}] Invalid dockTypeInput received: ${dockTypeInput}. Errors: ${JSON.stringify(validation.error.issues)}`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst dockType = validation.data;\r\n\r\n\t\t// Optimization: Skip if dock type hasn't changed\r\n\t\tif (this.lastDockType === dockType) {\r\n\t\t\tthis.deps.log.silly(`[${this.duid}] Dock type ${dockType} unchanged, skipping processing.`);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.lastDockType = dockType;\r\n\r\n\t\tthis.deps.log.info(`[${this.duid}] Processing dock type ${dockType} for Vacuum`);\r\n\t\tconst dockFeatureMap: Record<number, Feature[]> = {\r\n\t\t\t1: [Feature.AutoEmptyDock],\r\n\t\t\t2: [Feature.MopWash],\r\n\t\t\t3: [Feature.AutoEmptyDock, Feature.MopWash, Feature.MopDry],\r\n\t\t\t5: [Feature.AutoEmptyDock],\r\n\t\t\t6: [Feature.AutoEmptyDock, Feature.MopWash, Feature.MopDry],\r\n\t\t\t7: [Feature.AutoEmptyDock, Feature.MopWash, Feature.MopDry],\r\n\t\t\t8: [Feature.AutoEmptyDock, Feature.MopWash, Feature.MopDry],\r\n\t\t\t9: [Feature.AutoEmptyDock, Feature.MopWash, Feature.MopDry],\r\n\t\t\t14: [Feature.AutoEmptyDock, Feature.MopWash, Feature.MopDry], // Qrevo Master (a117)\r\n\t\t\t15: [Feature.AutoEmptyDock, Feature.MopWash, Feature.MopDry], // Qrevo S (a104)\r\n\t\t\t16: [Feature.AutoEmptyDock, Feature.MopWash, Feature.MopDry],\r\n\t\t\t10: [Feature.AutoEmptyDock, Feature.MopWash, Feature.MopDry], // S7 MaxV/Pro\r\n\t\t\t17: [Feature.AutoEmptyDock, Feature.MopWash, Feature.MopDry], // Qrevo Curv Series (a159)\r\n\t\t\t18: [Feature.AutoEmptyDock, Feature.MopWash, Feature.MopDry], // S8 Pro\r\n\t\t};\r\n\t\tconst features = dockFeatureMap[dockType];\r\n\r\n\t\tif (features) {\r\n\t\t\tthis.deps.log.info(`[${this.duid}] Applying dock features for type ${dockType}: ${features.join(\", \")}`); // Apply features sequentially to potentially handle dependencies/overwrites correctly\r\n\t\t\tfor (const feature of features) {\r\n\t\t\t\tawait this.applyFeature(feature); // Use applyFeature helper which checks if already applied\r\n\t\t\t}\r\n\t\t} else if (dockType !== 0) {\r\n\t\t\tthis.deps.log.warn(`[processDockType|${this.duid}] Unknown dock type ${dockType} encountered. No features applied. Please report this model and dock type.`);\r\n\t\t}\r\n\t}\r\n\r\n\t// --- Instance Getters for Constants ---\r\n\tpublic getCommonConsumable(attribute: string | number): { unit?: string } | undefined {\r\n\t\treturn BaseVacuumFeatures.CONSTANTS.consumables[attribute as keyof typeof BaseVacuumFeatures.CONSTANTS.consumables];\r\n\t}\r\n\tpublic isResetableConsumable(consumable: string): boolean {\r\n\t\t// Access static constant\r\n\t\treturn BaseVacuumFeatures.CONSTANTS.resetConsumables.has(consumable);\r\n\t}\r\n\tpublic getCommonDeviceStates(attribute: string | number): { states?: Record<any, any>; unit?: string; type?: ioBroker.CommonType | undefined } | undefined {\r\n\t\tconst stateDef = BaseVacuumFeatures.CONSTANTS.deviceStates[attribute as keyof typeof BaseVacuumFeatures.CONSTANTS.deviceStates];\r\n\t\treturn stateDef as { states?: Record<any, any>; unit?: string; type?: ioBroker.CommonType | undefined } | undefined;\r\n\t}\r\n\tpublic getCommonCleaningInfo(attribute: string | number): { unit?: string } | undefined {\r\n\t\treturn BaseVacuumFeatures.CONSTANTS.cleaningInfo[attribute as keyof typeof BaseVacuumFeatures.CONSTANTS.cleaningInfo];\r\n\t}\r\n\tpublic getCommonCleaningRecords(attribute: string | number): Partial<ioBroker.StateCommon> | undefined {\r\n\t\tconst spec = BaseVacuumFeatures.CONSTANTS.cleaningRecords[attribute as keyof typeof BaseVacuumFeatures.CONSTANTS.cleaningRecords];\r\n\t\treturn spec as Partial<ioBroker.StateCommon> | undefined;\r\n\t}\r\n\tpublic getFirmwareFeatureName(featureID: string | number): string {\r\n\t\t// Use the temporarily kept static map for lookup\r\n\t\tconst name = BaseVacuumFeatures.CONSTANTS.firmwareFeatures[featureID as keyof typeof BaseVacuumFeatures.CONSTANTS.firmwareFeatures];\r\n\t\treturn name || `FeatureID_${featureID}`;\r\n\t}\r\n\r\n\t// --- Feature Implementations ---\r\n\t// Converted to methods with decorators\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.AutoEmptyDock)\r\n\tprotected addAutoEmptyDockCommands(): void {\r\n\t\tthis.addCommand(\"app_start_collect_dust\", { type: \"boolean\", def: false });\r\n\t\tthis.addCommand(\"app_stop_collect_dust\", { type: \"boolean\", def: false });\r\n\t\tthis.addCommand(\"set_dust_collection_switch_status\", { type: \"json\", def: '{\"status\":1}', states: { '{\"status\":0}': \"Off\", '{\"status\":1}': \"On\" } });\r\n\t\tthis.addCommand(\"set_dust_collection_mode\", {\r\n\t\t\ttype: \"json\",\r\n\t\t\tdef: '{\"mode\":0}',\r\n\t\t\tstates: { '{\"mode\":0}': \"Smart\", '{\"mode\":1}': \"Low\", '{\"mode\":2}': \"Medium\", '{\"mode\":4}': \"Max\" },\r\n\t\t});\r\n\t}\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.MopWash)\r\n    protected addMopWashCommands(): void {\r\n    \tthis.addCommand(\"app_start_wash\", { type: \"boolean\", def: false });\r\n    \tthis.addCommand(\"app_stop_wash\", { type: \"boolean\", def: false });\r\n    \tthis.addCommand(\"set_wash_towel_mode\", {\r\n    \t\ttype: \"json\",\r\n    \t\tdef: '{\"wash_mode\":2}',\r\n    \t\tstates: { '{\"wash_mode\":0}': \"Eco\", '{\"wash_mode\":1}': \"Medium\", '{\"wash_mode\":2}': \"Intense\" },\r\n    \t});\r\n    \tthis.addCommand(\"set_smart_wash_params\", {\r\n    \t\ttype: \"json\",\r\n    \t\tdef: '{\"smart_wash\":0,\"wash_interval\":1800}',\r\n    \t\tstates: {\r\n    \t\t\t'{\"smart_wash\":0,\"wash_interval\":600}': \"10 Min\",\r\n    \t\t\t'{\"smart_wash\":0,\"wash_interval\":900}': \"15 Min\",\r\n    \t\t\t'{\"smart_wash\":0,\"wash_interval\":1200}': \"20 Min\",\r\n    \t\t\t'{\"smart_wash\":0,\"wash_interval\":1500}': \"25 Min\",\r\n    \t\t\t'{\"smart_wash\":0,\"wash_interval\":1800}': \"30 Min\",\r\n    \t\t\t'{\"smart_wash\":0,\"wash_interval\":2100}': \"35 Min\",\r\n    \t\t\t'{\"smart_wash\":0,\"wash_interval\":2400}': \"40 Min\",\r\n    \t\t\t'{\"smart_wash\":0,\"wash_interval\":2700}': \"45 Min\",\r\n    \t\t\t'{\"smart_wash\":0,\"wash_interval\":3000}': \"50 Min\",\r\n    \t\t\t'{\"smart_wash\":1,\"wash_interval\":1200}': \"Per room\",\r\n    \t\t},\r\n    \t});\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.MopDry)\r\n    protected addMopDryCommands(): void {\r\n    \tthis.addCommand(\"app_set_dryer_status\", { type: \"string\", def: '{\"status\": 0}', states: { '{\"status\": 1}': \"On\", '{\"status\": 0}': \"Off\" } });\r\n    \tthis.addCommand(\"app_set_dryer_setting\", {\r\n    \t\ttype: \"json\",\r\n    \t\tdef: '{\"on\":{\"dry_time\":10800},\"status\":0}',\r\n    \t\tstates: {\r\n    \t\t\t'{\"on\":{\"dry_time\":10800},\"status\":0}': \"Off\",\r\n    \t\t\t'{\"on\":{\"dry_time\":7200},\"status\":1}': \"2h\",\r\n    \t\t\t'{\"on\":{\"dry_time\":10800},\"status\":1}': \"3h\",\r\n    \t\t\t'{\"on\":{\"dry_time\":14400},\"status\":1}': \"4h\",\r\n    \t\t},\r\n    \t});\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.WaterBox)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.ShakeMopStrength)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.ElectronicWaterBox)\r\n    protected addWaterBoxCommands(): void {\r\n    \tconst mopStates = this.profile.mappings.mop_mode || VACUUM_CONSTANTS.deviceStates.mop_mode.states;\r\n    \tthis.addCommand(\"set_mop_mode\", { type: \"number\", def: 300, states: mopStates });\r\n\r\n    \tconst waterStates = this.profile.mappings.water_box_mode || VACUUM_CONSTANTS.deviceStates.water_box_mode.states;\r\n    \tthis.addCommand(\"set_water_box_custom_mode\", { type: \"number\", def: 201, states: waterStates });\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.CleanRouteFastMode)\r\n    protected addCleanRouteFastModeCommand(): void {\r\n    \tconst mopMode = this.commands.set_mop_mode || { type: \"number\", def: 300, states: {} };\r\n    \tmopMode.states = { ...BaseVacuumFeatures.CONSTANTS.deviceStates.mop_mode.states, ...mopMode.states, 304: \"Fast\" }; // Merge carefully\r\n    \tthis.addCommand(\"set_mop_mode\", mopMode);\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.SmartPlan)\r\n    protected addSmartPlanFeature(): void {\r\n    \tconst mopMode = this.commands.set_mop_mode || { type: \"number\", def: 300, states: {} };\r\n    \tmopMode.states = { ...mopMode.states, 306: \"SmartPlan\" };\r\n    \tthis.addCommand(\"set_mop_mode\", mopMode);\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.LiveVideo)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.Camera)\r\n    protected async createCameraStates(): Promise<void> {\r\n    \tconst ip = this.deps.config.hostname_ip; // Use DI config\r\n    \tif (!ip) {\r\n    \t\tthis.deps.log.warn(`[${this.duid}] Cannot create camera states: IP address not configured.`);\r\n    \t\treturn;\r\n    \t}\r\n    \tconst streamTypes = {\r\n    \t\tstream_html: `http://${ip}:${1984 + this.deps.adapter.instance}/stream.html?src=${this.duid}`,\r\n    \t\twebrtc_html: `http://${ip}:${1984 + this.deps.adapter.instance}/webrtc.html?src=${this.duid}&media=video`,\r\n    \t\tstream_mp4: `http://${ip}:${1984 + this.deps.adapter.instance}/api/stream.mp4?src=${this.duid}`,\r\n    \t\trtsp: `rtsp://${ip}:${8554 + this.deps.adapter.instance}/${this.duid}?video`,\r\n    \t};\r\n    \tawait this.deps.ensureFolder(`Devices.${this.duid}.camera`);\r\n    \tfor (const [name, stream_uri] of Object.entries(streamTypes)) {\r\n    \t\t// Use ensureState helper\r\n    \t\tawait this.ensureState(\"camera\", name, { type: \"string\", role: \"url\", write: false, def: stream_uri });\r\n    \t}\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.MultiFloor)\r\n    protected async createMultiFloorStates(): Promise<void> {\r\n    \tawait this.deps.ensureFolder(`Devices.${this.duid}.floors`);\r\n    \tfor (const feature of [\"max_multi_map\", \"max_bak_map\", \"multi_map_count\"]) {\r\n    \t\t// Use ensureState helper\r\n    \t\tawait this.ensureState(\"floors\", feature, { type: \"number\", role: \"value\", write: false });\r\n    \t}\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.AvoidCarpet)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isCarpetSupported)\r\n    protected addAvoidCarpetCommands(): void {\r\n    \tthis.addCommand(\"set_carpet_mode\", { type: \"json\", states: BaseVacuumFeatures.CONSTANTS.deviceStates.carpet_mode.states });\r\n    \tthis.addCommand(\"set_carpet_clean_mode\", { type: \"json\", states: BaseVacuumFeatures.CONSTANTS.deviceStates.carpet_clean_mode.states });\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isAvoidCollisionSupported)\r\n    protected async addAvoidCollisionStates(): Promise<void> {\r\n    \tawait this.ensureState(\"deviceStatus\", \"collision_avoid_status\", { type: \"number\", role: \"value\", write: false });\r\n    \tawait this.ensureState(\"deviceStatus\", \"avoid_count\", { type: \"number\", role: \"value\", write: false });\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.MopForbidden)\r\n    protected async addMopForbiddenStates(): Promise<void> {\r\n    \tawait this.ensureState(\"deviceStatus\", \"mop_forbidden_enable\", { type: \"number\", role: \"value\", write: false });\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.VoiceControl)\r\n    protected async addVoiceControlStates(): Promise<void> {\r\n    \tawait this.ensureState(\"deviceStatus\", \"voice_chat_status\", { type: \"number\", role: \"value\", write: false });\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.Camera)\r\n    protected async addCameraSettingsStates(): Promise<void> {\r\n    \tawait this.ensureState(\"deviceStatus\", \"camera_status\", { type: \"number\", role: \"value\", write: false });\r\n    \tawait this.ensureState(\"deviceStatus\", \"distance_off\", { type: \"number\", role: \"value\", write: false });\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isSupportSetSwitchMapMode)\r\n    protected async addSwitchMapModeState(): Promise<void> {\r\n    \tawait this.ensureState(\"deviceStatus\", \"switch_map_mode\", { type: \"number\", role: \"value\", write: false });\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isCornerCleanModeSupported)\r\n    protected async addCornerCleanModeState(): Promise<void> {\r\n    \tawait this.ensureState(\"deviceStatus\", \"corner_clean_mode\", { type: \"number\", role: \"value\", write: false });\r\n    }\r\n\r\n    // --- State/Info Feature Handlers ---\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.MapFlag)\r\n    protected async addMapFlagState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"map_flag\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.CommonStatus)\r\n    protected async addCommonStatusState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"common_status\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.DockStatus)\r\n    protected async addDockErrorStatusState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"dock_error_status\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.BackType)\r\n    protected async addBackTypeState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"back_type\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.SwitchStatus)\r\n    protected async addSwitchStatusState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"switch_status\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.MonitorStatus)\r\n    protected async addMonitorStatusState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"monitor_status\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.CleanPercent)\r\n    protected async addCleanPercentState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"clean_percent\", { type: \"number\", role: \"value\", write: false, unit: \"%\" }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.InWarmup)\r\n    protected async addInWarmupState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"in_warmup\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.ExitDock)\r\n    protected async addExitDockState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"exit_dock\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.ExtraTime)\r\n    protected async addExtraTimeState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"extra_time\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.LastCleanTime)\r\n    protected async addLastCleanTimeState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"last_clean_t\", { type: \"string\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.ChargeStatus)\r\n    protected async addChargeStatusState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"charge_status\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.CleaningInfo)\r\n    protected async addCleaningInfoState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"cleaning_info\", { type: \"string\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.CleanRepeat)\r\n    protected async addCleanRepeatState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"repeat\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.Dss)\r\n    protected async addDssState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"dss\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.Rss)\r\n    protected async addRssState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"rss\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.RobotStatus)\r\n    protected async addRobotStatusState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"state\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.Kct)\r\n    protected async addKctState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"kct\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.CleanFluid)\r\n    protected async addCleanFluidState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"clean_fluid\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.Rdt)\r\n    protected async addRdtState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"rdt\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.ReplenishMode)\r\n    protected async addReplenishModeState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"replenish_mode\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.CleanedArea)\r\n    protected async addCleanedAreaState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"cleaned_area\", { type: \"number\", role: \"value\", write: false, unit: \"m\" }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.CleanTimes)\r\n    protected async addCleanTimesState(): Promise<void> { await this.ensureState(\"deviceStatus\", \"clean_times\", { type: \"number\", role: \"value\", write: false }); }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.CustomWaterBoxDistance)\r\n    protected async createCustomWaterDistanceState(): Promise<void> {\r\n    \t// Use ensureState helper\r\n    \tawait this.ensureState(\"commands\", \"set_water_box_distance_off\", {\r\n    \t\ttype: \"number\",\r\n    \t\trole: \"level\",\r\n    \t\twrite: true,\r\n    \t\tdef: 1,\r\n    \t\tmin: 1,\r\n    \t\tmax: 30,\r\n    \t});\r\n    }\r\n\r\n    public async createResetConsumables(): Promise<void> {\r\n    \tawait this.deps.ensureFolder(`Devices.${this.duid}.resetConsumables`);\r\n    \tfor (const consumable of BaseVacuumFeatures.CONSTANTS.resetConsumables) {\r\n    \t\tawait this.ensureState(\"resetConsumables\", consumable, {\r\n    \t\t\ttype: \"boolean\",\r\n    \t\t\trole: \"button\",\r\n    \t\t\tdef: false,\r\n    \t\t\twrite: true,\r\n    \t\t\tname: `Reset ${consumable}`\r\n    \t\t});\r\n    \t}\r\n    }\r\n\r\n    public async createConsumables(): Promise<void> {\r\n    \tawait this.deps.ensureFolder(`Devices.${this.duid}.consumables`);\r\n    \tfor (const [id, common] of Object.entries(BaseVacuumFeatures.CONSTANTS.consumables)) {\r\n    \t\tawait this.ensureState(\"consumables\", id, {\r\n    \t\t\t...common,\r\n    \t\t\ttype: \"number\",\r\n    \t\t\trole: \"value\",\r\n    \t\t\twrite: false\r\n    \t\t});\r\n    \t}\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.FanMaxPlus)\r\n    protected addFanMaxPlusCommand(): void {\r\n    \tconst fanStates = this.profile.mappings.fan_power || VACUUM_CONSTANTS.deviceStates.fan_power.states;\r\n    \t// Use set_custom_mode for fan power as per base commands\r\n    \tthis.addCommand(\"set_custom_mode\", { type: \"number\", def: 102, states: fanStates });\r\n    }\r\n\r\n\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.NetworkInfo)\r\n    protected async addNetworkInfoStates(): Promise<void> {\r\n    \tawait this.deps.ensureFolder(`Devices.${this.duid}.networkInfo`);\r\n    \tawait this.ensureState(\"networkInfo\", \"ssid\", { type: \"string\", role: \"info.name\", write: false });\r\n    \tawait this.ensureState(\"networkInfo\", \"ip\", { type: \"string\", role: \"info.ip\", write: false });\r\n    \tawait this.ensureState(\"networkInfo\", \"mac\", { type: \"string\", role: \"info.mac\", write: false });\r\n    \tawait this.ensureState(\"networkInfo\", \"bssid\", { type: \"string\", role: \"info.address\", write: false });\r\n    \tawait this.ensureState(\"networkInfo\", \"rssi\", { type: \"number\", role: \"value.rssi\", write: false, unit: \"dBm\" });\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.UpdateStatus)\r\n    protected async addUpdateStatusStates(): Promise<void> {\r\n    \tawait this.deps.ensureFolder(`Devices.${this.duid}.updateStatus`);\r\n    \tawait this.ensureState(\"updateStatus\", \"checking\", { type: \"boolean\", role: \"indicator\", write: false });\r\n    \tawait this.ensureState(\"updateStatus\", \"available\", { type: \"boolean\", role: \"indicator\", write: false });\r\n    \tawait this.ensureState(\"updateStatus\", \"progress\", { type: \"number\", role: \"value\", write: false, unit: \"%\" });\r\n    \tawait this.ensureState(\"updateStatus\", \"version\", { type: \"string\", role: \"info.firmware\", write: false });\r\n    \tawait this.ensureState(\"updateStatus\", \"description\", { type: \"string\", role: \"text\", write: false });\r\n    }\r\n\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.SmartModeCommand)\r\n    protected addSmartModeCommand(): void {\r\n    \tthis.addCommand(\"app_set_clean_sequence_type\", {\r\n    \t\ttype: \"json\",\r\n    \t\trole: \"value.list\",\r\n    \t\tdef: '{\"fan_power\":110,\"mop_mode\":306,\"type\":0,\"water_box_mode\":209}',\r\n    \t\tstates: {\r\n    \t\t\t'{\"fan_power\":102,\"mop_mode\":300,\"repeat\":1,\"type\":1,\"water_box_mode\":201}': \"Mop and vacuum\",\r\n    \t\t\t'{\"fan_power\":110,\"mop_mode\":306,\"type\":0,\"water_box_mode\":209}': \"Smart mode\",\r\n    \t\t},\r\n    \t});\r\n    }\r\n\r\n    // --- Placeholder Features (Flags without specific actions) ---\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isShakeMopSetSupported)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isVideoMonitorSupported)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isVideoSettingSupported)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isPhotoUploadSupported)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isBackChargeAutoWashSupported)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isSupportFDSEndPoint)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isSupportAutoSplitSegments)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isSupportOrderSegmentClean)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isMapSegmentSupported)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isSupportLedStatusSwitch)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isSupportFetchTimerSummary)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isOrderCleanSupported)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isRemoteSupported)\r\n    @BaseDeviceFeatures.DeviceFeature(Feature.isSupportTaskId)\r\n    protected placeholderFeatures(): void {\r\n    \t// No-op: These features are detected but require no specific initialization logic\r\n    \tthis.deps.log.silly(`[${this.duid}] Placeholder feature initialized.`);\r\n    }\r\n}\r\n"]}