{"version":3,"file":"b01VacuumFeatures.js","sourceRoot":"","sources":["../../../../src/lib/features/vacuum/b01VacuumFeatures.ts"],"names":[],"mappings":"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","sourcesContent":["import { MapManager } from \"../../map/MapManager\";\nimport { RoborockLocales } from \"../../roborock_locales\";\nimport { BaseDeviceFeatures, DeviceModelConfig, FeatureDependencies } from \"../baseDeviceFeatures\";\nimport { Feature } from \"../features.enum\";\nimport { VACUUM_CONSTANTS } from \"./vacuumConstants\";\nimport deviceDataSet = require(\"../../protocols/q7_dataset.json\");\n\nexport class B01VacuumFeatures extends BaseDeviceFeatures {\n\n\t// B01-specific properties\n\tprotected mapManager: MapManager;\n\tprotected locales: RoborockLocales;\n\tprivate cleanedLegacySegments = false;\n\tprivate mappedRooms: Array<{ id: number; name: string }> | null = null;\n\n\tconstructor(\n\t\tdependencies: FeatureDependencies,\n\t\tduid: string,\n\t\trobotModel: string,\n\t\tconfig: DeviceModelConfig,\n\t\tprofile?: unknown // Accept profile to match legacy subclasses, but ignore it\n\t) {\n\t\tsuper(dependencies, duid, robotModel, config);\n\t\tvoid profile;\n\t\tthis.mapManager = new MapManager(this.deps.adapter);\n\t\tthis.locales = new RoborockLocales(deviceDataSet);\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Info\", \"B01\", undefined, `Constructing B01VacuumFeatures for ${robotModel}`, \"info\");\n\t}\n\n\n\n\tpublic override async setupProtocolFeatures(): Promise<void> {\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Debug\", \"B01\", undefined, \"Configuring B01 Command Set...\", \"debug\");\n\n\t\t// 1. CLEAR all inherited base commands. B01 uses its own protocol.\n\t\tthis.commands = {};\n\n\t\t// 2. Add properties for prop.get\n\t\tconst properties = [\n\t\t\t\"wind\", \"water\", \"clean_mode\", \"status\", \"error_code\", \"battery\",\n\t\t\t\"clean_time\", \"clean_area\", \"map_status\", \"dock_status\", \"water_box_level_off\", \"dust_collection_status\"\n\t\t];\n\t\tconst propStates: Record<string, string> = {};\n\t\tproperties.forEach(p => propStates[p] = p);\n\n\t\tthis.addCommand(\"prop.get\", {\n\t\t\ttype: \"string\",\n\t\t\trole: \"text\",\n\t\t\tname: \"Property Get\",\n\t\t\tdef: \"status\",\n\t\t\tstates: propStates\n\t\t});\n\n\t\t// 3. Status Control (Buttons)\n\t\tthis.addCommand(\"app_start\", {\n\t\t\ttype: \"boolean\",\n\t\t\trole: \"button\",\n\t\t\tname: this.deps.adapter.translations[\"app_start\"] || \"Start Cleaning\",\n\t\t\tdef: false\n\t\t});\n\n\t\tthis.addCommand(\"app_pause\", {\n\t\t\ttype: \"boolean\",\n\t\t\trole: \"button\",\n\t\t\tname: this.deps.adapter.translations[\"app_pause\"] || \"Pause Cleaning\",\n\t\t\tdef: false\n\t\t});\n\n\t\tthis.addCommand(\"app_stop\", {\n\t\t\ttype: \"boolean\",\n\t\t\trole: \"button\",\n\t\t\tname: this.deps.adapter.translations[\"app_stop\"] || \"Stop Cleaning\",\n\t\t\tdef: false\n\t\t});\n\n\t\tthis.addCommand(\"app_charge\", {\n\t\t\ttype: \"boolean\",\n\t\t\trole: \"button\",\n\t\t\tname: this.deps.adapter.translations[\"app_charge\"] || \"Return to Dock\",\n\t\t\tdef: false\n\t\t});\n\n\t\tthis.addCommand(\"find_me\", {\n\t\t\ttype: \"boolean\",\n\t\t\trole: \"button\",\n\t\t\tname: this.deps.adapter.translations[\"find_me\"] || \"Find Me\",\n\t\t\tdef: false\n\t\t});\n\n\t\t// 4. Fan Power (wind)\n\n\t\tthis.addCommand(\"wind\", {\n\t\t\ttype: \"number\",\n\t\t\trole: \"value\",\n\t\t\tname: this.locales.getNameAll(\"wind\"),\n\t\t\tdef: 2,\n\t\t\tstates: {\n\t\t\t\t1: \"Quiet\",\n\t\t\t\t2: \"Balanced\",\n\t\t\t\t3: \"Turbo\",\n\t\t\t\t4: \"Max\",\n\t\t\t\t5: \"Max+\"\n\t\t\t}\n\t\t});\n\n\t\t// 5. Water Level (water)\n\t\tthis.addCommand(\"water\", {\n\t\t\ttype: \"number\",\n\t\t\trole: \"value\",\n\t\t\tname: this.locales.getNameAll(\"water\"),\n\t\t\tdef: 1,\n\t\t\tstates: {\n\t\t\t\t1: \"Low\",\n\t\t\t\t2: \"Medium\",\n\t\t\t\t3: \"High\"\n\t\t\t}\n\t\t});\n\n\n\n\n\n\n\n\n\t\t// 12. Update Map\n\t\tthis.addCommand(\"update_map\", {\n\t\t\ttype: \"boolean\",\n\t\t\trole: \"button\",\n\t\t\tname: \"Update Map\",\n\t\t\tdef: false\n\t\t});\n\n\t\t// 13. Consumable Resets are handled in createCommandObjects and initializeDeviceData\n\n\t\t// 14. Additional B01 Commands (Discovered in Sniffer)\n\t\tthis.addCommand(\"child_lock\", {\n\t\t\ttype: \"boolean\",\n\t\t\trole: \"switch\",\n\t\t\tname: this.locales.getNameAll(\"child_lock\"),\n\t\t\tdef: false\n\t\t});\n\n\t\tthis.addCommand(\"carpet_turbo\", {\n\t\t\ttype: \"boolean\",\n\t\t\trole: \"switch\",\n\t\t\tname: this.locales.getNameAll(\"carpet_turbo\"),\n\t\t\tdef: false\n\t\t});\n\n\t\tthis.addCommand(\"light_mode\", {\n\t\t\ttype: \"boolean\",\n\t\t\trole: \"switch\",\n\t\t\tname: this.locales.getNameAll(\"light_mode\"),\n\t\t\tdef: true\n\t\t});\n\n\t\tthis.addCommand(\"green_laser\", {\n\t\t\ttype: \"boolean\",\n\t\t\trole: \"switch\",\n\t\t\tname: this.locales.getNameAll(\"green_laser\"),\n\t\t\tdef: true\n\t\t});\n\n\t\tthis.addCommand(\"repeat_state\", {\n\t\t\ttype: \"number\",\n\t\t\trole: \"value\",\n\t\t\tname: this.locales.getNameAll(\"repeat_state\"),\n\t\t\tdef: 0,\n\t\t\tstates: { 0: \"Off\", 1: \"On\" } // Assuming 0/1 typical for repeat\n\t\t});\n\n\t\t// 10. Robot Mode (Verified in logs: 0=Vacuum, 1=Vac&Mop, 2=Mop)\n\t\tthis.addCommand(\"mode\", {\n\t\t\ttype: \"number\",\n\t\t\trole: \"value\",\n\t\t\tname: this.locales.getNameAll(\"mode\"),\n\t\t\tdef: 0,\n\t\t\tstates: {\n\t\t\t\t0: \"Vacuum\",\n\t\t\t\t1: \"Vacuum & Mop\",\n\t\t\t\t2: \"Mop\"\n\t\t\t}\n\t\t});\n\n\t\tconst cmds = Object.keys(this.commands);\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Info\", \"B01\", undefined, `B01 Protocol Enforced. Commands in memory: ${cmds.join(\", \")}`, \"info\");\n\t}\n\n\tpublic override async createCommandObjects(): Promise<void> {\n\t\tawait super.createCommandObjects();\n\n\t\t// Create Reset Consumables Folder\n\t\tawait this.deps.ensureFolder(`Devices.${this.duid}.resetConsumables`);\n\n\t\tconst resets: Record<string, string> = {\n\t\t\t\"reset_main_brush\": \"Reset Main Brush\",\n\t\t\t\"reset_side_brush\": \"Reset Side Brush\",\n\t\t\t\"reset_filter\": \"Reset Filter\"\n\t\t};\n\n\t\tfor (const [id, name] of Object.entries(resets)) {\n\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.resetConsumables.${id}`, {\n\t\t\t\tname: name,\n\t\t\t\ttype: \"boolean\",\n\t\t\t\trole: \"button\",\n\t\t\t\tdef: false,\n\t\t\t\tread: false,\n\t\t\t\twrite: true\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Allows feature handlers to provide/modify parameters for a command before sending.\n\t * B01 uses this to map individual command states to prop.set or service calls.\n\t */\n\tpublic override async getCommandParams(method: string, params?: unknown): Promise<unknown> {\n\t\t// Intercept individual commands and route to prop.set or service\n\t\t// Removed \"clean_path_preference\" and \"status\" from generic list\n\t\t// Added \"clean_path_preference\" handler below\n\t\tif ([\"wind\", \"water\", \"mode\",\n\t\t\t\"child_lock\", \"carpet_turbo\", \"light_mode\", \"green_laser\", \"repeat_state\"\n\t\t].includes(method)) {\n\t\t\treturn {\n\t\t\t\tmethod: \"prop.set\",\n\t\t\t\tparams: { [method]: params }\n\t\t\t};\n\t\t}\n\n\t\tif (method === \"clean_path_preference\") {\n\t\t\treturn {\n\t\t\t\tmethod: \"service.set_preference_type\",\n\t\t\t\tparams: { \"prefer_type\": params }\n\t\t\t};\n\t\t}\n\n\t\tif (method === \"find_me\") {\n\t\t\treturn {\n\t\t\t\tmethod: \"service.find_device\",\n\t\t\t\tparams: {}\n\t\t\t};\n\t\t}\n\n\t\tif (method === \"app_start\") {\n\t\t\treturn {\n\t\t\t\tmethod: \"service.set_room_clean\",\n\t\t\t\tparams: { \"clean_type\": 0, \"ctrl_value\": 1, \"room_ids\": [] }\n\t\t\t};\n\t\t}\n\n\t\tif (method === \"app_pause\") {\n\t\t\treturn {\n\t\t\t\tmethod: \"service.set_room_clean\",\n\t\t\t\tparams: { \"clean_type\": 0, \"ctrl_value\": 2, \"room_ids\": [] }\n\t\t\t};\n\t\t}\n\n\t\tif (method === \"app_stop\") {\n\t\t\treturn {\n\t\t\t\tmethod: \"service.stop_clean\",\n\t\t\t\tparams: {}\n\t\t\t};\n\t\t}\n\n\t\tif (method === \"app_charge\") {\n\t\t\treturn {\n\t\t\t\tmethod: \"service.start_recharge\",\n\t\t\t\tparams: {}\n\t\t\t};\n\t\t}\n\n\t\tif (method === \"update_map\") {\n\t\t\treturn {\n\t\t\t\tmethod: \"service.upload_by_maptype\",\n\t\t\t\tparams: { \"force\": 1, \"map_type\": 0 }\n\t\t\t};\n\t\t}\n\n\t\t// Service calls\n\n\n\n\t\t// Explicit Consumable Resets\n\t\tif (method === \"reset_main_brush\") {\n\t\t\treturn { method: \"service.reset_consumable\", params: { \"consumable\": 1 } };\n\t\t}\n\t\tif (method === \"reset_side_brush\") {\n\t\t\treturn { method: \"service.reset_consumable\", params: { \"consumable\": 2 } };\n\t\t}\n\t\tif (method === \"reset_filter\") {\n\t\t\treturn { method: \"service.reset_consumable\", params: { \"consumable\": 3 } };\n\t\t}\n\n\t\treturn params;\n\t}\n\n\n\n\tpublic override async initializeDeviceData(): Promise<void> {\n\t\tawait this.updateStatus();\n\t\tawait Promise.all([\n\t\t\tthis.updateFirmwareFeatures(),\n\t\t\tthis.updateMultiMapsList(),\n\t\t\tthis.updateRoomMapping(),\n\t\t]);\n\n\t\tawait this.deps.adapter.checkForNewFirmware(this.duid);\n\n\t\t// Model-specific requests\n\t\tawait this.updateExtraStatus();\n\n\t\t// Initial Map\n\t\tawait this.updateMap();\n\t}\n\n\tpublic async updateRoomMapping(): Promise<void> {\n\t\tif (!this.mappedRooms) return;\n\n\t\tconst mapStatusState = await this.deps.adapter.getStateAsync(`Devices.${this.duid}.deviceStatus.map_status`);\n\t\tlet floorID = 0;\n\t\tif (mapStatusState && typeof mapStatusState.val === \"number\") {\n\t\t\tfloorID = mapStatusState.val;\n\t\t} else {\n\t\t\t// Fallback: try to use 'current_map_id' from device status\n\t\t\tconst currentMapIdState = await this.deps.adapter.getStateAsync(`Devices.${this.duid}.deviceStatus.current_map_id`);\n\t\t\tif (currentMapIdState && typeof currentMapIdState.val === \"number\") {\n\t\t\t\tfloorID = currentMapIdState.val;\n\t\t\t} else {\n\t\t\t\tthis.deps.log.debug(`[${this.duid}] map_status and current_map_id not available for room mapping, defaulting to floor 0.`);\n\t\t\t}\n\t\t}\n\t\tconst floorFolder = `Devices.${this.duid}.floors.${floorID}`;\n\t\tconst floorName = `${this.locales.getText(\"guide_multifloors\", this.deps.adapter.language || \"en\")} ${floorID}`;\n\t\tawait this.deps.ensureFolder(floorFolder, floorName);\n\n\t\t// Cleaning up legacy/orphan states to avoid confusion (run once)\n\t\tif (!this.cleanedLegacySegments) {\n\t\t\tthis.cleanedLegacySegments = true; // Set flag immediately to prevent race conditions\n\t\t\tconst legacyCleanSegments = `Devices.${this.duid}.floors.cleanSegments`;\n\t\t\ttry {\n\t\t\t\tconst legacyObj = await this.deps.adapter.getObjectAsync(legacyCleanSegments);\n\t\t\t\tif (legacyObj) {\n\t\t\t\t\tthis.deps.adapter.log.info(`[${this.duid}] Cleaning up legacy 'cleanSegments' folder...`);\n\t\t\t\t\tawait this.deps.adapter.delObjectAsync(legacyCleanSegments, { recursive: true });\n\t\t\t\t}\n\t\t\t} catch {\n\t\t\t\t// Ignore cleanup errors\n\t\t\t}\n\t\t}\n\n\t\t// We assume mappedRooms is [{ id: 10, name: \"Living Room\" }, ...] or [{ roomId: 10, roomName: \"Living Room\" }, ...]\n\t\tconst rooms = this.mappedRooms as any[];\n\n\t\tfor (const room of rooms) {\n\t\t\tconst roomID = room?.id ?? room?.roomId;\n\t\t\tif (typeof roomID !== \"number\") {\n\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", \"B01\", undefined, `Invalid room data in mappedRooms: ${JSON.stringify(room)}`, \"warn\");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst roomName = room.name || room.roomName || `Room ${roomID}`;\n\t\t\tconst roomStateId = `${floorFolder}.${roomID}`;\n\n\t\t\tawait this.deps.ensureState(roomStateId, {\n\t\t\t\tname: roomName,\n\t\t\t\ttype: \"boolean\",\n\t\t\t\trole: \"value\",\n\t\t\t\tdef: false,\n\t\t\t\tread: true,\n\t\t\t\twrite: true\n\t\t\t});\n\t\t}\n\t}\n\n\t// Override updateStatus to use strict B01 prop.get\n\tpublic override async updateStatus(): Promise<void> {\n\t\tconst props = VACUUM_CONSTANTS.b01StatusProps;\n\t\tlet resultObj: Record<string, any> | undefined;\n\n\t\ttry {\n\t\t\tconst result = await this.deps.adapter.requestsHandler.sendRequest(this.duid, \"prop.get\", { property: props });\n\n\t\t\tif (Array.isArray(result) && result.length === props.length) {\n\t\t\t\tresultObj = {};\n\t\t\t\tprops.forEach((key: string, index: number) => {\n                    resultObj![key] = result[index];\n\t\t\t\t});\n\t\t\t} else if (typeof result === \"object\" && result !== null) {\n\t\t\t\tresultObj = result;\n\t\t\t}\n\n\t\t\tif (resultObj) {\n\t\t\t\tawait this.processStatus(resultObj);\n\t\t\t\t// B01: Features are static/protocol-defined, skipping dynamic detection\n\t\t\t}\n\t\t} catch (e: any) {\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Failed to update status (B01): ${e.message}`, \"warn\");\n\t\t}\n\t}\n\n\t// Override updateConsumables to use strict B01 prop.get\n\tpublic override async updateConsumables(data?: unknown): Promise<void> {\n\t\tlet resultObj: Record<string, any> | undefined;\n\n\t\tif (data) {\n\t\t\tresultObj = data;\n\t\t} else {\n    \t\tconst props = VACUUM_CONSTANTS.b01SettingsProps;\n    \t\tconst result = await this.deps.adapter.requestsHandler.sendRequest(this.duid, \"prop.get\", { property: props });\n    \t\tif (Array.isArray(result) && result.length === props.length) {\n    \t\t\tresultObj = {};\n    \t\t\tprops.forEach((key: string, index: number) => {\n    \t\t\t\tresultObj![key] = result[index];\n    \t\t\t});\n    \t\t} else if (typeof result === \"object\" && result !== null) {\n    \t\t\tresultObj = result as Record<string, any>;\n    \t\t}\n\t\t}\n\n\t\tif (resultObj) {\n\t\t\tawait this.processConsumables(resultObj);\n\t\t}\n\t}\n\n\t// Override processStatus to apply B01 specific conversions (dm to m)\n\tprotected async processStatus(resultObj: Record<string, unknown>): Promise<void> {\n\t\t// Prioritize dock_type processing to ensure feature flags are set\n\t\tconst dockType = resultObj[\"dock_type\"];\n\t\tif (dockType !== undefined) {\n\t\t\tawait this.processDockType(Number(dockType));\n\t\t}\n\n\t\t// Handle docking station status separately\n\t\tconst dssValue = resultObj[\"dss\"];\n\t\tif (dssValue !== undefined) {\n\t\t\tdelete resultObj[\"dss\"];\n\t\t\tawait this.updateDockingStationStatus(Number(dssValue));\n\t\t}\n\n\t\t// Map B01 specific keys to standard ioBroker states for compatibility\n\t\tawait this.deps.ensureFolder(`Devices.${this.duid}.deviceStatus`);\n\t\tfor (const key in resultObj) {\n\t\t\tlet val: unknown = resultObj[key];\n\n\t\t\tif (typeof val === \"string\") {\n\t\t\t\tconst trimmed = val.trim();\n\t\t\t\tif ((trimmed.startsWith(\"{\") || trimmed.startsWith(\"[\")) && (trimmed.endsWith(\"}\") || trimmed.endsWith(\"]\"))) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tval = JSON.parse(trimmed);\n\t\t\t\t\t} catch {\n\t\t\t\t\t\t/* ignore */\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Formatting for specific keys (e.g. timestamps)\n\t\t\tif ((key === \"last_clean_t\" || key === \"clean_finish\") && typeof val === \"number\") {\n\t\t\t\tval = this.deps.adapter.formatRoborockDate(val);\n\t\t\t}\n\n\t\t\t// Get definition or create default\n\t\t\tconst def = this.getCommonDeviceStates(key);\n\t\t\tlet type: ioBroker.CommonType = typeof val as ioBroker.CommonType;\n\t\t\tif (type === \"object\" && val !== null) type = \"object\";\n\t\t\tif ((key === \"last_clean_t\" || key === \"clean_finish\") && typeof val === \"string\") type = \"string\"; // Force string type if formatted\n\n\t\t\tconst common: any = def ? { ...def } : { name: key, type: type, role: \"value\", read: true, write: false };\n\n\t\t\t// Enrich with defaults if missing\n\t\t\tif (!common.name) common.name = key;\n\t\t\tif (!common.role) common.role = \"value\";\n\t\t\tif (common.read === undefined) common.read = true;\n\t\t\tif (common.write === undefined) common.write = false;\n\n\t\t\t// Manual Metadata Overrides - Removed hardcoded EN strings to use getNameAll translations\n\t\t\tif (key === \"cleaning_time\" || key === \"real_clean_time\" || key === \"total_clean_time\") {\n\t\t\t\tcommon.role = \"value.interval\";\n\t\t\t\tcommon.unit = key === \"cleaning_time\" ? \"min\" : \"s\";\n\t\t\t}\n\n\t\t\t// Serialize complex objects\n\t\t\tif (typeof val === \"object\" && val !== null) {\n\t\t\t\tval = JSON.stringify(val);\n\t\t\t}\n\n\t\t\t// Debug clean_finish value\n\t\t\tif (key === \"clean_finish\") {\n\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Debug\", \"B01\", undefined, `clean_finish raw: ${val}`, \"debug\");\n\t\t\t}\n\n\t\t\t// B01 Area/Time Conversion\n\t\t\tif ([\"clean_time\", \"cleaning_time\"].includes(key)) {\n\t\t\t\t// sniffs show 'cleaning_time: 25' for 25 min -> already in minutes. No conversion needed.\n\t\t\t\t// last_clean_t might be timestamp or duration? usually timestamp if clean_finish.\n\t\t\t\tconst numericVal = Number(val as number | string);\n\t\t\t\tval = isNaN(numericVal) ? 0 : numericVal;\n\t\t\t} else if ([\"cleaning_area\", \"cleaning_area\", \"last_clean_area\"].includes(key)) {\n\t\t\t\t// B01 sends dm (e.g. 2129 -> 21.29 m)\n\t\t\t\tconst numericVal = Number(((val as number) / 100).toFixed(2));\n\t\t\t\tval = isNaN(numericVal) ? 0 : numericVal;\n\t\t\t}\n\n\t\t\tif (common.type === \"string\" && typeof val !== \"string\") {\n\t\t\t\tval = String(val);\n\t\t\t}\n\n\t\t\t// Force object update to ensure units/states are applied\n\t\t\t// extendObject ensures that if the object exists, it gets updated with new common properties\n\t\t\tawait this.deps.adapter.extendObject(`Devices.${this.duid}.deviceStatus.${key}`, {\n\t\t\t\ttype: \"state\",\n\t\t\t\tcommon: common\n\t\t\t});\n\n\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.deviceStatus.${key}`, common);\n\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.deviceStatus.${key}`, { val: val as ioBroker.StateValue, ack: true });\n\t\t}\n\t}\n\n\t// Override updateMap to use B01 service call\n\tpublic override async updateMap(): Promise<void> {\n\t\ttry {\n\t\t\t// Trigger map push (Protocol 301)\n\t\t\tawait this.deps.adapter.requestsHandler.sendRequest(this.duid, \"service.upload_by_maptype\", {\n\t\t\t\tforce: 1,\n\t\t\t\tmap_type: 0\n\t\t\t});\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Debug\", \"B01\", undefined, \"Triggered B01 Map update via service.upload_by_maptype\", \"debug\");\n\n\t\t\t// Pending Request to handle the async 301 push\n\t\t\tconst dummyId = -Math.floor(Math.random() * 1000000);\n\n\t\t\tthis.deps.adapter.pendingRequests.set(dummyId, {\n\t\t\t\tmethod: \"get_map_v1\",\n\t\t\t\tduid: this.duid,\n\t\t\t\tresolve: (data: unknown) => {\n\t\t\t\t\tthis.deps.adapter.pendingRequests.delete(dummyId);\n\t\t\t\t\tif (Buffer.isBuffer(data)) {\n\t\t\t\t\t\tvoid this.processUpdateMapResponse(data);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\treject: () => { }\n\t\t\t});\n\n\t\t\tthis.deps.adapter.setTimeout(() => {\n\t\t\t\tif (this.deps.adapter.pendingRequests.has(dummyId)) {\n\t\t\t\t\tthis.deps.adapter.pendingRequests.delete(dummyId);\n\t\t\t\t}\n\t\t\t}, 15000);\n\n\t\t} catch (e: any) {\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Failed to trigger B01 map update: ${e.message}`, \"warn\");\n\t\t}\n\t}\n\n\tpublic override async updateCleanSummary(): Promise<void> {\n\t\ttry {\n\t\t\tconst summaryRes = await this.deps.adapter.requestsHandler.sendRequest(this.duid, \"service.get_record_list\", {}, { priority: -10 });\n\t\t\tif (summaryRes) {\n\t\t\t\tawait this.processCleanSummary(summaryRes);\n\t\t\t}\n\t\t} catch (e: any) {\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", \"B01\", undefined, `Failed to update B01 clean summary: ${e.message}`, \"warn\");\n\t\t}\n\t}\n\n\t// Override getCleaningRecordMap to use B01 service call (upload_record_by_url)\n\tpublic async getCleaningRecordMap(startTime: number, recordDetails?: unknown): Promise<{ mapBase64CleanUncropped: string; mapBase64: string; mapBase64Truncated: string; mapData: string } | null> {\n\t\ttry {\n\t\t\tconst details = recordDetails as { record_map_url?: string; url?: string; detail?: string | { record_map_url?: string; url?: string } };\n\t\t\tlet url = details?.record_map_url || details?.url;\n\t\t\tif (!url && details?.detail) {\n\t\t\t\tconst d = typeof details.detail === \"string\" ? JSON.parse(details.detail) : details.detail;\n\t\t\t\turl = d.record_map_url || d.url;\n\t\t\t}\n\n\t\t\tif (!url) {\n\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", \"B01\", undefined, `No URL found in record details for B01 history map (startTime: ${startTime})`, \"warn\");\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst dummyId = -Math.floor(Math.random() * 1000000);\n\n\t\t\tconst historyMapPromise = new Promise<{ mapBase64CleanUncropped: string; mapBase64: string; mapBase64Truncated: string; mapData: string } | null>((resolve) => {\n\t\t\t\tthis.deps.adapter.pendingRequests.set(dummyId, {\n\t\t\t\t\tmethod: \"get_clean_record_map\",\n\t\t\t\t\tduid: this.duid,\n\t\t\t\t\tresolve: (data: Buffer) => {\n\t\t\t\t\t\tthis.deps.adapter.pendingRequests.delete(dummyId);\n\t\t\t\t\t\tvoid this.processHistoryMapResponse(data, resolve);\n\t\t\t\t\t},\n\t\t\t\t\treject: () => {\n\t\t\t\t\t\tthis.deps.adapter.pendingRequests.delete(dummyId);\n\t\t\t\t\t\tresolve(null);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tthis.deps.adapter.setTimeout(() => {\n\t\t\t\t\tif (this.deps.adapter.pendingRequests.has(dummyId)) {\n\t\t\t\t\t\tthis.deps.adapter.pendingRequests.delete(dummyId);\n\t\t\t\t\t\tresolve(null);\n\t\t\t\t\t}\n\t\t\t\t}, 30000);\n\t\t\t});\n\n\t\t\ttry {\n\t\t\t\tawait this.deps.adapter.requestsHandler.sendRequest(this.duid, \"service.upload_record_by_url\", { url }, { priority: -10 });\n\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Debug\", \"B01\", undefined, `Triggered B01 History Map update for URL: ${url}`, \"debug\");\n\t\t\t} catch (e: any) {\n\t\t\t\tthis.deps.adapter.pendingRequests.delete(dummyId);\n\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", \"B01\", undefined, `Failed to trigger B01 history map upload: ${e.message}`, \"warn\");\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn historyMapPromise;\n\t\t} catch (e: any) {\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Failed to get cleaning record map (B01): ${e.message}`, \"warn\");\n\t\t\treturn null;\n\t\t}\n\t}\n\t// Override processCleanSummary to handle B01 specific structure and avoid redundant requests\n\tprotected async processCleanSummary(result: unknown): Promise<void> {\n\t\ttry {\n\t\t\t// B01 result structure is { total_time, total_area, total_count, record_list: [ { url, detail: string }, ... ] }\n\t\t\tlet sd = result as { data?: any; total_time: number; total_area: number; total_count: number; record_list: any[] };\n\t\t\tif (sd && sd.data) {\n\t\t\t\tsd = sd.data;\n\t\t\t}\n\n\t\t\tif (!sd || !sd.record_list) {\n\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", \"B01\", undefined, \"Invalid B01 clean summary format\", \"warn\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Update Summary States\n\t\t\tawait this.updateSummaryState(\"clean_time\", sd.total_time);\n\t\t\tawait this.updateSummaryState(\"clean_area\", sd.total_area);\n\t\t\tawait this.updateSummaryState(\"clean_count\", sd.total_count);\n\n\t\t\tawait this.deps.ensureFolder(`Devices.${this.duid}.cleaningInfo.records`);\n\t\t\tconst recordList = sd.record_list;\n\t\t\tconst limit = 20;\n\n\t\t\trecordList.sort((a: unknown, b: unknown) => {\n\t\t\t\tconst timeA = this.extractStartTime(a);\n\t\t\t\tconst timeB = this.extractStartTime(b);\n\t\t\t\treturn timeB - timeA;\n\t\t\t});\n\n\n\t\t\tfor (let i = 0; i < Math.min(recordList.length, limit); i++) {\n\t\t\t\tconst recordItem = recordList[i];\n\t\t\t\tlet detail: any = null;\n\n\t\t\t\ttry {\n\t\t\t\t\tdetail = typeof recordItem.detail === \"string\" ? JSON.parse(recordItem.detail) : recordItem.detail;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Error\", \"B01\", undefined, `Failed to parse record detail: ${e}`, \"error\");\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tif (!detail) continue;\n\n\t\t\t\tconst index = i;\n\n\t\t\t\tawait this.deps.ensureFolder(`Devices.${this.duid}.cleaningInfo.records.${index}`);\n\n\t\t\t\tawait this.processRecordAttributes(index, detail);\n\n\t\t\t\tif (detail.record_map_url || detail.url || recordItem.url) {\n\t\t\t\t\tawait this.processRecordMap(index, detail, recordItem);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst jsonSummary = {\n\t\t\t\tclean_time: Number((sd.total_time / 3600).toFixed(2)),\n\t\t\t\tclean_area: Number((sd.total_area / 1000000).toFixed(2)),\n\t\t\t\tclean_count: sd.total_count,\n\t\t\t\trecords: recordList.map((r: any) => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\treturn typeof r.detail === \"string\" ? JSON.parse(r.detail) : r.detail;\n\t\t\t\t\t} catch { return null; }\n\t\t\t\t}).filter((r: any) => r !== null)\n\t\t\t};\n\n\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.cleaningInfo.JSON`, { val: JSON.stringify(jsonSummary), ack: true });\n\n\n\t\t} catch (e: any) {\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Error\", \"B01\", undefined, `Error processing B01 clean summary: ${e.message}`, \"error\");\n\t\t}\n\t}\n\n\tprivate async updateSummaryState(attr: string, value: number): Promise<void> {\n\t\tlet val = value;\n\t\tif (attr === \"clean_time\") {\n\t\t\tval = Number((val / 3600).toFixed(2));\n\t\t} else if (attr === \"clean_area\") {\n\t\t\tval = Number((val / 1000000).toFixed(2));\n\t\t}\n\n\t\tawait this.deps.ensureState(`Devices.${this.duid}.cleaningInfo.${attr}`, {\n\t\t\tname: attr,\n\t\t\ttype: \"number\",\n\t\t\trole: \"value\",\n\t\t\tread: true,\n\t\t\twrite: false\n\t\t});\n\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.cleaningInfo.${attr}`, { val, ack: true });\n\t}\n\n\n\tprivate extractStartTime(record: unknown): number {\n\t\ttry {\n\t\t\tconst r = record as Record<string, unknown>;\n\t\t\tconst detail = typeof r.detail === \"string\" ? JSON.parse(r.detail) : r.detail;\n\t\t\treturn detail.record_start_time || detail.begin || 0;\n\t\t} catch {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tprivate async processRecordAttributes(index: number, detail: Record<string, unknown>): Promise<void> {\n\t\tfor (const key in detail) {\n\t\t\tconst val = detail[key];\n\t\t\tconst mappedKey = B01VacuumFeatures.MAPPED_CLEAN_SUMMARY[key] || key;\n\n\t\t\t// Simple type mapping\n\t\t\tconst type = typeof val;\n\t\t\tif (type !== \"string\" && type !== \"number\" && type !== \"boolean\") continue;\n\n\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.cleaningInfo.records.${index}.${mappedKey}`, {\n\t\t\t\tname: mappedKey,\n\t\t\t\ttype: type as ioBroker.CommonType,\n\t\t\t\trole: \"value\",\n\t\t\t\tread: true,\n\t\t\t\twrite: false\n\t\t\t});\n\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.cleaningInfo.records.${index}.${mappedKey}`, { val: val as ioBroker.StateValue, ack: true });\n\t\t}\n\t}\n\n\tpublic override async detectAndApplyRuntimeFeatures(statusData: Readonly<Record<string, unknown>>): Promise<boolean> {\n\t\t// B01 features are statically defined, parameter unused but required by signature\n\t\tvoid statusData;\n\t\treturn false;\n\t}\n\n\tprotected override getDynamicFeatures(): Set<Feature> {\n\t\treturn new Set<Feature>(); // B01 does not use bitfield feature flags\n\t}\n\n\tpublic override async processDockType(dockType: number): Promise<void> {\n\t\t// B01 dock features are handled via static command definitions, parameter unused but required by signature\n\t\tvoid dockType;\n\t}\n\n\tpublic override getCommonDeviceStates(attribute: string | number): Partial<ioBroker.StateCommon> | undefined {\n\t\t// Map B01 properties to readable states\n\t\tconst lang = this.deps.adapter.language || \"en\";\n\n\t\t// Fan Power (wind)\n\t\tif (attribute === \"wind\" || attribute === \"fan_power\") {\n\t\t\t// Map B01 (1-5) to Standard (101-105) for text retrieval\n\t\t\tconst b01FanMap: Record<number, number> = { 1: 101, 2: 102, 3: 103, 4: 104, 5: 105 };\n\t\t\tconst states: Record<number, string> = {};\n\n\t\t\tfor (const [b01Val, stdVal] of Object.entries(b01FanMap)) {\n\t\t\t\tstates[parseInt(b01Val)] = this.locales.getFanPowerText(stdVal, lang);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: states\n\t\t\t};\n\t\t}\n\n\t\t// Water Level (water)\n\t\tif (attribute === \"water\" || attribute === \"water_box_mode\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: this.locales.getWaterBoxModeText(200, lang), // Off\n\t\t\t\t\t1: this.locales.getWaterBoxModeText(201, lang), // Low\n\t\t\t\t\t2: this.locales.getWaterBoxModeText(202, lang), // Medium\n\t\t\t\t\t3: this.locales.getWaterBoxModeText(203, lang)  // High\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// Status\n\t\tif (attribute === \"status\" || attribute === \"state\") {\n\t\t\tconst states: Record<number, string> = {\n\t\t\t\t0: \"Unknown\",\n\t\t\t\t1: \"Initiating\",\n\t\t\t\t2: \"Sleeping\",\n\t\t\t\t3: \"Idle\",\n\t\t\t\t4: \"Remote Control\",\n\t\t\t\t5: \"Cleaning\",\n\t\t\t\t6: \"Returning Dock\",\n\t\t\t\t7: \"Manual Mode\",\n\t\t\t\t8: \"Charging\",\n\t\t\t\t9: \"Charging Error\",\n\t\t\t\t10: \"Paused\",\n\t\t\t\t11: \"Spot Cleaning\",\n\t\t\t\t12: \"In Error\",\n\t\t\t\t13: \"Shutting Down\",\n\t\t\t\t14: \"Updating\",\n\t\t\t\t15: \"Docking\",\n\t\t\t\t16: \"Go To\",\n\t\t\t\t17: \"Zone Clean\",\n\t\t\t\t18: \"Room Clean\",\n\t\t\t\t22: \"Emptying Dust Container\",\n\t\t\t\t23: \"Washing Mop\",\n\t\t\t\t26: \"Going to Wash Mop\",\n\t\t\t\t28: \"In Call\",\n\t\t\t\t29: \"Mapping\",\n\t\t\t\t100: \"Fully Charged\"\n\t\t\t};\n\n\t\t\t// Override with dataset translations if available\n\t\t\tfor (const code in states) {\n\t\t\t\tconst key = this.locales.getStatusKey(code);\n\t\t\t\tif (key) {\n\t\t\t\t\tstates[Number(code)] = this.locales.getText(key, lang);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: states\n\t\t\t};\n\t\t}\n\n\t\t// Cleaning Stats\n\t\tif (attribute === \"clean_time\" || attribute === \"cleaning_time\" || attribute === \"total_clean_time\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tunit: \"min\"\n\t\t\t};\n\t\t}\n\t\tif (attribute === \"clean_area\" || attribute === \"cleaning_area\" || attribute === \"last_clean_area\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tunit: \"m\"\n\t\t\t};\n\t\t}\n\t\tif (attribute === \"quantity\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tunit: \"%\"\n\t\t\t};\n\t\t}\n\t\tif (attribute === \"real_clean_time\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\trole: \"value.interval\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tunit: \"s\"\n\t\t\t};\n\t\t}\n\t\tif (attribute === \"clean_finish\") {\n\t\t\treturn {\n\t\t\t\ttype: \"string\",\n\t\t\t\trole: \"value.datetime\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t};\n\t\t}\n\t\tif (attribute === \"last_clean_t\") {\n\t\t\treturn {\n\t\t\t\ttype: \"string\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute))\n\t\t\t};\n\t\t}\n\n\t\t// Error Codes\n\t\tif (attribute === \"error_code\" || attribute === \"fault\") {\n\t\t\tconst states: Record<string, string> = { \"0\": \"No Error\" };\n\t\t\tconst codes = this.locales.getErrorCodes();\n\t\t\tfor (const code of codes) {\n\t\t\t\tstates[code.toString()] = this.locales.getErrorText(code, lang);\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: states\n\t\t\t};\n\t\t}\n\n\n\t\t// 5. Dock Status\n\t\tif (attribute === \"dock_status\") {\n\t\t\tconst states: Record<number, string> = {\n\t\t\t\t0: \"Undocked\",\n\t\t\t\t1: \"Docking\",\n\t\t\t\t2: \"Docked\",\n\t\t\t\t3: \"Leaving Dock\",\n\t\t\t\t255: \"Unknown\"\n\t\t\t};\n\t\t\t// TODO: Add dataset mapping for dock_status if possible\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: states\n\t\t\t};\n\t\t}\n\n\t\t// 6. Dust Collection Status\n\t\tif (attribute === \"dust_collection_status\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Idle\",\n\t\t\t\t\t1: \"Collecting\",\n\t\t\t\t\t2: \"Collection Weaker\",\n\t\t\t\t\t3: \"Collection Failed\",\n\t\t\t\t\t4: \"Dustbin Full\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 7. Map Status\n\t\tif (attribute === \"map_status\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Unmapped\",\n\t\t\t\t\t1: \"Mapped\",\n\t\t\t\t\t2: \"Mapping\",\n\t\t\t\t\t3: \"Loading\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 8. Charge State\n\t\tif (attribute === \"charge_state\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Charging\",\n\t\t\t\t\t1: \"Not Charging\",\n\t\t\t\t\t2: \"Fully Charged\",\n\t\t\t\t\t3: \"Charge Failed\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 9. Work Mode\n\t\tif (attribute === \"work_mode\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Standard\",\n\t\t\t\t\t1: \"Custom\",\n\t\t\t\t\t2: \"Silent\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 10. Robot Mode\n\t\tif (attribute === \"mode\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Vacuum\",\n\t\t\t\t\t1: \"Vacuum & Mop\",\n\t\t\t\t\t2: \"Mop\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 10. Tank State (Water Box)\n\t\tif (attribute === \"tank_state\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Installed\",\n\t\t\t\t\t1: \"Removed\",\n\t\t\t\t\t2: \"Empty\",\n\t\t\t\t\t3: \"Unknown\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 11. Sweep Type (Mop Route)\n\t\tif (attribute === \"sweep_type\" || attribute === \"mop_mode\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: this.locales.getMopModeText(300, lang) || \"Standard\",\n\t\t\t\t\t1: this.locales.getMopModeText(301, lang) || \"Deep\",\n\t\t\t\t\t300: this.locales.getMopModeText(300, lang),\n\t\t\t\t\t301: this.locales.getMopModeText(301, lang),\n\t\t\t\t\t302: this.locales.getMopModeText(302, lang),\n\t\t\t\t\t303: this.locales.getMopModeText(303, lang)\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 12. Cloth State (Mop Pad)\n\t\tif (attribute === \"cloth_state\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: this.locales.getClothStateText(0, lang),\n\t\t\t\t\t1: this.locales.getClothStateText(1, lang),\n\t\t\t\t\t2: this.locales.getClothStateText(2, lang)\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 13. Multi Floor\n\t\tif (attribute === \"multi_floor\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Disabled\",\n\t\t\t\t\t1: \"Enabled\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 14. Quiet Is Open (DND Mode)\n\t\tif (attribute === \"quiet_is_open\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Off\",\n\t\t\t\t\t1: \"On\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 15. Dust Collection Frequency\n\t\tif (attribute === \"dust_frequency\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Smart\",\n\t\t\t\t\t1: \"Low\",\n\t\t\t\t\t2: \"Medium\",\n\t\t\t\t\t3: \"High\",\n\t\t\t\t\t4: \"Never\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 16. Clean Path Preference\n\t\tif (attribute === \"clean_path_preference\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Standard\",\n\t\t\t\t\t1: \"Fast\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 17. Repeat State\n\t\tif (attribute === \"repeat_state\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Off\",\n\t\t\t\t\t1: \"On\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 18. Dust Action\n\t\tif (attribute === \"dust_action\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Idle\",\n\t\t\t\t\t1: \"Emptying\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 19. Build Map\n\t\tif (attribute === \"build_map\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Off\",\n\t\t\t\t\t1: \"On\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 20. Map Num\n\t\tif (attribute === \"map_num\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tunit: \"maps\"\n\t\t\t};\n\t\t}\n\n\n\n\t\t// 22. Custom Type\n\t\tif (attribute === \"custom_type\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t0: \"Off\",\n\t\t\t\t\t1: \"On\"\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 23. Add Sweep Status\n\t\tif (attribute === \"add_sweep_status\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t\tstates: {\n\t\t\t\t\t\"-1\": \"Unknown\",\n\t\t\t\t\t0: this.locales.getText(\"common_off\", lang),\n\t\t\t\t\t1: this.locales.getText(\"common_on\", lang)\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\t// 24. Language\n\t\tif (attribute === \"language\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t};\n\t\t}\n\n\t\t// 25. Time Zone\n\t\tif (attribute === \"time_zone\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t};\n\t\t}\n\t\tif (attribute === \"time_zone_info\") {\n\t\t\treturn {\n\t\t\t\ttype: \"string\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t};\n\t\t}\n\n\t\t// 26. Recommend\n\t\tif (attribute === \"recommend\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t};\n\t\t}\n\n\t\t// 27. PU Charging\n\t\tif (attribute === \"pu_charging\") {\n\t\t\treturn {\n\t\t\t\ttype: \"number\",\n\t\t\t\tname: this.locales.getNameAll(String(attribute)),\n\t\t\t};\n\t\t}\n\n\t\t// Default fallback using getNameAll\n\t\tconst keyName = String(attribute);\n\t\tconst translatedName = this.locales.getNameAll(keyName);\n\t\tif (translatedName !== keyName) {\n\t\t\treturn {\n\t\t\t\tname: translatedName,\n\t\t\t\ttype: \"mixed\",\n\t\t\t\trole: \"value\",\n\t\t\t\tread: true,\n\t\t\t\twrite: false\n\t\t\t};\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tpublic override async updateNetworkInfo(): Promise<void> {\n\t\ttry {\n\t\t\t// B01: Request via service.get_net_info? Or just rely on prop.get(\"net_status\")?\n\t\t\t// prop.get \"net_status\" usually just gives connected state.\n\t\t\t// Let's try service.get_network_info first as it's common.\n\t\t\tconst res = await this.deps.adapter.requestsHandler.sendRequest(this.duid, \"service.get_net_info\", {});\n\t\t\tif (!res) return;\n\n\t\t\t// Typically returns { ssid, ip, mac, rssi... }\n\t\t\tconst info = Array.isArray(res) ? res[0] : res;\n\n\t\t\tif (!info) return;\n\n\t\t\tawait this.deps.ensureFolder(`Devices.${this.duid}.networkInfo`);\n\t\t\tfor (const key in info) {\n\t\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.networkInfo.${key}`, {\n\t\t\t\t\tname: key,\n\t\t\t\t\ttype: typeof info[key] as ioBroker.CommonType,\n\t\t\t\t\tread: true,\n\t\t\t\t\twrite: false\n\t\t\t\t});\n\t\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.networkInfo.${key}`, { val: info[key], ack: true });\n\t\t\t}\n\t\t} catch (e: any) {\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", \"B01\", undefined, `Failed to update network info: ${e.message}`, \"warn\");\n\t\t}\n\t}\n\n\n\n\tprotected async processConsumables(resultObj: Record<string, unknown>): Promise<void> {\n\t\tawait this.deps.ensureFolder(`Devices.${this.duid}.consumables`);\n\t\tawait this.deps.ensureFolder(`Devices.${this.duid}.resetConsumables`);\n\n\t\t// Process Net Status if present (B01)\n\t\tif (resultObj.net_status) {\n\t\t\tawait this.processNetworkInfo(resultObj.net_status);\n\t\t}\n\n\t\t// Process other B01 settings\n\t\tconst settingsToProcess = [\"volume\", \"voice_type\", \"light_mode\", \"child_lock\", \"sound\", \"charge_station_type\", \"dust_auto_state\"];\n\t\tfor (const key of settingsToProcess) {\n\t\t\tif (resultObj[key] !== undefined) {\n\t\t\t\tconst type = resultObj[key] === null ? \"mixed\" : typeof resultObj[key];\n\t\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.deviceStatus.${key}`, {\n\t\t\t\t\tname: key,\n\t\t\t\t\ttype: type as ioBroker.CommonType,\n\t\t\t\t\trole: \"value\",\n\t\t\t\t\twrite: false\n\t\t\t\t});\n\t\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.deviceStatus.${key}`, { val: resultObj[key] as ioBroker.StateValue, ack: true });\n\t\t\t}\n\t\t}\n\n\t\tfor (const key in resultObj) {\n\t\t\tconst val = resultObj[key];\n\n\t\t\tif (key === \"net_status\" || settingsToProcess.includes(key)) continue;\n\n\t\t\tconst common = this.getCommonDeviceStates(key) || {\n\t\t\t\tname: this.locales.getNameAll(key) || key,\n\t\t\t\ttype: typeof val as ioBroker.CommonType,\n\t\t\t\trole: \"value\",\n\t\t\t\twrite: false\n\t\t\t};\n\n\t\t\t// Check for specific consumables\n\t\t\tif ([\"main_brush_work_time\", \"side_brush_work_time\", \"filter_work_time\", \"filter_element_work_time\", \"sensor_dirty_time\"].includes(key)) {\n\t\t\t\tconst deviceName = key.replace(\"_work_time\", \"\").replace(\"_dirty_time\", \"\");\n\t\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.consumables.${deviceName}`, { ...common, unit: \"%\" });\n\n\t\t\t\tconst totalTime = this.getConsumableLifeSpan(deviceName) * 3600;\n\n\t\t\t\tif (totalTime > 0) {\n\t\t\t\t\tconst percent = Math.round(100 - ((val as number) / totalTime) * 100);\n\t\t\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.consumables.${deviceName}`, { val: percent, ack: true });\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.consumables.${key}`, common);\n\t\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.consumables.${key}`, { val: val as ioBroker.StateValue, ack: true });\n\t\t\t}\n\n\t\t\tif (key.endsWith(\"_work_time\") || key.endsWith(\"_dirty_time\")) {\n\t\t\t\tconst resetKey = key.replace(\"_work_time\", \"\").replace(\"_dirty_time\", \"\");\n\t\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.resetConsumables.${resetKey}`, { name: `Reset ${resetKey}`, type: \"boolean\", role: \"button\", write: true, def: false });\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async processNetworkInfo(data: unknown): Promise<void> {\n\t\tif (!data || typeof data !== \"object\") return;\n\n\t\tconst info = data as Record<string, unknown>;\n\n\t\tawait this.deps.ensureFolder(`Devices.${this.duid}.networkInfo`);\n\n\t\tconst mapping: Record<string, string> = {\n\t\t\tssid: \"ssid\",\n\t\t\tip: \"ip\",\n\t\t\tmac: \"mac\",\n\t\t\tbssid: \"bssid\",\n\t\t\trssi: \"rssi\",\n\t\t\tfrequency: \"frequency\" // Not standard but useful\n\t\t};\n\n\t\tfor (const [key, stateName] of Object.entries(mapping)) {\n\t\t\tif (info[key] !== undefined) {\n\t\t\t\tconst val = info[key];\n\t\t\t\tconst common = {\n\t\t\t\t\tname: stateName,\n\t\t\t\t\ttype: typeof val === \"number\" ? \"number\" : \"string\",\n\t\t\t\t\trole: key === \"rssi\" ? \"value.rssi\" : \"info\",\n\t\t\t\t\tread: true,\n\t\t\t\t\twrite: false\n\t\t\t\t} as ioBroker.StateCommon;\n\n\t\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.networkInfo.${stateName}`, common);\n\t\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.networkInfo.${stateName}`, { val: val as ioBroker.StateValue, ack: true });\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getConsumableLifeSpan(deviceName: string): number {\n\t\tswitch (deviceName) {\n\t\t\tcase \"main_brush\": return 300;\n\t\t\tcase \"side_brush\": return 200;\n\t\t\tcase \"filter\":\n\t\t\tcase \"filter_element\": return 150;\n\t\t\tcase \"sensor\": return 30;\n\t\t\tdefault: return 0;\n\t\t}\n\t}\n\n\tprivate async processUpdateMapResponse(data: Buffer): Promise<void> {\n\t\ttry {\n\t\t\tconst device = this.deps.adapter.http_api.getDevices().find(d => d.duid === this.duid);\n\t\t\tconst sn = device?.sn || this.duid;\n\n\t\t\tconst res = await this.mapManager.processMap(data, \"B01\", this.robotModel, sn, this.mappedRooms, this.duid, \"MQTT\");\n\t\t\tif (!res) return;\n\n\t\t\tconst { mapBase64, mapBase64Truncated, mapData } = res as { mapBase64: string; mapBase64Truncated: string; mapData: unknown };\n\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.map.mapBase64`, {\n\t\t\t\tname: \"Map Base64\",\n\t\t\t\ttype: \"string\",\n\t\t\t\trole: \"text.png\",\n\t\t\t\tread: true,\n\t\t\t\twrite: false\n\t\t\t});\n\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.map.mapBase64`, { val: mapBase64, ack: true });\n\n\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.map.mapBase64Truncated`, {\n\t\t\t\tname: \"Map Base64 Truncated\",\n\t\t\t\ttype: \"string\",\n\t\t\t\trole: \"text.png\",\n\t\t\t\tread: true,\n\t\t\t\twrite: false\n\t\t\t});\n\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.map.mapBase64Truncated`, { val: mapBase64Truncated, ack: true });\n\n\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.map.mapData`, {\n\t\t\t\tname: \"Map Data\",\n\t\t\t\ttype: \"string\",\n\t\t\t\trole: \"json\",\n\t\t\t\tread: true,\n\t\t\t\twrite: false\n\t\t\t});\n\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.map.mapData`, { val: JSON.stringify(mapData), ack: true });\n\n\t\t\t// Update internal room mapping from map data\n\t\t\tif ((mapData as any).rooms) {\n\t\t\t\tthis.mappedRooms = (mapData as any).rooms;\n\t\t\t\tawait this.updateRoomMapping();\n\t\t\t}\n\t\t} catch (err: any) {\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Error\", undefined, undefined, `Failed to process B01 map: ${err.message}`, \"error\");\n\t\t}\n\t}\n\n\tprivate async processRecordMap(index: number, detail: any, recordItem: any): Promise<void> {\n\t\tconst startTime = detail.record_start_time || detail.begin;\n\t\tconst mapRes = await this.getCleaningRecordMap(startTime, recordItem);\n\t\tif (!mapRes) return;\n\n\t\tawait this.deps.ensureState(`Devices.${this.duid}.cleaningInfo.records.${index}.mapBase64`, {\n\t\t\tname: \"Map Base64\",\n\t\t\ttype: \"string\",\n\t\t\trole: \"text\",\n\t\t\tread: true,\n\t\t\twrite: false\n\t\t});\n\t\tawait this.deps.ensureState(`Devices.${this.duid}.cleaningInfo.records.${index}.mapBase64Truncated`, {\n\t\t\tname: \"Map Base64 Truncated\",\n\t\t\ttype: \"string\",\n\t\t\trole: \"text\",\n\t\t\tread: true,\n\t\t\twrite: false\n\t\t});\n\n\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.cleaningInfo.records.${index}.mapBase64`, { val: mapRes.mapBase64, ack: true });\n\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.cleaningInfo.records.${index}.mapBase64Truncated`, { val: mapRes.mapBase64Truncated, ack: true });\n\n\t\t// Add the map_object state (Combined JSON)\n\t\tconst combinedObject = {\n\t\t\t...detail,\n\t\t\tmapBase64: mapRes.mapBase64,\n\t\t\tmapBase64Truncated: mapRes.mapBase64Truncated\n\t\t};\n\n\t\tawait this.deps.ensureState(`Devices.${this.duid}.cleaningInfo.records.${index}.map_object`, {\n\t\t\tname: \"Map Object\",\n\t\t\ttype: \"string\",\n\t\t\trole: \"json\",\n\t\t\tread: true,\n\t\t\twrite: false\n\t\t});\n\n\t\tawait this.deps.adapter.setState(`Devices.${this.duid}.cleaningInfo.records.${index}.map_object`, {\n\t\t\tval: JSON.stringify(combinedObject),\n\t\t\tack: true\n\t\t});\n\t}\n\n\tprotected async updateDockingStationStatus(dss: number): Promise<void> {\n\t\t// Guard: Feature must be active\n\t\tif (!this.appliedFeatures.has(Feature.DockingStationStatus)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Parse 2-bit status fields\n\t\tconst status = {\n\t\t\tcleanFluidStatus: (dss >> 10) & 0b11,        // Bits 10-11: Clean water tank status\n\t\t\twaterBoxFilterStatus: (dss >> 8) & 0b11,     // Bits 8-9: Water box filter\n\t\t\tdustBagStatus: (dss >> 6) & 0b11,            // Bits 6-7: Dust bag (Staubbeutel)\n\t\t\tdirtyWaterBoxStatus: (dss >> 4) & 0b11,      // Bits 4-5: Dirty water tank\n\t\t\tclearWaterBoxStatus: (dss >> 2) & 0b11,      // Bits 2-3: Clear water box\n\t\t\tisUpdownWaterReady: dss & 0b11,              // Bits 0-1: Water ready status\n\t\t};\n\n\t\tfor (const [name, val] of Object.entries(status)) {\n\t\t\tawait this.deps.adapter.setStateChanged(\n\t\t\t\t`Devices.${this.duid}.dockingStationStatus.${name}`,\n\t\t\t\t{ val: val, ack: true }\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected static readonly MAPPED_CLEAN_SUMMARY: Record<string, string> = { 0: \"clean_time\", 1: \"clean_area\", 2: \"clean_count\", 3: \"records\", record_list: \"records\" };\n\n\tpublic getCommonConsumable(attribute: string | number): Partial<ioBroker.StateCommon> | undefined {\n\t\treturn VACUUM_CONSTANTS.consumables[attribute as keyof typeof VACUUM_CONSTANTS.consumables] as Partial<ioBroker.StateCommon>;\n\t}\n\n\tpublic isResetableConsumable(consumable: string): boolean {\n\t\treturn VACUUM_CONSTANTS.resetConsumables.has(consumable);\n\t}\n\n\tpublic getCommonCleaningInfo(attribute: string | number): Partial<ioBroker.StateCommon> | undefined {\n\t\treturn VACUUM_CONSTANTS.cleaningInfo[attribute as keyof typeof VACUUM_CONSTANTS.cleaningInfo] as Partial<ioBroker.StateCommon>;\n\t}\n\n\tpublic getCommonCleaningRecords(attribute: string | number): Partial<ioBroker.StateCommon> | undefined {\n\t\tconst spec = VACUUM_CONSTANTS.cleaningRecords[attribute as keyof typeof VACUUM_CONSTANTS.cleaningRecords];\n\t\treturn spec as Partial<ioBroker.StateCommon> | undefined;\n\t}\n\n\tpublic getFirmwareFeatureName(featureID: string | number): string {\n\t\tconst name = VACUUM_CONSTANTS.firmwareFeatures[featureID as keyof typeof VACUUM_CONSTANTS.firmwareFeatures];\n\t\treturn name || `FeatureID_${featureID}`;\n\t}\n\n\tprivate async processHistoryMapResponse(data: unknown, resolve: (val: any) => void): Promise<void> {\n\t\tif (!Buffer.isBuffer(data)) {\n\t\t\tresolve(null);\n\t\t\treturn;\n\t\t}\n\t\ttry {\n\t\t\tconst devices = this.deps.adapter.http_api.getDevices();\n\t\t\tconst device = devices.find((d: any) => d.duid === this.duid);\n\t\t\tconst serial = device?.sn || this.duid;\n\n\t\t\tconst mapRes = await this.deps.adapter.mapManager.processMap(data, \"B01\", this.robotModel, serial, null, this.duid, \"B01History\");\n\n\t\t\tif (mapRes) {\n\t\t\t\tresolve({\n\t\t\t\t\tmapBase64CleanUncropped: mapRes.mapBase64Clean || mapRes.mapBase64,\n\t\t\t\t\tmapBase64: mapRes.mapBase64,\n\t\t\t\t\tmapBase64Truncated: mapRes.mapBase64Clean || mapRes.mapBase64,\n\t\t\t\t\tmapData: JSON.stringify(mapRes.mapData),\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", \"B01\", undefined, \"B01 History Map processing returned null.\", \"warn\");\n\t\t\t\tresolve(null);\n\t\t\t}\n\t\t} catch (e: any) {\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Error\", \"B01\", undefined, `Failed to process B01 history map: ${e.message}`, \"error\");\n\t\t\tresolve(null);\n\t\t}\n\t}\n}\n\n\n\n\n"]}