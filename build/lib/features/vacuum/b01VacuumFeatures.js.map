{"version":3,"file":"b01VacuumFeatures.js","sourceRoot":"","sources":["../../../../src/lib/features/vacuum/b01VacuumFeatures.ts"],"names":[],"mappings":"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","sourcesContent":["import { V1VacuumFeatures, VacuumProfile } from \"./v1VacuumFeatures\";\r\nimport { FeatureDependencies, DeviceModelConfig } from \"../baseDeviceFeatures\";\r\nimport { Feature } from \"../features.enum\";\r\n\r\nexport class B01VacuumFeatures extends V1VacuumFeatures {\r\n\r\n\tconstructor(\r\n\t\tdependencies: FeatureDependencies,\r\n\t\tduid: string,\r\n\t\trobotModel: string,\r\n\t\tconfig: DeviceModelConfig,\r\n\t\tprofile?: VacuumProfile\r\n\t) {\r\n\t\tsuper(dependencies, duid, robotModel, config, profile);\r\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Info\", \"B01\", undefined, `Constructing B01VacuumFeatures for ${robotModel}`, \"info\");\r\n\t}\r\n\r\n\r\n\r\n\t// Override updateStatus to use strict B01 prop.get\r\n\tpublic override async setupProtocolFeatures(): Promise<void> {\r\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Debug\", \"B01\", undefined, \"Configuring B01 Command Set...\", \"debug\");\r\n\r\n\t\t// 1. CLEAR all inherited base commands. B01 uses its own protocol.\r\n\t\tthis.commands = {};\r\n\r\n\t\t// 2. Add properties for prop.get\r\n\t\tconst properties = [\r\n\t\t\t\"wind\", \"water\", \"clean_mode\", \"status\", \"error_code\", \"battery\",\r\n\t\t\t\"clean_time\", \"clean_area\", \"map_status\", \"dock_status\", \"water_box_level_off\", \"dust_collection_status\"\r\n\t\t];\r\n\t\tconst propStates: Record<string, string> = {};\r\n\t\tproperties.forEach(p => propStates[p] = p);\r\n\r\n\t\tthis.addCommand(\"prop.get\", {\r\n\t\t\ttype: \"string\",\r\n\t\t\trole: \"text\",\r\n\t\t\tname: \"Property Get\",\r\n\t\t\tdef: \"status\",\r\n\t\t\tstates: propStates\r\n\t\t});\r\n\r\n\t\t// 3. Status Control (Start / Stop / Charge)\r\n\t\tthis.addCommand(\"status\", {\r\n\t\t\ttype: \"number\",\r\n\t\t\trole: \"value\",\r\n\t\t\tname: \"Status Control\",\r\n\t\t\tdef: 1,\r\n\t\t\tstates: {\r\n\t\t\t\t1: this.deps.adapter.translations[\"app_start\"] || \"Start Cleaning\",\r\n\t\t\t\t2: this.deps.adapter.translations[\"app_pause\"] || \"Pause\",\r\n\t\t\t\t3: this.deps.adapter.translations[\"app_stop\"] || \"Stop\",\r\n\t\t\t\t4: this.deps.adapter.translations[\"app_charge\"] || \"Return to Dock\"\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// 4. Fan Power (wind)\r\n\t\tthis.addCommand(\"wind\", {\r\n\t\t\ttype: \"number\",\r\n\t\t\trole: \"value\",\r\n\t\t\tname: \"Fan Power\",\r\n\t\t\tdef: 2,\r\n\t\t\tstates: {\r\n\t\t\t\t1: \"Quiet\",\r\n\t\t\t\t2: \"Balanced\",\r\n\t\t\t\t3: \"Turbo\",\r\n\t\t\t\t4: \"Max\"\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// 5. Water Level (water)\r\n\t\tthis.addCommand(\"water\", {\r\n\t\t\ttype: \"number\",\r\n\t\t\trole: \"value\",\r\n\t\t\tname: \"Water Level\",\r\n\t\t\tdef: 1,\r\n\t\t\tstates: {\r\n\t\t\t\t1: \"Low\",\r\n\t\t\t\t2: \"Medium\",\r\n\t\t\t\t3: \"High\"\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// 6. Work Mode\r\n\t\tthis.addCommand(\"work_mode\", {\r\n\t\t\ttype: \"number\",\r\n\t\t\trole: \"value\",\r\n\t\t\tname: \"Work Mode\",\r\n\t\t\tdef: 0,\r\n\t\t\tstates: {\r\n\t\t\t\t0: \"Standard\",\r\n\t\t\t\t1: \"Custom\",\r\n\t\t\t\t2: \"Silent\"\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// 7. Dust Collection Frequency\r\n\t\tthis.addCommand(\"dust_frequency\", {\r\n\t\t\ttype: \"number\",\r\n\t\t\trole: \"value\",\r\n\t\t\tname: \"Dust Collection Frequency\",\r\n\t\t\tdef: 0,\r\n\t\t\tstates: {\r\n\t\t\t\t0: \"Smart\",\r\n\t\t\t\t1: \"Low\",\r\n\t\t\t\t2: \"Medium\",\r\n\t\t\t\t3: \"High\",\r\n\t\t\t\t4: \"Never\"\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// 8. Clean Path Preference\r\n\t\tthis.addCommand(\"clean_path_preference\", {\r\n\t\t\ttype: \"number\",\r\n\t\t\trole: \"value\",\r\n\t\t\tname: \"Clean Path Preference\",\r\n\t\t\tdef: 0,\r\n\t\t\tstates: {\r\n\t\t\t\t0: \"Standard\",\r\n\t\t\t\t1: \"Fast\"\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// 9. Build Map\r\n\t\tthis.addCommand(\"build_map\", {\r\n\t\t\ttype: \"number\",\r\n\t\t\trole: \"value\",\r\n\t\t\tname: \"Build Map\",\r\n\t\t\tdef: 1,\r\n\t\t\tstates: {\r\n\t\t\t\t0: \"Off\",\r\n\t\t\t\t1: \"On\"\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// 10. Robot Mode\r\n\t\tthis.addCommand(\"mode\", {\r\n\t\t\ttype: \"number\",\r\n\t\t\trole: \"value\",\r\n\t\t\tname: \"Robot Mode\",\r\n\t\t\tdef: 0,\r\n\t\t\tstates: {\r\n\t\t\t\t0: \"Vacuum\",\r\n\t\t\t\t1: \"Mop\",\r\n\t\t\t\t2: \"Vacuum & Mop\"\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// 11. Custom Mode\r\n\t\tthis.addCommand(\"custom_type\", {\r\n\t\t\ttype: \"number\",\r\n\t\t\trole: \"value\",\r\n\t\t\tname: \"Custom Mode\",\r\n\t\t\tdef: 0,\r\n\t\t\tstates: {\r\n\t\t\t\t0: \"Off\",\r\n\t\t\t\t1: \"On\"\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t// 12. Service Commands (as individual buttons)\r\n\t\tconst services = {\r\n\t\t\t\"update_map\": \"Update Map\",\r\n\t\t\t\"start_recharge\": \"Start Charging\",\r\n\t\t\t\"stop_recharge\": \"Stop Charging\",\r\n\t\t\t\"start_dust_collection\": \"Start Emptying\",\r\n\t\t\t\"stop_dust_collection\": \"Stop Emptying\",\r\n\t\t\t\"reset_main_brush\": \"Reset Main Brush\",\r\n\t\t\t\"reset_side_brush\": \"Reset Side Brush\",\r\n\t\t\t\"reset_filter\": \"Reset Filter\"\r\n\t\t};\r\n\r\n\t\tfor (const [srv, srvName] of Object.entries(services)) {\r\n\t\t\tthis.addCommand(srv, {\r\n\t\t\t\ttype: \"boolean\",\r\n\t\t\t\trole: \"button\",\r\n\t\t\t\tname: srvName,\r\n\t\t\t\tdef: false\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst cmds = Object.keys(this.commands);\r\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Info\", \"B01\", undefined, `B01 Protocol Enforced. Commands in memory: ${cmds.join(\", \")}`, \"info\");\r\n\t}\r\n\r\n\t/**\r\n\t * Allows feature handlers to provide/modify parameters for a command before sending.\r\n\t * B01 uses this to map individual command states to prop.set or service calls.\r\n\t */\r\n\tpublic override async getCommandParams(method: string, params?: unknown): Promise<any> {\r\n\t\t// Intercept individual commands and route to prop.set or service\r\n\t\tif ([\"status\", \"wind\", \"water\", \"work_mode\", \"dust_frequency\", \"clean_path_preference\", \"build_map\", \"mode\", \"custom_type\"].includes(method)) {\r\n\t\t\treturn {\r\n\t\t\t\tmethod: \"prop.set\",\r\n\t\t\t\tparams: { [method]: params }\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// Service calls\r\n\t\tconst serviceMap: Record<string, { method: string, params: any }> = {\r\n\t\t\t\"update_map\": { method: \"service\", params: { \"method\": \"upload_by_maptype\", \"params\": { \"force\": 1, \"map_type\": 0 } } },\r\n\t\t\t\"start_recharge\": { method: \"service\", params: { \"method\": \"start_recharge\", \"params\": {} } },\r\n\t\t\t\"stop_recharge\": { method: \"service\", params: { \"method\": \"stop_recharge\", \"params\": {} } },\r\n\t\t\t\"start_dust_collection\": { method: \"service\", params: { \"method\": \"start_dust_collection\", \"params\": {} } },\r\n\t\t\t\"stop_dust_collection\": { method: \"service\", params: { \"method\": \"stop_dust_collection\", \"params\": {} } },\r\n\t\t\t\"reset_main_brush\": { method: \"service\", params: { \"method\": \"reset_consumable\", \"params\": { \"main_brush_life\": 100 } } },\r\n\t\t\t\"reset_side_brush\": { method: \"service\", params: { \"method\": \"reset_consumable\", \"params\": { \"side_brush_life\": 100 } } },\r\n\t\t\t\"reset_filter\": { method: \"service\", params: { \"method\": \"reset_consumable\", \"params\": { \"filter_life\": 100 } } }\r\n\t\t};\r\n\r\n\t\tif (serviceMap[method]) {\r\n\t\t\treturn serviceMap[method];\r\n\t\t}\r\n\r\n\t\treturn params;\r\n\t}\r\n\r\n\r\n\r\n\tpublic override async initializeDeviceData(): Promise<void> {\r\n\t\tawait this.updateStatus();\r\n\t\tawait Promise.all([\r\n\t\t\tthis.updateFirmwareFeatures(),\r\n\t\t\tthis.updateMultiMapsList(),\r\n\t\t\tthis.updateRoomMapping(),\r\n\t\t]);\r\n\r\n\t\tawait this.deps.adapter.checkForNewFirmware(this.duid);\r\n\r\n\t\t// Model-specific requests\r\n\t\tawait this.updateExtraStatus();\r\n\r\n\t\t// Initial Map\r\n\t\tawait this.updateMap();\r\n\t}\r\n\r\n\t// Override updateStatus to use strict B01 prop.get\r\n\tpublic override async updateStatus(): Promise<void> {\r\n\t\tconst props = V1VacuumFeatures.CONSTANTS.b01StatusProps;\r\n\t\tlet resultObj: Record<string, any> | undefined;\r\n\r\n\t\ttry {\r\n\t\t\tconst result = await this.deps.adapter.requestsHandler.sendRequest(this.duid, \"prop.get\", { property: props });\r\n\r\n\t\t\tif (Array.isArray(result) && result.length === props.length) {\r\n\t\t\t\tresultObj = {};\r\n\t\t\t\tprops.forEach((key: string, index: number) => {\r\n                    resultObj![key] = result[index];\r\n\t\t\t\t});\r\n\t\t\t} else if (typeof result === \"object\" && result !== null) {\r\n\t\t\t\tresultObj = result;\r\n\t\t\t}\r\n\r\n\t\t\tif (resultObj) {\r\n\t\t\t\tawait this.processStatus(resultObj);\r\n\t\t\t\t// B01: Features are static/protocol-defined, skipping dynamic detection\r\n\t\t\t}\r\n\t\t} catch (e: any) {\r\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Failed to update status (B01): ${e.message}`, \"warn\");\r\n\t\t}\r\n\t}\r\n\r\n\t// Override updateConsumables to use strict B01 prop.get\r\n\tpublic override async updateConsumables(data?: any): Promise<void> {\r\n\t\tlet resultObj: Record<string, any> | undefined;\r\n\r\n\t\tif (data) {\r\n\t\t\tresultObj = data;\r\n\t\t} else {\r\n    \t\tconst props = V1VacuumFeatures.CONSTANTS.b01SettingsProps;\r\n    \t\tconst result = await this.deps.adapter.requestsHandler.sendRequest(this.duid, \"prop.get\", { property: props });\r\n    \t\tif (Array.isArray(result) && result.length === props.length) {\r\n    \t\t\tresultObj = {};\r\n    \t\t\tprops.forEach((key: string, index: number) => {\r\n    \t\t\t\tresultObj![key] = result[index];\r\n    \t\t\t});\r\n    \t\t} else if (typeof result === \"object\" && result !== null) {\r\n    \t\t\tresultObj = result as Record<string, any>;\r\n    \t\t}\r\n\t\t}\r\n\r\n\t\tif (resultObj) {\r\n\t\t\tawait this.processConsumables(resultObj);\r\n\t\t}\r\n\t}\r\n\r\n\t// Override processStatus to apply B01 specific conversions (dm² to m²)\r\n\tprotected override async processStatus(resultObj: Record<string, any>): Promise<void> {\r\n\t\t// Prioritize dock_type processing to ensure feature flags are set\r\n\t\tconst dockType = resultObj[\"dock_type\"];\r\n\t\tif (dockType !== undefined) {\r\n\t\t\tawait this.processDockType(Number(dockType));\r\n\t\t}\r\n\r\n\t\t// Handle docking station status separately\r\n\t\tconst dssValue = resultObj[\"dss\"];\r\n\t\tif (dssValue !== undefined) {\r\n\t\t\tdelete resultObj[\"dss\"];\r\n\t\t\tawait this.updateDockingStationStatus(Number(dssValue));\r\n\t\t}\r\n\r\n\t\t// Map B01 specific keys to standard ioBroker states for compatibility\r\n\t\t// Map B01 specific keys to standard ioBroker states for compatibility\r\n\r\n\r\n\t\tawait this.deps.ensureFolder(`Devices.${this.duid}.deviceStatus`);\r\n\t\tfor (const key in resultObj) {\r\n\t\t\tlet val = resultObj[key];\r\n\r\n\t\t\t// Get definition or create default\r\n\t\t\tconst def = this.getCommonDeviceStates(key);\r\n\t\t\tconst common: any = def ? { ...def } : { name: key, type: typeof val as ioBroker.CommonType, role: \"value\", read: true, write: false };\r\n\r\n\t\t\t// Enrich with defaults if missing\r\n\t\t\tif (!common.name) common.name = key;\r\n\t\t\tif (!common.role) common.role = \"value\";\r\n\t\t\tif (common.read === undefined) common.read = true;\r\n\t\t\tif (common.write === undefined) common.write = false;\r\n\r\n\t\t\t// Manual Metadata Overrides for B01 specific fields\r\n\t\t\tif (key === \"clean_finish\") {\r\n\t\t\t\tcommon.name = \"Clean Finish Timestamp\";\r\n\t\t\t\tcommon.role = \"value.time\";\r\n\t\t\t\tcommon.unit = null; // Ensure no unit residue\r\n\t\t\t} else if (key === \"cleaning_time\" || key === \"real_clean_time\") {\r\n\t\t\t\tcommon.name = key === \"cleaning_time\" ? \"Cleaning Time\" : \"Real Cleaning Time\";\r\n\t\t\t\tcommon.role = \"value.interval\";\r\n\t\t\t\tcommon.unit = key === \"cleaning_time\" ? \"min\" : \"s\";\r\n\t\t\t} else if (key === \"cleaning_area\") {\r\n\t\t\t\tcommon.name = \"Cleaning Area\";\r\n\t\t\t}\r\n\r\n\t\t\t// Serialize complex objects\r\n\t\t\tif (typeof val === \"object\" && val !== null) {\r\n\t\t\t\tval = JSON.stringify(val);\r\n\t\t\t}\r\n\r\n\t\t\t// Debug clean_finish value\r\n\t\t\tif (key === \"clean_finish\") {\r\n\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Debug\", \"B01\", undefined, `clean_finish raw: ${val}`, \"debug\");\r\n\t\t\t}\r\n\r\n\t\t\t// B01 Area/Time Conversion\r\n\t\t\tif ([\"clean_time\", \"cleaning_time\"].includes(key)) {\r\n\t\t\t\t// sniffs show 'cleaning_time: 25' for 25 min -> already in minutes. No conversion needed.\r\n\t\t\t\t// last_clean_t might be timestamp or duration? usually timestamp if clean_finish.\r\n\t\t\t\tval = Number(val);\r\n\t\t\t} else if ([\"cleaning_area\", \"cleaning_area\", \"last_clean_area\"].includes(key)) {\r\n\t\t\t\t// B01 sends dm² (e.g. 2129 -> 21.29 m²)\r\n\t\t\t\tval = Number(((val as number) / 100).toFixed(2));\r\n\t\t\t}\r\n\r\n\t\t\tif (common.type === \"string\" && typeof val !== \"string\") {\r\n\t\t\t\tval = String(val);\r\n\t\t\t}\r\n\r\n\t\t\t// Force object update to ensure units/states are applied\r\n\t\t\t// extendObject ensures that if the object exists, it gets updated with new common properties\r\n\t\t\tawait this.deps.adapter.extendObject(`Devices.${this.duid}.deviceStatus.${key}`, {\r\n\t\t\t\ttype: \"state\",\r\n\t\t\t\tcommon: common\r\n\t\t\t});\r\n\r\n\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.deviceStatus.${key}`, common);\r\n\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.deviceStatus.${key}`, { val: val, ack: true });\r\n\t\t}\r\n\t}\r\n\r\n\t// Override updateMap to use B01 service call\r\n\tpublic override async updateMap(): Promise<void> {\r\n\t\ttry {\r\n\t\t\t// Trigger map push (Protocol 301)\r\n\t\t\tawait this.deps.adapter.requestsHandler.sendRequest(this.duid, \"service.upload_by_maptype\", {\r\n\t\t\t\tforce: 1,\r\n\t\t\t\tmap_type: 0\r\n\t\t\t});\r\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Debug\", \"B01\", undefined, \"Triggered B01 Map update via service.upload_by_maptype\", \"debug\");\r\n\r\n\t\t\t// Pending Request to handle the async 301 push\r\n\t\t\tconst dummyId = -Math.floor(Math.random() * 1000000);\r\n\r\n\t\t\tthis.deps.adapter.pendingRequests.set(dummyId, {\r\n\t\t\t\tmethod: \"get_map_v1\",\r\n\t\t\t\tduid: this.duid,\r\n\t\t\t\tresolve: (data: any) => {\r\n\t\t\t\t\tthis.deps.adapter.pendingRequests.delete(dummyId);\r\n\t\t\t\t\tif (Buffer.isBuffer(data)) {\r\n\t\t\t\t\t\tconst device = this.deps.adapter.http_api.getDevices().find(d => d.duid === this.duid);\r\n\t\t\t\t\t\tconst sn = device?.sn || this.duid;\r\n\r\n\t\t\t\t\t\tthis.mapManager.processMap(data, \"B01\", this.robotModel, sn, this.mappedRooms, this.duid, \"MQTT\")\r\n\t\t\t\t\t\t\t.then(async (res) => {\r\n\t\t\t\t\t\t\t\tif (res) {\r\n\t\t\t\t\t\t\t\t\tconst { mapBase64, mapBase64Truncated, mapData } = res as any;\r\n\t\t\t\t\t\t\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.map.mapBase64`, {\r\n\t\t\t\t\t\t\t\t\t\tname: \"Map Image\",\r\n\t\t\t\t\t\t\t\t\t\ttype: \"string\",\r\n\t\t\t\t\t\t\t\t\t\trole: \"text.png\",\r\n\t\t\t\t\t\t\t\t\t\tread: true,\r\n\t\t\t\t\t\t\t\t\t\twrite: false\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.map.mapBase64`, { val: mapBase64, ack: true });\r\n\r\n\t\t\t\t\t\t\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.map.mapBase64Truncated`, {\r\n\t\t\t\t\t\t\t\t\t\tname: \"Map Image Truncated\",\r\n\t\t\t\t\t\t\t\t\t\ttype: \"string\",\r\n\t\t\t\t\t\t\t\t\t\trole: \"text.png\",\r\n\t\t\t\t\t\t\t\t\t\tread: true,\r\n\t\t\t\t\t\t\t\t\t\twrite: false\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.map.mapBase64Truncated`, { val: mapBase64Truncated, ack: true });\r\n\r\n\t\t\t\t\t\t\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.map.mapData`, {\r\n\t\t\t\t\t\t\t\t\t\tname: \"Map Data\",\r\n\t\t\t\t\t\t\t\t\t\ttype: \"string\",\r\n\t\t\t\t\t\t\t\t\t\trole: \"json\",\r\n\t\t\t\t\t\t\t\t\t\tread: true,\r\n\t\t\t\t\t\t\t\t\t\twrite: false\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.map.mapData`, { val: JSON.stringify(mapData), ack: true });\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}).catch(err => {\r\n\t\t\t\t\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Error\", undefined, undefined, `Failed to process B01 map: ${err}`, \"error\");\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\treject: () => { }\r\n\t\t\t});\r\n\r\n\t\t\tthis.deps.adapter.setTimeout(() => {\r\n\t\t\t\tif (this.deps.adapter.pendingRequests.has(dummyId)) {\r\n\t\t\t\t\tthis.deps.adapter.pendingRequests.delete(dummyId);\r\n\t\t\t\t}\r\n\t\t\t}, 15000);\r\n\r\n\t\t} catch (e: any) {\r\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Failed to trigger B01 map update: ${e.message}`, \"warn\");\r\n\t\t}\r\n\t}\r\n\r\n\tpublic override async updateCleanSummary(): Promise<void> {\r\n\t\ttry {\r\n\t\t\tconst summaryRes = await this.deps.adapter.requestsHandler.sendRequest(this.duid, \"service.get_record_list\", {}, { priority: -10 });\r\n\t\t\tif (summaryRes) {\r\n\t\t\t\tawait this.processCleanSummary(summaryRes);\r\n\t\t\t}\r\n\t\t} catch (e: any) {\r\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", \"B01\", undefined, `Failed to update B01 clean summary: ${e.message}`, \"warn\");\r\n\t\t}\r\n\t}\r\n\r\n\t// Override getCleaningRecordMap to use B01 service call (upload_record_by_url)\r\n\tprotected override async getCleaningRecordMap(startTime: number, recordDetails?: any): Promise<{ mapBase64CleanUncropped: string; mapBase64: string; mapBase64Truncated: string; mapData: string } | null> {\r\n\t\ttry {\r\n\t\t\tlet url = recordDetails?.record_map_url || recordDetails?.url;\r\n\t\t\tif (!url && recordDetails?.detail) {\r\n\t\t\t\tconst detail = typeof recordDetails.detail === \"string\" ? JSON.parse(recordDetails.detail) : recordDetails.detail;\r\n\t\t\t\turl = detail.record_map_url || detail.url;\r\n\t\t\t}\r\n\r\n\t\t\tif (!url) {\r\n\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", \"B01\", undefined, `No URL found in record details for B01 history map (startTime: ${startTime})`, \"warn\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tconst dummyId = -Math.floor(Math.random() * 1000000);\r\n\r\n\t\t\tconst historyMapPromise = new Promise<{ mapBase64CleanUncropped: string; mapBase64: string; mapBase64Truncated: string; mapData: string } | null>((resolve) => {\r\n\t\t\t\tthis.deps.adapter.pendingRequests.set(dummyId, {\r\n\t\t\t\t\tmethod: \"get_clean_record_map\",\r\n\t\t\t\t\tduid: this.duid,\r\n\t\t\t\t\tresolve: async (data: Buffer) => {\r\n\t\t\t\t\t\tthis.deps.adapter.pendingRequests.delete(dummyId);\r\n\t\t\t\t\t\tif (Buffer.isBuffer(data)) {\r\n\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\tconst devices = this.deps.adapter.http_api.getDevices();\r\n\t\t\t\t\t\t\t\tconst device = devices.find((d: any) => d.duid === this.duid);\r\n\t\t\t\t\t\t\t\tconst serial = device?.sn || this.duid;\r\n\r\n\t\t\t\t\t\t\t\tconst mapRes = await this.deps.adapter.mapManager.processMap(data, \"B01\", this.robotModel, serial, null, this.duid, \"B01History\");\r\n\r\n\t\t\t\t\t\t\t\tif (mapRes) {\r\n\t\t\t\t\t\t\t\t\tresolve({\r\n\t\t\t\t\t\t\t\t\t\tmapBase64CleanUncropped: mapRes.mapBase64Clean || mapRes.mapBase64,\r\n\t\t\t\t\t\t\t\t\t\tmapBase64: mapRes.mapBase64,\r\n\t\t\t\t\t\t\t\t\t\tmapBase64Truncated: mapRes.mapBase64Clean || mapRes.mapBase64,\r\n\t\t\t\t\t\t\t\t\t\tmapData: JSON.stringify(mapRes.mapData),\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", \"B01\", undefined, \"B01 History Map processing returned null.\", \"warn\");\r\n\t\t\t\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} catch (e: any) {\r\n\t\t\t\t\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Error\", \"B01\", undefined, `Failed to process B01 history map: ${e.message}`, \"error\");\r\n\t\t\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\treject: () => {\r\n\t\t\t\t\t\tthis.deps.adapter.pendingRequests.delete(dummyId);\r\n\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.deps.adapter.setTimeout(() => {\r\n\t\t\t\t\tif (this.deps.adapter.pendingRequests.has(dummyId)) {\r\n\t\t\t\t\t\tthis.deps.adapter.pendingRequests.delete(dummyId);\r\n\t\t\t\t\t\tresolve(null);\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 30000);\r\n\t\t\t});\r\n\r\n\t\t\ttry {\r\n\t\t\t\tawait this.deps.adapter.requestsHandler.sendRequest(this.duid, \"service.upload_record_by_url\", { url }, { priority: -10 });\r\n\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Debug\", \"B01\", undefined, `Triggered B01 History Map update for URL: ${url}`, \"debug\");\r\n\t\t\t} catch (e: any) {\r\n\t\t\t\tthis.deps.adapter.pendingRequests.delete(dummyId);\r\n\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", \"B01\", undefined, `Failed to trigger B01 history map upload: ${e.message}`, \"warn\");\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\treturn historyMapPromise;\r\n\t\t} catch (e: any) {\r\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Failed to get cleaning record map (B01): ${e.message}`, \"warn\");\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\t// Override processCleanSummary to handle B01 specific structure and avoid redundant requests\r\n\tprotected override async processCleanSummary(result: any): Promise<void> {\r\n\t\ttry {\r\n\t\t\t// B01 result structure is { total_time, total_area, total_count, record_list: [ { url, detail: string }, ... ] }\r\n\t\t\tlet summaryData = result;\r\n\t\t\tif (result && result.data) {\r\n\t\t\t\tsummaryData = result.data;\r\n\t\t\t}\r\n\r\n\t\t\tif (!summaryData || !summaryData.record_list) {\r\n\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", \"B01\", undefined, \"Invalid B01 clean summary format\", \"warn\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Update Summary States\r\n\t\t\tawait this.updateSummaryState(\"clean_time\", summaryData.total_time);\r\n\t\t\tawait this.updateSummaryState(\"clean_area\", summaryData.total_area);\r\n\t\t\tawait this.updateSummaryState(\"clean_count\", summaryData.total_count);\r\n\r\n\t\t\tawait this.deps.ensureFolder(`Devices.${this.duid}.cleaningInfo.records`);\r\n\t\t\tconst recordList = summaryData.record_list;\r\n\t\t\tconst limit = 20;\r\n\r\n\t\t\trecordList.sort((a: any, b: any) => {\r\n\t\t\t\tconst timeA = this.extractStartTime(a);\r\n\t\t\t\tconst timeB = this.extractStartTime(b);\r\n\t\t\t\treturn timeB - timeA;\r\n\t\t\t});\r\n\r\n\r\n\t\t\tfor (let i = 0; i < Math.min(recordList.length, limit); i++) {\r\n\t\t\t\tconst recordItem = recordList[i];\r\n\t\t\t\tlet detail: any = null;\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdetail = typeof recordItem.detail === \"string\" ? JSON.parse(recordItem.detail) : recordItem.detail;\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Error\", \"B01\", undefined, `Failed to parse record detail: ${e}`, \"error\");\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!detail) continue;\r\n\r\n\t\t\t\tconst startTime = detail.record_start_time || detail.begin;\r\n\t\t\t\tconst index = i;\r\n\r\n\t\t\t\tawait this.deps.ensureFolder(`Devices.${this.duid}.cleaningInfo.records.${index}`);\r\n\r\n\t\t\t\tawait this.processRecordAttributes(index, detail);\r\n\r\n\t\t\t\tif (detail.record_map_url || detail.url || recordItem.url) {\r\n\t\t\t\t\tconst mapRes = await this.getCleaningRecordMap(startTime, recordItem);\r\n\t\t\t\t\tif (mapRes) {\r\n\t\t\t\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.cleaningInfo.records.${index}.mapBase64`, {\r\n\t\t\t\t\t\t\tname: \"History Map Base64\",\r\n\t\t\t\t\t\t\ttype: \"string\",\r\n\t\t\t\t\t\t\trole: \"text\",\r\n\t\t\t\t\t\t\tread: true,\r\n\t\t\t\t\t\t\twrite: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.cleaningInfo.records.${index}.mapBase64Truncated`, {\r\n\t\t\t\t\t\t\tname: \"History Map Base64 Truncated\",\r\n\t\t\t\t\t\t\ttype: \"string\",\r\n\t\t\t\t\t\t\trole: \"text\",\r\n\t\t\t\t\t\t\tread: true,\r\n\t\t\t\t\t\t\twrite: false\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.cleaningInfo.records.${index}.mapBase64`, { val: mapRes.mapBase64, ack: true });\r\n\t\t\t\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.cleaningInfo.records.${index}.mapBase64Truncated`, { val: mapRes.mapBase64Truncated, ack: true });\r\n\r\n\t\t\t\t\t\t// Add the map_object state (Combined JSON)\r\n\t\t\t\t\t\tconst combinedObject = {\r\n\t\t\t\t\t\t\t...detail,\r\n\t\t\t\t\t\t\tmapBase64: mapRes.mapBase64,\r\n\t\t\t\t\t\t\tmapBase64Truncated: mapRes.mapBase64Truncated\r\n\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.cleaningInfo.records.${index}.map_object`, {\r\n\t\t\t\t\t\t\tname: \"Combined History Record\",\r\n\t\t\t\t\t\t\ttype: \"string\",\r\n\t\t\t\t\t\t\trole: \"json\",\r\n\t\t\t\t\t\t\tread: true,\r\n\t\t\t\t\t\t\twrite: false\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tawait this.deps.adapter.setStateAsync(`Devices.${this.duid}.cleaningInfo.records.${index}.map_object`, {\r\n\t\t\t\t\t\t\tval: JSON.stringify(combinedObject),\r\n\t\t\t\t\t\t\tack: true\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tconst jsonSummary = {\r\n\t\t\t\tclean_time: Number((summaryData.total_time / 3600).toFixed(2)),\r\n\t\t\t\tclean_area: Number((summaryData.total_area / 1000000).toFixed(2)),\r\n\t\t\t\tclean_count: summaryData.total_count,\r\n\t\t\t\trecords: recordList.map((r: any) => {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\treturn typeof r.detail === \"string\" ? JSON.parse(r.detail) : r.detail;\r\n\t\t\t\t\t} catch { return null; }\r\n\t\t\t\t}).filter((r: any) => r !== null)\r\n\t\t\t};\r\n\r\n\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.cleaningInfo.JSON`, { val: JSON.stringify(jsonSummary), ack: true });\r\n\r\n\r\n\t\t} catch (e: any) {\r\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Error\", \"B01\", undefined, `Error processing B01 clean summary: ${e.message}`, \"error\");\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async updateSummaryState(attr: string, value: number): Promise<void> {\r\n\t\tlet val = value;\r\n\t\tif (attr === \"clean_time\") {\r\n\t\t\tval = Number((val / 3600).toFixed(2));\r\n\t\t} else if (attr === \"clean_area\") {\r\n\t\t\tval = Number((val / 1000000).toFixed(2));\r\n\t\t}\r\n\r\n\t\tawait this.deps.ensureState(`Devices.${this.duid}.cleaningInfo.${attr}`, {\r\n\t\t\tname: attr,\r\n\t\t\ttype: \"number\",\r\n\t\t\trole: \"value\",\r\n\t\t\tread: true,\r\n\t\t\twrite: false\r\n\t\t});\r\n\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.cleaningInfo.${attr}`, { val, ack: true });\r\n\t}\r\n\r\n\r\n\tprivate extractStartTime(record: any): number {\r\n\t\ttry {\r\n\t\t\tconst detail = typeof record.detail === \"string\" ? JSON.parse(record.detail) : record.detail;\r\n\t\t\treturn detail.record_start_time || detail.begin || 0;\r\n\t\t} catch {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate async processRecordAttributes(index: number, detail: any): Promise<void> {\r\n\t\tfor (const key in detail) {\r\n\t\t\tconst val = detail[key];\r\n\t\t\tconst mappedKey = V1VacuumFeatures.MAPPED_CLEAN_SUMMARY[key] || key;\r\n\r\n\t\t\t// Simple type mapping\r\n\t\t\tconst type = typeof val;\r\n\t\t\tif (type !== \"string\" && type !== \"number\" && type !== \"boolean\") continue;\r\n\r\n\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.cleaningInfo.records.${index}.${mappedKey}`, {\r\n\t\t\t\tname: mappedKey,\r\n\t\t\t\ttype: type as any,\r\n\t\t\t\trole: \"value\",\r\n\t\t\t\tread: true,\r\n\t\t\t\twrite: false\r\n\t\t\t});\r\n\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.cleaningInfo.records.${index}.${mappedKey}`, { val, ack: true });\r\n\t\t}\r\n\t}\r\n\r\n\tpublic override async detectAndApplyRuntimeFeatures(statusData: Readonly<Record<string, any>>): Promise<boolean> {\r\n\t\t// B01 features are statically defined, parameter unused but required by signature\r\n\t\tvoid statusData;\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprotected override getDynamicFeatures(): Set<Feature> {\r\n\t\treturn new Set<Feature>(); // B01 does not use bitfield feature flags\r\n\t}\r\n\r\n\tpublic override async processDockType(dockType: number): Promise<void> {\r\n\t\t// B01 dock features are handled via static command definitions, parameter unused but required by signature\r\n\t\tvoid dockType;\r\n\t}\r\n\r\n\tpublic override getCommonDeviceStates(attribute: string | number): { states?: Record<any, any>; unit?: string; type?: ioBroker.CommonType | undefined } | undefined {\r\n\t\t// Map B01 properties to readable states\r\n\r\n\t\t// 1. Fan Power (wind) - User confirmed 101-104 but B01/Q7 sends 1-4\r\n\t\tif (attribute === \"wind\" || attribute === \"fan_power\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t1: \"Quiet\",\r\n\t\t\t\t\t2: \"Balanced\",\r\n\t\t\t\t\t3: \"Turbo\",\r\n\t\t\t\t\t4: \"Max\",\r\n\t\t\t\t\t101: \"Quiet\",\r\n\t\t\t\t\t102: \"Balanced\",\r\n\t\t\t\t\t103: \"Turbo\",\r\n\t\t\t\t\t104: \"Max\",\r\n\t\t\t\t\t105: \"Off\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 2. Water Level (water) - Standard 200-203 but B01/Q7 sends 1-3\r\n\t\tif (attribute === \"water\" || attribute === \"water_box_mode\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Off\",\r\n\t\t\t\t\t1: \"Low\",\r\n\t\t\t\t\t2: \"Medium\",\r\n\t\t\t\t\t3: \"High\",\r\n\t\t\t\t\t200: \"Off\",\r\n\t\t\t\t\t201: \"Low\",\r\n\t\t\t\t\t202: \"Medium\",\r\n\t\t\t\t\t203: \"High\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 3. Status - General Robot State\r\n\t\tif (attribute === \"status\" || attribute === \"state\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Unknown\",\r\n\t\t\t\t\t1: \"Initiating\",\r\n\t\t\t\t\t2: \"Sleeping\",\r\n\t\t\t\t\t3: \"Idle\",\r\n\t\t\t\t\t4: \"Remote Control\",\r\n\t\t\t\t\t5: \"Cleaning\",\r\n\t\t\t\t\t6: \"Returning Dock\",\r\n\t\t\t\t\t7: \"Manual Mode\",\r\n\t\t\t\t\t8: \"Charging\",\r\n\t\t\t\t\t9: \"Charging Error\",\r\n\t\t\t\t\t10: \"Paused\",\r\n\t\t\t\t\t11: \"Spot Cleaning\",\r\n\t\t\t\t\t12: \"In Error\",\r\n\t\t\t\t\t13: \"Shutting Down\",\r\n\t\t\t\t\t14: \"Updating\",\r\n\t\t\t\t\t15: \"Docking\",\r\n\t\t\t\t\t16: \"Go To\",\r\n\t\t\t\t\t17: \"Zone Clean\",\r\n\t\t\t\t\t18: \"Room Clean\",\r\n\t\t\t\t\t22: \"Emptying Dust Container\",\r\n\t\t\t\t\t23: \"Washing Mop\",\r\n\t\t\t\t\t26: \"Going to Wash Lov\",\r\n\t\t\t\t\t28: \"In Call\",\r\n\t\t\t\t\t29: \"Mapping\",\r\n\t\t\t\t\t100: \"Fully Charged\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 3.1 Cleaning Stats Units\r\n\t\tif (attribute === \"clean_time\" || attribute === \"cleaning_time\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tunit: \"min\"\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (attribute === \"clean_area\" || attribute === \"cleaning_area\" || attribute === \"last_clean_area\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tunit: \"m²\"\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (attribute === \"battery\" || attribute === \"quantity\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tunit: \"%\"\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (attribute === \"real_clean_time\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tunit: \"s\"\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (attribute === \"clean_finish\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\"\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (attribute === \"last_clean_t\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"string\"\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 4. Error Codes - Populate from q7_dataset if available, else generic\r\n\t\tif (attribute === \"error_code\" || attribute === \"fault\") {\r\n\t\t\t// We can generate a states object from the imported Q7Data if we want 'states' mapping in object\r\n\t\t\t// This might be large, but useful.\r\n\t\t\t// However, Q7Data is imported in v1VacuumFeatures only?\r\n\t\t\t// Let's rely on base implementation for dynamic lookup OR return a basic set.\r\n\t\t\t// Base implementation usually sets the text state 'error_text'.\r\n\t\t\t// But for the numeric 'error_code' state, we can add common ones.\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"No Error\",\r\n\t\t\t\t\t1: \"LiDAR Blocked\",\r\n\t\t\t\t\t2: \"Bumper Stuck\",\r\n\t\t\t\t\t3: \"Wheels Suspended\",\r\n\t\t\t\t\t4: \"Cliff Sensor Error\",\r\n\t\t\t\t\t5: \"Main Brush Jammed\",\r\n\t\t\t\t\t6: \"Side Brush Jammed\",\r\n\t\t\t\t\t7: \"Wheels Jammed\",\r\n\t\t\t\t\t8: \"Robot Trapped\",\r\n\t\t\t\t\t9: \"No Dustbin\",\r\n\t\t\t\t\t10: \"Filter Wet/Blocked\",\r\n\t\t\t\t\t11: \"Magnetic Field Detected\",\r\n\t\t\t\t\t12: \"Low Battery\",\r\n\t\t\t\t\t13: \"Charging Error\",\r\n\t\t\t\t\t14: \"Battery Error\",\r\n\t\t\t\t\t15: \"Wall Sensor Dirty\",\r\n\t\t\t\t\t16: \"Robot Tilted\",\r\n\t\t\t\t\t17: \"Side Brush Error\",\r\n\t\t\t\t\t18: \"Fan Error\",\r\n\t\t\t\t\t100: \"Sensor Dirty\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 5. Dock Status\r\n\t\tif (attribute === \"dock_status\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Undocked\",\r\n\t\t\t\t\t1: \"Docking\",\r\n\t\t\t\t\t2: \"Docked\",\r\n\t\t\t\t\t3: \"Leaving Dock\",\r\n\t\t\t\t\t255: \"Unknown\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 6. Dust Collection Status\r\n\t\tif (attribute === \"dust_collection_status\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Idle\",\r\n\t\t\t\t\t1: \"Collecting\",\r\n\t\t\t\t\t2: \"Collection Weaker\",\r\n\t\t\t\t\t3: \"Collection Failed\",\r\n\t\t\t\t\t4: \"Dustbin Full\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 7. Map Status\r\n\t\tif (attribute === \"map_status\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Unmapped\",\r\n\t\t\t\t\t1: \"Mapped\",\r\n\t\t\t\t\t2: \"Mapping\",\r\n\t\t\t\t\t3: \"Loading\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 8. Charge Status\r\n\t\tif (attribute === \"charge_status\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Not Charging\",\r\n\t\t\t\t\t1: \"Charging\",\r\n\t\t\t\t\t2: \"Fully Charged\",\r\n\t\t\t\t\t3: \"Charge Failed\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 9. Work Mode\r\n\t\tif (attribute === \"work_mode\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Standard\",\r\n\t\t\t\t\t1: \"Custom\",\r\n\t\t\t\t\t2: \"Silent\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 10. Tank State (Water Box)\r\n\t\tif (attribute === \"tank_state\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Installed\",\r\n\t\t\t\t\t1: \"Removed\",\r\n\t\t\t\t\t2: \"Empty\",\r\n\t\t\t\t\t3: \"Unknown\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 11. Sweep Type (Mop Route)\r\n\t\tif (attribute === \"sweep_type\" || attribute === \"mop_mode\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Standard\",\r\n\t\t\t\t\t1: \"Deep\",\r\n\t\t\t\t\t2: \"Deep+\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 12. Cloth State (Mop Pad)\r\n\t\tif (attribute === \"cloth_state\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Installed\",\r\n\t\t\t\t\t1: \"Removed\",\r\n\t\t\t\t\t2: \"Dirty\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 13. Multi Floor\r\n\t\tif (attribute === \"multi_floor\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Disabled\",\r\n\t\t\t\t\t1: \"Enabled\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 14. Quiet Is Open (DND Mode)\r\n\t\tif (attribute === \"quiet_is_open\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Off\",\r\n\t\t\t\t\t1: \"On\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 15. Dust Collection Frequency\r\n\t\tif (attribute === \"dust_frequency\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Smart\",\r\n\t\t\t\t\t1: \"Low\",\r\n\t\t\t\t\t2: \"Medium\",\r\n\t\t\t\t\t3: \"High\",\r\n\t\t\t\t\t4: \"Never\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 16. Clean Path Preference\r\n\t\tif (attribute === \"clean_path_preference\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Standard\",\r\n\t\t\t\t\t1: \"Fast\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 17. Repeat State\r\n\t\tif (attribute === \"repeat_state\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Off\",\r\n\t\t\t\t\t1: \"On\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 18. Dust Action\r\n\t\tif (attribute === \"dust_action\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Idle\",\r\n\t\t\t\t\t1: \"Emptying\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 19. Build Map\r\n\t\tif (attribute === \"build_map\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Off\",\r\n\t\t\t\t\t1: \"On\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 20. Map Num\r\n\t\tif (attribute === \"map_num\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tunit: \"maps\"\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 21. Mode\r\n\t\tif (attribute === \"mode\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Vacuum\",\r\n\t\t\t\t\t1: \"Mop\",\r\n\t\t\t\t\t2: \"Vacuum & Mop\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 22. Custom Type\r\n\t\tif (attribute === \"custom_type\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Off\",\r\n\t\t\t\t\t1: \"On\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 8. Charge State (Fixed key from charge_status)\r\n\t\tif (attribute === \"charge_state\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Charging\",\r\n\t\t\t\t\t1: \"Not Charging\",\r\n\t\t\t\t\t2: \"Fully Charged\",\r\n\t\t\t\t\t3: \"Charge Failed\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 23. Add Sweep Status\r\n\t\tif (attribute === \"add_sweep_status\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t\"-1\": \"Unknown\",\r\n\t\t\t\t\t0: \"Off\",\r\n\t\t\t\t\t1: \"On\"\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t// 24. Language\r\n\t\tif (attribute === \"language\") {\r\n\t\t\treturn {\r\n\t\t\t\ttype: \"number\",\r\n\t\t\t\tstates: {\r\n\t\t\t\t\t0: \"Chinese\",\r\n\t\t\t\t\t1: \"English\",\r\n\t\t\t\t\t2: \"Other\",\r\n\t\t\t\t\t4: \"German\", // Guessed based on 4 in DE context\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\tpublic override async updateNetworkInfo(): Promise<void> {\r\n\t\ttry {\r\n\t\t\t// B01: Request via service.get_net_info? Or just rely on prop.get(\"net_status\")?\r\n\t\t\t// prop.get \"net_status\" usually just gives connected state.\r\n\t\t\t// Let's try service.get_network_info first as it's common.\r\n\t\t\tconst res = await this.deps.adapter.requestsHandler.sendRequest(this.duid, \"service.get_net_info\", {});\r\n\t\t\tif (res) {\r\n\t\t\t\t// Typically returns { ssid, ip, mac, rssi... }\r\n\t\t\t\tconst info = Array.isArray(res) ? res[0] : res;\r\n\r\n\t\t\t\tif (info) {\r\n\t\t\t\t\tawait this.deps.ensureFolder(`Devices.${this.duid}.networkInfo`);\r\n\t\t\t\t\tfor (const key in info) {\r\n\t\t\t\t\t\tawait this.deps.ensureState(`Devices.${this.duid}.networkInfo.${key}`, {\r\n\t\t\t\t\t\t\tname: key,\r\n\t\t\t\t\t\t\ttype: typeof info[key] as ioBroker.CommonType,\r\n\t\t\t\t\t\t\tread: true,\r\n\t\t\t\t\t\t\twrite: false\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tawait this.deps.adapter.setStateChangedAsync(`Devices.${this.duid}.networkInfo.${key}`, { val: info[key], ack: true });\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (e: any) {\r\n\t\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", \"B01\", undefined, `Failed to update network info: ${e.message}`, \"warn\");\r\n\t\t}\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\n\r\n"]}