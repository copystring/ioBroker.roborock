{"version":3,"file":"fallbackFeatures.js","sourceRoot":"","sources":["../../../src/lib/features/fallbackFeatures.ts"],"names":[],"mappings":";;;AAAA,wCAAwC;AACxC,6DAA+E;AAC/E,oEAAiE,CAAC,sBAAsB;AAGxF,2BAA2B;AAC3B,MAAa,oBAAqB,SAAQ,uCAAkB;IAC3D,YAAY,IAAyB,EAAE,IAAY,EAAE,UAAkB;QACtE,KAAK,CAAC,IAAI,EAAE,IAAI,EAAE,UAAU,EAAE,EAAE,cAAc,EAAE,EAAE,EAAE,CAAC,CAAC;IACvD,CAAC;IAED,6CAA6C;IAC7C,6CAA6C;IACnC,kBAAkB;QAC3B,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,2DAA2D,CAAC,CAAC;QAC7F,OAAO,IAAI,GAAG,EAAW,CAAC,CAAC,uCAAuC;IACnE,CAAC;IAEM,KAAK,CAAC,eAAe,CAAC,QAAgB;QAC5C,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,kDAAkD,QAAQ,qBAAqB,CAAC,CAAC;QACjH,uCAAuC;IACxC,CAAC;IAEM,KAAK,CAAC,6BAA6B;QACzC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,uEAAuE,CAAC,CAAC;QACzG,OAAO,KAAK,CAAC,CAAC,qCAAqC;IACpD,CAAC;IAEM,mBAAmB,CAAC,SAA0B;QACpD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,8CAA8C,SAAS,wBAAwB,CAAC,CAAC;QACjH,OAAO,SAAS,CAAC;IAClB,CAAC;IAEM,qBAAqB,CAAC,UAAkB;QAC9C,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,gDAAgD,UAAU,oBAAoB,CAAC,CAAC;QAChH,OAAO,KAAK,CAAC;IACd,CAAC;IAEM,qBAAqB,CAAC,SAA0B;QACtD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,gDAAgD,SAAS,wBAAwB,CAAC,CAAC;QACnH,OAAO,SAAS,CAAC;IAClB,CAAC;IAEM,qBAAqB,CAAC,SAA0B;QACtD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,gDAAgD,SAAS,wBAAwB,CAAC,CAAC;QACnH,OAAO,SAAS,CAAC;IAClB,CAAC;IAEM,wBAAwB,CAAC,SAA0B;QACzD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,mDAAmD,SAAS,wBAAwB,CAAC,CAAC;QACtH,OAAO,SAAS,CAAC;IAClB,CAAC;IAEM,sBAAsB,CAAC,SAA0B;QACvD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,iDAAiD,SAAS,sBAAsB,CAAC,CAAC;QAClH,OAAO,aAAa,SAAS,EAAE,CAAC,CAAC,4BAA4B;IAC9D,CAAC;CACD;AAnDD,oDAmDC;AAED,mCAAmC;AACnC,cAAc;AACd,oEAA6E;AAE7E,MAAM;AAEN,MAAa,sBAAuB,SAAQ,uCAAkB;IAC7D,YAAY,IAAyB,EAAE,IAAY,EAAE,UAAkB,EAAE,UAAyB,oCAAe;QAChH,KAAK,CAAC,IAAI,EAAE,IAAI,EAAE,UAAU,EAAE,EAAE,cAAc,EAAE,EAAE,EAAE,EAAE,OAAO,CAAC,CAAC;QAC/D,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,CAAC,IAAI,IAAI,CAAC,IAAI,4CAA4C,UAAU,sDAAsD,CAAC,CAAC;IAC/I,CAAC;CAOD;AAXD,wDAWC;AAED,uCAAuC;AACvC,mFAAmF;AACnF,iFAAiF;AACjF,iEAAiE;AACjE,8GAA8G;AAC9G,QAAQ;AACR,+EAA+E;AAC/E,IAAI","sourcesContent":["// src/lib/features/fallback_features.ts\nimport { BaseDeviceFeatures, FeatureDependencies } from \"./baseDeviceFeatures\";\nimport { BaseVacuumFeatures } from \"./vacuum/baseVacuumFeatures\"; // Import Vacuum-Basis\nimport { Feature } from \"./features.enum\";\n\n// --- Generic fallback ---\nexport class FallbackBaseFeatures extends BaseDeviceFeatures {\n\tconstructor(deps: FeatureDependencies, duid: string, robotModel: string) {\n\t\tsuper(deps, duid, robotModel, { staticFeatures: [] });\n\t}\n\n\t// --- Implementation of abstract methods ---\n\t// --- Implementation of abstract methods ---\n\tprotected getDynamicFeatures(): Set<Feature> {\n\t\tthis.deps.log.warn(`[${this.duid}] Using fallback getDynamicFeatures. Returning empty set.`);\n\t\treturn new Set<Feature>(); // Fallback returns no dynamic features\n\t}\n\n\tpublic async processDockType(dockType: number): Promise<void> {\n\t\tthis.deps.log.warn(`[${this.duid}] Using fallback processDockType for dock type ${dockType}. No actions taken.`);\n\t\t// Fallback does nothing with dock type\n\t}\n\n\tpublic async detectAndApplyRuntimeFeatures(): Promise<boolean> {\n\t\tthis.deps.log.warn(`[${this.duid}] Using fallback detectAndApplyRuntimeFeatures. No features detected.`);\n\t\treturn false; // Fallback does no runtime detection\n\t}\n\n\tpublic getCommonConsumable(attribute: string | number): { unit?: string } | undefined {\n\t\tthis.deps.log.warn(`[${this.duid}] Fallback: getCommonConsumable called for ${attribute}, returning undefined.`);\n\t\treturn undefined;\n\t}\n\n\tpublic isResetableConsumable(consumable: string): boolean {\n\t\tthis.deps.log.warn(`[${this.duid}] Fallback: isResetableConsumable called for ${consumable}, returning false.`);\n\t\treturn false;\n\t}\n\n\tpublic getCommonDeviceStates(attribute: string | number): { states?: Record<any, any>; unit?: string; type?: ioBroker.CommonType | undefined } | undefined {\n\t\tthis.deps.log.warn(`[${this.duid}] Fallback: getCommonDeviceStates called for ${attribute}, returning undefined.`);\n\t\treturn undefined;\n\t}\n\n\tpublic getCommonCleaningInfo(attribute: string | number): { unit?: string } | undefined {\n\t\tthis.deps.log.warn(`[${this.duid}] Fallback: getCommonCleaningInfo called for ${attribute}, returning undefined.`);\n\t\treturn undefined;\n\t}\n\n\tpublic getCommonCleaningRecords(attribute: string | number): { unit?: string } | undefined {\n\t\tthis.deps.log.warn(`[${this.duid}] Fallback: getCommonCleaningRecords called for ${attribute}, returning undefined.`);\n\t\treturn undefined;\n\t}\n\n\tpublic getFirmwareFeatureName(featureID: string | number): string {\n\t\tthis.deps.log.warn(`[${this.duid}] Fallback: getFirmwareFeatureName called for ${featureID}, returning default.`);\n\t\treturn `FeatureID_${featureID}`; // Default fallback response\n\t}\n}\n\n// --- Specific Vacuum Fallback ---\n// ... imports\nimport { VacuumProfile, DEFAULT_PROFILE } from \"./vacuum/baseVacuumFeatures\";\n\n// ...\n\nexport class FallbackVacuumFeatures extends BaseVacuumFeatures {\n\tconstructor(deps: FeatureDependencies, duid: string, robotModel: string, profile: VacuumProfile = DEFAULT_PROFILE) {\n\t\tsuper(deps, duid, robotModel, { staticFeatures: [] }, profile);\n\t\tthis.deps.log.warn(`[${this.duid}] Using FallbackVacuumFeatures for model ${robotModel}. Runtime detection and base vacuum features active.`);\n\t}\n\t// No overrides needed here. It inherits:\n\t// - registerFeatures (from BaseVacuumFeatures, registers all known vacuum feature implementations)\n\t// - _getDynamicFeatures (from BaseVacuumFeatures, tries to detect vacuum bitfields)\n\t// - detectAndApplyRuntimeFeatures (from BaseVacuumFeatures, tries runtime detection based on status)\n\t// - processDockType (from BaseVacuumFeatures)\n\t// - All the getter implementations (getCommonConsumable etc. from BaseVacuumFeatures)\n}\n\n// --- Example for future fallbacks ---\n// export class FallbackWashingMachineFeatures extends BaseWashingMachineFeatures {\n//     constructor(deps: FeatureDependencies, duid: string, robotModel: string) {\n//         super(deps, duid, robotModel, { staticFeatures: [] });\n//         this.deps.log.warn(`[${this.duid}] Using FallbackWashingMachineFeatures for model ${robotModel}.`);\n//     }\n//     // Implement specific fallback logic for washing machines here if needed\n// }\n"]}