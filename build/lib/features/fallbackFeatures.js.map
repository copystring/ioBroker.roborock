{"version":3,"file":"fallbackFeatures.js","sourceRoot":"","sources":["../../../src/lib/features/fallbackFeatures.ts"],"names":[],"mappings":"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","sourcesContent":["// src/lib/features/fallback_features.ts\nimport { BaseDeviceFeatures, FeatureDependencies } from \"./baseDeviceFeatures\";\nimport { V1VacuumFeatures } from \"./vacuum/v1VacuumFeatures\"; // Import Vacuum-Basis\nimport { Feature } from \"./features.enum\";\n\n// --- Generic fallback ---\nexport class FallbackBaseFeatures extends BaseDeviceFeatures {\n\tconstructor(deps: FeatureDependencies, duid: string, robotModel: string) {\n\t\tsuper(deps, duid, robotModel, { staticFeatures: [] });\n\t}\n\n\t// --- Implementation of abstract methods ---\n\t// --- Implementation of abstract methods ---\n\tprotected getDynamicFeatures(): Set<Feature> {\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, \"Using fallback getDynamicFeatures. Returning empty set.\", \"warn\");\n\t\treturn new Set<Feature>(); // Fallback returns no dynamic features\n\t}\n\n\tpublic async processDockType(dockType: number): Promise<void> {\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Using fallback processDockType for dock type ${dockType}. No actions taken.`, \"warn\");\n\t\t// Fallback does nothing with dock type\n\t}\n\n\tpublic async detectAndApplyRuntimeFeatures(): Promise<boolean> {\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, \"Using fallback detectAndApplyRuntimeFeatures. No features detected.\", \"warn\");\n\t\treturn false; // Fallback does no runtime detection\n\t}\n\n\tpublic getCommonConsumable(attribute: string | number): { unit?: string } | undefined {\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Fallback: getCommonConsumable called for ${attribute}, returning undefined.`, \"warn\");\n\t\treturn undefined;\n\t}\n\n\tpublic isResetableConsumable(consumable: string): boolean {\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Fallback: isResetableConsumable called for ${consumable}, returning false.`, \"warn\");\n\t\treturn false;\n\t}\n\n\tpublic getCommonDeviceStates(attribute: string | number): { states?: Record<any, any>; unit?: string; type?: ioBroker.CommonType | undefined } | undefined {\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Fallback: getCommonDeviceStates called for ${attribute}, returning undefined.`, \"warn\");\n\t\treturn undefined;\n\t}\n\n\tpublic getCommonCleaningInfo(attribute: string | number): { unit?: string } | undefined {\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Fallback: getCommonCleaningInfo called for ${attribute}, returning undefined.`, \"warn\");\n\t\treturn undefined;\n\t}\n\n\tpublic getCommonCleaningRecords(attribute: string | number): { unit?: string } | undefined {\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Fallback: getCommonCleaningRecords called for ${attribute}, returning undefined.`, \"warn\");\n\t\treturn undefined;\n\t}\n\n\tpublic getFirmwareFeatureName(featureID: string | number): string {\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Fallback: getFirmwareFeatureName called for ${featureID}, returning default.`, \"warn\");\n\t\treturn `FeatureID_${featureID}`; // Default fallback response\n\t}\n}\n\n// --- Specific Vacuum Fallback ---\n// ... imports\nimport { VacuumProfile, DEFAULT_PROFILE } from \"./vacuum/v1VacuumFeatures\";\n\n// ...\n\nexport class FallbackVacuumFeatures extends V1VacuumFeatures {\n\tconstructor(deps: FeatureDependencies, duid: string, robotModel: string, profile: VacuumProfile = DEFAULT_PROFILE) {\n\t\tsuper(deps, duid, robotModel, { staticFeatures: [] }, profile);\n\t\tthis.deps.adapter.rLog(\"System\", this.duid, \"Warn\", undefined, undefined, `Using FallbackVacuumFeatures for model ${robotModel}. Runtime detection and base vacuum features active.`, \"warn\");\n\t}\n\t// No overrides needed here. It inherits:\n\t// - registerFeatures (from V1VacuumFeatures, registers all known vacuum feature implementations)\n\t// - _getDynamicFeatures (from V1VacuumFeatures, tries to detect vacuum bitfields)\n\t// - detectAndApplyRuntimeFeatures (from V1VacuumFeatures, tries runtime detection based on status)\n\t// - processDockType (from V1VacuumFeatures)\n\t// - All the getter implementations (getCommonConsumable etc. from V1VacuumFeatures)\n}\n\n// --- Example for future fallbacks ---\n// export class FallbackWashingMachineFeatures extends BaseWashingMachineFeatures {\n//     constructor(deps: FeatureDependencies, duid: string, robotModel: string) {\n//         super(deps, duid, robotModel, { staticFeatures: [] });\n//         this.deps.log.warn(`[${this.duid}] Using FallbackWashingMachineFeatures for model ${robotModel}.`);\n//     }\n//     // Implement specific fallback logic for washing machines here if needed\n// }\n\r\n"]}