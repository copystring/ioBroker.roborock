{"version":3,"file":"MockRobot.js","sourceRoot":"","sources":["../../../src/lib/mock/MockRobot.ts"],"names":[],"mappings":";;;AACA,yCAA6C;AAE7C,MAAa,SAAS;IACd,IAAI,CAAS;IACb,KAAK,CAAS;IACd,KAAK,CAAsB;IAC3B,QAAQ,CAAW;IACnB,WAAW,CAAM;IACjB,YAAY,CAAM;IAClB,YAAY,CAAQ;IACpB,eAAe,CAAmB;IAClC,SAAS,CAAM;IACf,WAAW,CAAQ;IACnB,MAAM,CAAQ;IAErB,YAAY,OAAe,0BAAe,CAAC,IAAI,EAAE,QAAgB,0BAAe,CAAC,KAAK;QACrF,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,0BAAe,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,YAAY;QACjF,IAAI,CAAC,QAAQ,GAAG,CAAC,GAAG,0BAAe,CAAC,gBAAgB,CAAC,CAAC;QACtD,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,0BAAe,CAAC,WAAW,CAAC,CAAC,CAAC;QAC3E,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,0BAAe,CAAC,YAAY,CAAC,CAAC,CAAC;QAC7E,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,0BAAe,CAAC,YAAY,CAAC,CAAC,CAAC;QAC7E,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,0BAAe,CAAC,SAAS,CAAC,CAAC,CAAC;QACvE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,0BAAe,CAAC,WAAW,CAAC,CAAC,CAAC;QAC3E,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,0BAAe,CAAC,MAAM,CAAC,CAAC,CAAC;QAEjE,IAAI,CAAC,eAAe,GAAG,IAAI,GAAG,EAAE,CAAC;QACjC,KAAK,MAAM,MAAM,IAAI,IAAI,CAAC,YAAY,EAAE,CAAC;YACxC,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,MAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;QAChD,CAAC;IACF,CAAC;IAEM,aAAa,CAAC,MAAc,EAAE,SAAgB,EAAE;QACtD,QAAQ,MAAM,EAAE,CAAC;YAChB,KAAK,UAAU;gBACd,OAAO,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;YACnC,KAAK,YAAY;gBAChB,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACrB,KAAK,iBAAiB;gBACrB,OAAO,IAAI,CAAC,QAAQ,CAAC;YACtB,KAAK,gBAAgB;gBACpB,OAAO,CAAC,0BAAe,CAAC,WAAW,CAAC,CAAC;YACtC,KAAK,kBAAkB;gBACtB,OAAO,0BAAe,CAAC,WAAW,CAAC;YACpC,KAAK,mBAAmB;gBACvB,OAAO,IAAI,CAAC,YAAY,CAAC;YAC1B,KAAK,kBAAkB;gBACtB,OAAO,IAAI,CAAC,oBAAoB,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC;YAC7C,KAAK,qBAAqB;gBACzB,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;YACzB,KAAK,kBAAkB;gBACtB,OAAO,IAAI,CAAC,WAAW,CAAC;YACzB,KAAK,WAAW;gBACf,OAAO,IAAI,CAAC,MAAM,CAAC;YACpB,KAAK,WAAW;gBACf,IAAI,CAAC,WAAW,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,WAAW,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,eAAe;gBAC/D,OAAO,CAAC,IAAI,CAAC,CAAC;YACf,KAAK,UAAU,CAAC;YAChB,KAAK,WAAW;gBACf,IAAI,CAAC,WAAW,CAAC,EAAE,KAAK,EAAE,EAAE,EAAE,WAAW,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,cAAc;gBAC/D,OAAO,CAAC,IAAI,CAAC,CAAC;YACf,KAAK,YAAY;gBAChB,IAAI,CAAC,WAAW,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,YAAY,EAAE,CAAC,EAAE,WAAW,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,wBAAwB;gBACzF,OAAO,CAAC,IAAI,CAAC,CAAC;YACf,KAAK,iBAAiB;gBACrB,IAAI,CAAC,WAAW,CAAC,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;gBAC3C,OAAO,CAAC,IAAI,CAAC,CAAC;YACf,KAAK,kBAAkB;gBACvB,CAAC;oBACA,MAAM,UAAU,GAAG,MAAM,CAAC,CAAC,CAAW,CAAC;oBACvC,IAAI,UAAU,IAAI,IAAI,CAAC,WAAW,EAAE,CAAC;wBACpC,IAAI,CAAC,WAAW,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;oBAClC,CAAC;oBACD,OAAO,CAAC,IAAI,CAAC,CAAC;gBACf,CAAC;YACD;gBACC,iEAAiE;gBACjE,OAAO,CAAC,IAAI,CAAC,CAAC;QAChB,CAAC;IACF,CAAC;IAEO,aAAa,CAAC,IAAc;QACnC,IAAI,IAAI,CAAC,MAAM,KAAK,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,KAAK,YAAY,EAAE,CAAC;YACnD,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACrB,CAAC;QAED,MAAM,MAAM,GAAU,EAAE,CAAC;QACzB,KAAK,MAAM,GAAG,IAAI,IAAI,EAAE,CAAC;YACxB,IAAI,GAAG,IAAI,IAAI,CAAC,KAAK,EAAE,CAAC;gBACvB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC;YAC9B,CAAC;iBAAM,CAAC;gBACP,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACnB,CAAC;QACF,CAAC;QACD,OAAO,MAAM,CAAC;IACf,CAAC;IAEO,oBAAoB,CAAC,QAAgB;QAC5C,MAAM,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;QAClD,IAAI,MAAM,EAAE,CAAC;YACZ,OAAO,CAAC,MAAM,CAAC,CAAC;QACjB,CAAC;aAAM,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YACzC,yEAAyE;YACzE,OAAO,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;QAC/B,CAAC;QACD,OAAO,EAAE,CAAC;IACX,CAAC;IAEM,WAAW,CAAC,OAA4B;QAC9C,IAAI,CAAC,KAAK,GAAG,EAAE,GAAG,IAAI,CAAC,KAAK,EAAE,GAAG,OAAO,EAAE,CAAC;IAC5C,CAAC;IAEM,MAAM,CAAC,IAOV;QACH,MAAM,OAAO,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,IAAI,CAAC,CAAC;QACpC,IAAI,IAAI,GAAG,OAAO,CAAC;QACnB,IAAI,IAAI,CAAC,UAAU,KAAK,SAAS;YAAE,IAAI,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,IAAI,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,UAAU,IAAI,EAAE,CAAC,CAAC;QAC3F,IAAI,IAAI,CAAC,WAAW,KAAK,SAAS;YAAE,IAAI,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,IAAI,CAAC,CAAC,CAAC;QAC3F,IAAI,IAAI,CAAC,OAAO,KAAK,SAAS;YAAE,IAAI,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC,CAAC;QACnF,IAAI,IAAI,CAAC,SAAS,KAAK,SAAS;YAAE,IAAI,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,IAAI,CAAC,CAAC,CAAC;QACvF,IAAI,IAAI,CAAC,SAAS,KAAK,SAAS;YAAE,IAAI,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,SAAS,IAAI,CAAC,CAAC,CAAC;QACvF,IAAI,IAAI,CAAC,WAAW,KAAK,SAAS;YAAE,IAAI,GAAG,CAAC,IAAI,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAEjF,IAAI,CAAC,WAAW,CAAC,EAAE,GAAG,EAAE,IAAI,EAAE,CAAC,CAAC;IACjC,CAAC;CACD;AAlID,8BAkIC","sourcesContent":["\nimport { MOCK_ROBOT_DATA } from \"./mockData\";\n\nexport class MockRobot {\n\tpublic duid: string;\n\tpublic model: string;\n\tpublic state: Record<string, any>;\n\tpublic features: number[];\n\tpublic consumables: any;\n\tpublic cleanSummary: any;\n\tpublic cleanRecords: any[];\n\tpublic cleanRecordsMap: Map<number, any>;\n\tpublic multiMaps: any;\n\tpublic roomMapping: any[];\n\tpublic timers: any[];\n\n\tconstructor(duid: string = MOCK_ROBOT_DATA.duid, model: string = MOCK_ROBOT_DATA.model) {\n\t\tthis.duid = duid;\n\t\tthis.model = model;\n\t\tthis.state = JSON.parse(JSON.stringify(MOCK_ROBOT_DATA.properties)); // Deep copy\n\t\tthis.features = [...MOCK_ROBOT_DATA.firmwareFeatures];\n\t\tthis.consumables = JSON.parse(JSON.stringify(MOCK_ROBOT_DATA.consumables));\n\t\tthis.cleanSummary = JSON.parse(JSON.stringify(MOCK_ROBOT_DATA.cleanSummary));\n\t\tthis.cleanRecords = JSON.parse(JSON.stringify(MOCK_ROBOT_DATA.cleanRecords));\n\t\tthis.multiMaps = JSON.parse(JSON.stringify(MOCK_ROBOT_DATA.multiMaps));\n\t\tthis.roomMapping = JSON.parse(JSON.stringify(MOCK_ROBOT_DATA.roomMapping));\n\t\tthis.timers = JSON.parse(JSON.stringify(MOCK_ROBOT_DATA.timers));\n\n\t\tthis.cleanRecordsMap = new Map();\n\t\tfor (const record of this.cleanRecords) {\n\t\t\tthis.cleanRecordsMap.set(record.begin, record);\n\t\t}\n\t}\n\n\tpublic handleRequest(method: string, params: any[] = []): any {\n\t\tswitch (method) {\n\t\t\tcase \"get_prop\":\n\t\t\t\treturn this.handleGetProp(params);\n\t\t\tcase \"get_status\":\n\t\t\t\treturn [this.state];\n\t\t\tcase \"get_fw_features\":\n\t\t\t\treturn this.features;\n\t\t\tcase \"get_consumable\":\n\t\t\t\treturn [MOCK_ROBOT_DATA.consumables];\n\t\t\tcase \"get_network_info\":\n\t\t\t\treturn MOCK_ROBOT_DATA.networkInfo;\n\t\t\tcase \"get_clean_summary\":\n\t\t\t\treturn this.cleanSummary;\n\t\t\tcase \"get_clean_record\":\n\t\t\t\treturn this.handleGetCleanRecord(params[0]);\n\t\t\tcase \"get_multi_maps_list\":\n\t\t\t\treturn [this.multiMaps];\n\t\t\tcase \"get_room_mapping\":\n\t\t\t\treturn this.roomMapping;\n\t\t\tcase \"get_timer\":\n\t\t\t\treturn this.timers;\n\t\t\tcase \"app_start\":\n\t\t\t\tthis.updateState({ state: 5, in_cleaning: 1 }); // 5 = Cleaning\n\t\t\t\treturn [\"ok\"];\n\t\t\tcase \"app_stop\":\n\t\t\tcase \"app_pause\":\n\t\t\t\tthis.updateState({ state: 10, in_cleaning: 1 }); // 10 = Paused\n\t\t\t\treturn [\"ok\"];\n\t\t\tcase \"app_charge\":\n\t\t\t\tthis.updateState({ state: 6, in_returning: 1, in_cleaning: 0 }); // 6 = Returning to dock\n\t\t\t\treturn [\"ok\"];\n\t\t\tcase \"set_custom_mode\":\n\t\t\t\tthis.updateState({ fan_power: params[0] });\n\t\t\t\treturn [\"ok\"];\n\t\t\tcase \"reset_consumable\":\n\t\t\t{\n\t\t\t\tconst consumable = params[0] as string;\n\t\t\t\tif (consumable in this.consumables) {\n\t\t\t\t\tthis.consumables[consumable] = 0;\n\t\t\t\t}\n\t\t\t\treturn [\"ok\"];\n\t\t\t}\n\t\t\tdefault:\n\t\t\t\t// Return generic success for unknown commands to prevent crashes\n\t\t\t\treturn [\"ok\"];\n\t\t}\n\t}\n\n\tprivate handleGetProp(keys: string[]): any[] {\n\t\tif (keys.length === 1 && keys[0] === \"get_status\") {\n\t\t\treturn [this.state];\n\t\t}\n\n\t\tconst result: any[] = [];\n\t\tfor (const key of keys) {\n\t\t\tif (key in this.state) {\n\t\t\t\tresult.push(this.state[key]);\n\t\t\t} else {\n\t\t\t\tresult.push(null);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate handleGetCleanRecord(recordId: number): any[] {\n\t\tconst record = this.cleanRecordsMap.get(recordId);\n\t\tif (record) {\n\t\t\treturn [record];\n\t\t} else if (this.cleanRecords.length > 0) {\n\t\t\t// Return first available record if specific ID not found (mock behavior)\n\t\t\treturn [this.cleanRecords[0]];\n\t\t}\n\t\treturn [];\n\t}\n\n\tpublic updateState(updates: Record<string, any>): void {\n\t\tthis.state = { ...this.state, ...updates };\n\t}\n\n\tpublic setDss(bits: {\n        cleanFluid?: number,\n        waterFilter?: number,\n        dustBag?: number,\n        dirtyTank?: number,\n        cleanTank?: number,\n        updownWater?: number\n    }): void {\n\t\tconst current = this.state.dss || 0;\n\t\tlet next = current;\n\t\tif (bits.cleanFluid !== undefined) next = (next & ~(0b11 << 10)) | (bits.cleanFluid << 10);\n\t\tif (bits.waterFilter !== undefined) next = (next & ~(0b11 << 8)) | (bits.waterFilter << 8);\n\t\tif (bits.dustBag !== undefined) next = (next & ~(0b11 << 6)) | (bits.dustBag << 6);\n\t\tif (bits.dirtyTank !== undefined) next = (next & ~(0b11 << 4)) | (bits.dirtyTank << 4);\n\t\tif (bits.cleanTank !== undefined) next = (next & ~(0b11 << 2)) | (bits.cleanTank << 2);\n\t\tif (bits.updownWater !== undefined) next = (next & ~(0b11)) | (bits.updownWater);\n\n\t\tthis.updateState({ dss: next });\n\t}\n}\n"]}