{"version":3,"file":"mapDataParser.js","sourceRoot":"","sources":["../../src/lib/mapDataParser.ts"],"names":[],"mappings":"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","sourcesContent":["// src/lib/mapDataParser.ts\nimport type { Roborock } from \"../main\";\nimport * as crypto from \"crypto\";\n\n// --------------------\n// Constants\n// --------------------\nconst TYPES = {\n\tCHARGER_LOCATION: 1,\n\tIMAGE: 2,\n\tPATH: 3,\n\tGOTO_PATH: 4,\n\tGOTO_PREDICTED_PATH: 5,\n\tCURRENTLY_CLEANED_ZONES: 6,\n\tGOTO_TARGET: 7,\n\tROBOT_POSITION: 8,\n\tFORBIDDEN_ZONES: 9,\n\tVIRTUAL_WALLS: 10,\n\tCURRENTLY_CLEANED_BLOCKS: 11,\n\tNO_MOP_ZONE: 12,\n\tOBSTACLES: 13,\n\tIGNORED_OBSTACLES: 14,\n\tOBSTACLES2: 15,\n\tIGNORED_OBSTACLES2: 16,\n\tCARPET_MAP: 17,\n\tMOP_PATH: 18,\n\tCARPET_FORBIDDEN_ZONE: 19,\n\tSMART_ZONE_PATH_TYPE: 20,\n\tSMART_ZONE: 21,\n\tCUSTOM_CARPET: 22,\n\tCL_FORBIDDEN_ZONES: 23,\n\tFLOOR_MAP: 24,\n\tFURNITURES: 25,\n\tDOCK_TYPE: 26,\n\tENEMIES: 27,\n\tDS_FORBIDDEN_ZONES: 28,\n\tSTUCK_POINTS: 29,\n\tCLF_FORBIDDEN_ZONES: 30,\n\tSMART_DS: 31,\n\tFLOOR_DIRECTION: 32,\n\tDATE: 33,\n\tNONCEDATA: 34,\n\tEXT_ZONES: 36,\n\tPATROL: 37,\n\tPET_PATROL: 38,\n\tMODE_CARPET: 39,\n\tSTROY_PT: 41,\n\tDIRTY_RECT: 42,\n\tIGNORE_DIRTY_RECT: 43,\n\tBRUSH_PT: 44,\n\tDIRTY_NEW: 45,\n\tMOP_ERR_PT: 46,\n\tERAZER_ZONE: 47,\n\tLONG_CARPET: 48,\n\tDS_SIDES: 49,\n\tSTEERING_PT: 50,\n\tSENSOR_INFO: 51,\n\tLOW_SPACES: 52,\n\tTIDY_ZONES: 53,\n\tGARBAGE: 54,\n\tZONE_LINES: 55,\n\tDIGEST: 1024,\n\tUNKNOWN_40: 40,\n\tUNKNOWN_56: 56,\n};\nconst TYPES_REVERSE = Object.fromEntries(Object.entries(TYPES).map(([key, value]) => [value, key]));\nconst OFFSETS = {\n\tHLENGTH: 0x02,\n\tLENGTH: 0x04,\n\tTYPE_COUNT: 0x08,\n\tTARGET_X: 0x08,\n\tANGLE: 0x10,\n\tPATH: 0x14,\n\tTARGET_Y: 0x0a,\n\tBLOCKS: 0x0c,\n};\n\n// --------------------\n// Interfaces\n// --------------------\ninterface MapMetaData {\n\theader_length: number;\n\tdata_length: number;\n\tversion: { major: number; minor: number };\n\tmap_index: number;\n\tmap_sequence: number;\n\tSHA1: string;\n\texpectedSHA1: string;\n}\ninterface PositionBlock {\n\tposition: [number, number];\n\tangle: number;\n}\ninterface SegmentInfo {\n\tid: number; // The segment ID (e.g., 16)\n\tname: string; // The room name (e.g., \"Kitchen\")\n\tcenter: [number, number]; // The calculated center coordinates in MM\n}\ninterface ImageBlock {\n\tsegments: {\n\t\tcount: number;\n\t\tlist: SegmentInfo[];\n\t};\n\tposition: { top: number; left: number };\n\tdimensions: { height: number; width: number };\n\tpixels: { floor: number[]; obstacle: number[]; segments: number[] };\n}\ninterface PathBlock {\n\tcurrent_angle: number;\n\tpoints: [number, number][];\n}\ntype Obstacle = [number, number, number, number, number, number, string];\ninterface NonceData {\n\ttype: number;\n\tunixTime: number;\n}\nexport interface ParsedMapData {\n\tmetaData: MapMetaData;\n\tROBOT_POSITION?: PositionBlock;\n\tCHARGER_LOCATION?: PositionBlock;\n\tIMAGE?: ImageBlock;\n\tPATH?: PathBlock;\n\tGOTO_PATH?: PathBlock;\n\tGOTO_PREDICTED_PATH?: PathBlock;\n\tCURRENTLY_CLEANED_ZONES?: number[][];\n\tGOTO_TARGET?: [number, number];\n\tVIRTUAL_WALLS?: number[][];\n\tCURRENTLY_CLEANED_BLOCKS?: number[];\n\tFORBIDDEN_ZONES?: number[][];\n\tNO_MOP_ZONE?: number[][];\n\tOBSTACLES2?: Obstacle[];\n\tCARPET_MAP?: number[];\n\tMOP_PATH?: number[];\n\tCARPET_FORBIDDEN_ZONE?: number[][];\n\tDS_FORBIDDEN_ZONES?: number[][];\n\tCLF_FORBIDDEN_ZONES?: number[][];\n\tMODE_CARPET?: number[][];\n\tNONCEDATA?: NonceData[];\n\tSTROY_PT?: any[];\n\tDIRTY_RECT?: any[];\n\tIGNORE_DIRTY_RECT?: any[];\n\tBRUSH_PT?: any[];\n\tDIRTY_NEW?: any[];\n\tMOP_ERR_PT?: any[];\n\tERAZER_ZONE?: any[];\n\tLONG_CARPET?: any[];\n\tDS_SIDES?: any[];\n\tSTEERING_PT?: any[];\n\tSENSOR_INFO?: any[];\n\tLOW_SPACES?: any[];\n\tTIDY_ZONES?: any[];\n\tGARBAGE?: any[];\n\tZONE_LINES?: any[];\n\tOBSTACLES?: any[];\n\tIGNORED_OBSTACLES?: any[];\n\tIGNORED_OBSTACLES2?: any[];\n\tSMART_ZONE_PATH_TYPE?: number;\n\tSMART_ZONE?: any[];\n\tCUSTOM_CARPET?: any[];\n\tFLOOR_MAP?: number[];\n\tFURNITURES?: any[];\n\tDOCK_TYPE?: number;\n\tENEMIES?: any[];\n\tSTUCK_POINTS?: any[];\n\tSMART_DS?: any[];\n\tFLOOR_DIRECTION?: any[];\n\tDATE?: number;\n\tEXT_ZONES?: any[];\n\tPATROL?: any[];\n\tPET_PATROL?: any[];\n}\n\nexport class MapDataParser {\n\tadapter: Roborock;\n\n\tconstructor(adapter: Roborock) {\n\t\tthis.adapter = adapter;\n\t}\n\n\t/**\n\t * Parses the complete raw map buffer from the robot.\n\t */\n\tasync parsedata(buf: Buffer, mappedRooms: any[] | null, options: { isHistoryMap: boolean } = { isHistoryMap: false }): Promise<ParsedMapData | {}> {\n\t\tif (buf.length < 8) {\n\t\t\tthis.adapter.log.warn(`[MapDataParser] Received map buffer is too small (< 8 bytes). Length: ${buf.length}`);\n\t\t\treturn {};\n\t\t}\n\n\t\tlet metaData: MapMetaData;\n\t\tlet dataPosition = 0;\n\t\tlet dataLength = buf.length;\n\n\t\tif (buf.length >= 20 && buf[0x00] === 0x72 && buf[0x01] === 0x72) {\n\t\t\tthis.adapter.log.debug(\"[MapDataParser] Found 'rr' header. Parsing as Standard Map.\");\n\t\t\tmetaData = this.parseHeader(buf);\n\n\t\t\tif (!metaData.header_length) {\n\t\t\t\tthis.adapter.log.error(`[MapDataParser] Failed to parse LIVE map header (Invalid structure).`);\n\t\t\t\treturn {};\n\t\t\t}\n\t\t\tif (metaData.SHA1 !== metaData.expectedSHA1) {\n\t\t\t\tthis.adapter.log.error(`[MapDataParser] Invalid map hash!`);\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\tdataPosition = 0x14; // Skip 20-byte header\n\t\t\tdataLength = metaData.data_length;\n\t\t} else if (options.isHistoryMap) {\n\t\t\tthis.adapter.log.debug(\"[MapDataParser] Parsing as History Map (No 'rr' Header).\");\n\t\t\tmetaData = { map_index: -1 } as any;\n\t\t\tdataPosition = 0;\n\t\t\tdataLength = buf.length;\n\t\t} else {\n\t\t\tthis.adapter.log.warn(\"[MapDataParser] Invalid map header signature (expected 'rr').\");\n\t\t\treturn {};\n\t\t}\n\n\t\tconst result: any = { metaData };\n\n\t\tconst roomIDsAll = this.adapter.http_api.getMatchedRoomIDs(false);\n\n\t\t// Loop through all blocks\n\t\twhile (dataPosition < dataLength) {\n\t\t\tif (dataPosition + OFFSETS.LENGTH + 4 > buf.length) {\n\t\t\t\tthis.adapter.log.warn(`[MapDataParser] Reached end of buffer prematurely while reading block header.`);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst type = buf.readUInt16LE(dataPosition);\n\t\t\tconst hlength = buf.readUInt16LE(dataPosition + OFFSETS.HLENGTH);\n\t\t\tconst length = buf.readUInt32LE(dataPosition + OFFSETS.LENGTH);\n\n\t\t\tif (dataPosition + hlength + length > buf.length) {\n\t\t\t\tthis.adapter.log.warn(`[MapDataParser] Block (Type ${type}) claims to be larger than buffer. Stopping parse.`);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst blockBuffer = buf.slice(dataPosition, dataPosition + hlength + length);\n\t\t\tconst [offset1, offset2] = this.getTwoByteOffsets(blockBuffer);\n\n\t\t\tconst typeName = TYPES_REVERSE[type];\n\t\t\tif (typeName) {\n\t\t\t\ttry {\n\t\t\t\t\tswitch (type) {\n\t\t\t\t\t\tcase TYPES.ROBOT_POSITION:\n\t\t\t\t\t\tcase TYPES.CHARGER_LOCATION: {\n\t\t\t\t\t\t\tconst position = this.getXYPositions(blockBuffer, offset1, offset2);\n\t\t\t\t\t\t\tconst angle = length >= 12 ? this.getAngle(blockBuffer) : 0;\n\t\t\t\t\t\t\tresult[typeName] = { position, angle };\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TYPES.IMAGE: {\n\t\t\t\t\t\t\tresult[typeName] = this.parseImageBlock(blockBuffer, buf, dataPosition, length, hlength, mappedRooms, roomIDsAll);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TYPES.CARPET_MAP: {\n\t\t\t\t\t\t\tconst carpets: number[] = [];\n\t\t\t\t\t\t\tconst dataStart = dataPosition + offset1;\n\t\t\t\t\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\t\t\t\t\tif (this.getPixelType(buf, dataStart + i) === 1) {\n\t\t\t\t\t\t\t\t\tcarpets.push(i);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresult[typeName] = carpets;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TYPES.MOP_PATH: {\n\t\t\t\t\t\t\tconst mopPath: number[] = [];\n\t\t\t\t\t\t\tconst dataStart = dataPosition + hlength;\n\t\t\t\t\t\t\tfor (let i = 0; i < length; i++) {\n\t\t\t\t\t\t\t\tmopPath.push(...this.readUInt8(buf, dataStart + i, 0, 1));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresult[typeName] = mopPath;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TYPES.PATH:\n\t\t\t\t\t\tcase TYPES.GOTO_PATH:\n\t\t\t\t\t\tcase TYPES.GOTO_PREDICTED_PATH: {\n\t\t\t\t\t\t\tresult[typeName] = this.parsePathBlock(blockBuffer, buf, dataPosition, length);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TYPES.GOTO_TARGET:\n\t\t\t\t\t\t\tresult[typeName] = this.getGoToTarget(blockBuffer);\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase TYPES.CURRENTLY_CLEANED_ZONES:\n\t\t\t\t\t\tcase TYPES.VIRTUAL_WALLS: {\n\t\t\t\t\t\t\tconst count = this.getCount(blockBuffer);\n\t\t\t\t\t\t\tconst zones: number[][] = [];\n\t\t\t\t\t\t\tconst dataStart = dataPosition + hlength;\n\t\t\t\t\t\t\tfor (let i = 0; i < count; i++) {\n\t\t\t\t\t\t\t\tzones.push(this.readUInt16LE(buf, dataStart + i * 8, 0, 4));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresult[typeName] = zones;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TYPES.FORBIDDEN_ZONES:\n\t\t\t\t\t\tcase TYPES.NO_MOP_ZONE:\n\t\t\t\t\t\tcase TYPES.CARPET_FORBIDDEN_ZONE:\n\t\t\t\t\t\tcase TYPES.DS_FORBIDDEN_ZONES:\n\t\t\t\t\t\tcase TYPES.CLF_FORBIDDEN_ZONES:\n\t\t\t\t\t\tcase TYPES.MODE_CARPET: {\n\t\t\t\t\t\t\tconst count = this.getCount(blockBuffer);\n\t\t\t\t\t\t\tconst zones: number[][] = [];\n\t\t\t\t\t\t\tconst dataStart = dataPosition + hlength;\n\t\t\t\t\t\t\tfor (let i = 0; i < count; i++) {\n\t\t\t\t\t\t\t\tzones.push(this.getForbiddenZone(buf, dataStart + i * 16, 0));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresult[typeName] = zones;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TYPES.OBSTACLES2:\n\t\t\t\t\t\t\tresult[typeName] = this.extractObstacles(blockBuffer, hlength);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.CURRENTLY_CLEANED_BLOCKS: {\n\t\t\t\t\t\t\tconst count = this.getCount(blockBuffer);\n\t\t\t\t\t\t\tconst blocks: number[] = [];\n\t\t\t\t\t\t\tfor (let i = 0; i < count; i++) {\n\t\t\t\t\t\t\t\tblocks.push(buf.readUInt8(dataPosition + OFFSETS.BLOCKS + i));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresult[typeName] = blocks;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcase TYPES.NONCEDATA:\n\t\t\t\t\t\t\tresult[typeName] = this.getNonceData(blockBuffer);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.STROY_PT:\n\t\t\t\t\t\t\tresult[typeName] = this.getStroyPt(blockBuffer, hlength);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.DIRTY_RECT:\n\t\t\t\t\t\tcase TYPES.IGNORE_DIRTY_RECT:\n\t\t\t\t\t\t\tresult[typeName] = this.getDirtyRect(blockBuffer, hlength);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.BRUSH_PT:\n\t\t\t\t\t\t\tresult[typeName] = this.getBrushPt(blockBuffer, hlength);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.DIRTY_NEW:\n\t\t\t\t\t\t\tresult[typeName] = this.getDirtyNew(blockBuffer, hlength, length);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.MOP_ERR_PT:\n\t\t\t\t\t\t\tresult[typeName] = this.getMopErrPt(blockBuffer, hlength);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.ERAZER_ZONE:\n\t\t\t\t\t\tcase TYPES.LOW_SPACES:\n\t\t\t\t\t\t\tresult[typeName] = this.getEraserZone(blockBuffer, hlength, length);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.LONG_CARPET:\n\t\t\t\t\t\t\tresult[typeName] = this.getLongCarpet(blockBuffer, hlength, length);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.DS_SIDES:\n\t\t\t\t\t\t\tresult[typeName] = this.getDsSides(blockBuffer, hlength, length);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.STEERING_PT:\n\t\t\t\t\t\t\tresult[typeName] = this.getSteeringPt(blockBuffer, hlength, length);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.SENSOR_INFO:\n\t\t\t\t\t\t\tresult[typeName] = this.getSensorInfo(blockBuffer, hlength, length);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.TIDY_ZONES:\n\t\t\t\t\t\t\tresult[typeName] = this.getTidyZones(blockBuffer, hlength, length);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.GARBAGE:\n\t\t\t\t\t\t\tresult[typeName] = this.getGarbage(blockBuffer, hlength, length);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.ZONE_LINES:\n\t\t\t\t\t\t\tresult[typeName] = this.getZoneLines(blockBuffer, hlength);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.OBSTACLES:\n\t\t\t\t\t\tcase TYPES.IGNORED_OBSTACLES:\n\t\t\t\t\t\t\tresult[typeName] = this.getObstaclesOld(blockBuffer, hlength);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.IGNORED_OBSTACLES2:\n\t\t\t\t\t\t\tresult[typeName] = this.getIgnoredObstacles2(blockBuffer, hlength);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.SMART_ZONE_PATH_TYPE:\n\t\t\t\t\t\t\tresult[typeName] = buf.readUInt8(dataPosition + offset1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.SMART_ZONE:\n\t\t\t\t\t\t\tresult[typeName] = this.getSmartZone(blockBuffer, hlength);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.CUSTOM_CARPET:\n\t\t\t\t\t\tcase TYPES.CL_FORBIDDEN_ZONES:\n\t\t\t\t\t\tcase TYPES.SMART_DS:\n\t\t\t\t\t\tcase TYPES.EXT_ZONES:\n\t\t\t\t\t\t\tresult[typeName] = this.getForbiddenZone(buf, dataPosition + hlength, 0); // Re-use getForbiddenZone as structure is same (16 bytes)\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.FLOOR_MAP:\n\t\t\t\t\t\t\tresult[typeName] = this.readUInt8(buf, dataPosition, hlength, length);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.FURNITURES:\n\t\t\t\t\t\t\tresult[typeName] = this.getFurnitures(blockBuffer, hlength);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.DOCK_TYPE:\n\t\t\t\t\t\t\tresult[typeName] = buf.readUInt8(dataPosition + offset1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.ENEMIES:\n\t\t\t\t\t\tcase TYPES.STUCK_POINTS:\n\t\t\t\t\t\t\tresult[typeName] = this.getEnemies(blockBuffer, hlength);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.FLOOR_DIRECTION:\n\t\t\t\t\t\t\tresult[typeName] = this.getFloorDirection(blockBuffer, hlength, length);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.DATE:\n\t\t\t\t\t\t\tresult[typeName] = buf.readUInt32LE(dataPosition + offset1);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.PATROL:\n\t\t\t\t\t\tcase TYPES.PET_PATROL:\n\t\t\t\t\t\t\tresult[typeName] = this.getPatrol(blockBuffer, hlength);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase TYPES.UNKNOWN_40:\n\t\t\t\t\t\tcase TYPES.UNKNOWN_56:\n\t\t\t\t\t\t\tthis.adapter.log.debug(`[MapDataParser] Received known unknown block type ${type} with length ${length}. Data: ${blockBuffer.toString(\"hex\")}`);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} catch (e: any) {\n\t\t\t\t\tthis.adapter.log.error(`[MapDataParser] Error parsing block ${typeName} (Type ${type}): ${e.stack}`);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.adapter.log.warn(`[MapDataParser] Unknown block type: ${type} with length ${length}. Data: ${blockBuffer.toString(\"hex\")}`);\n\t\t\t}\n\t\t\tdataPosition += length + hlength;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate parseHeader(mapBuf: Buffer): MapMetaData {\n\t\treturn {\n\t\t\theader_length: mapBuf.readUInt16LE(OFFSETS.HLENGTH),\n\t\t\tdata_length: mapBuf.readUInt32LE(OFFSETS.LENGTH),\n\t\t\tversion: {\n\t\t\t\tmajor: mapBuf.readUInt16LE(0x08),\n\t\t\t\tminor: mapBuf.readUInt16LE(0x0a),\n\t\t\t},\n\t\t\tmap_index: mapBuf.readUInt32LE(0x0c),\n\t\t\tmap_sequence: mapBuf.readUInt32LE(0x10),\n\t\t\tSHA1: crypto\n\t\t\t\t.createHash(\"sha1\")\n\t\t\t\t.update(mapBuf.subarray(0, mapBuf.length - 20))\n\t\t\t\t.digest(\"hex\"),\n\t\t\texpectedSHA1: mapBuf.subarray(mapBuf.length - 20).toString(\"hex\"),\n\t\t};\n\t}\n\n\tprivate parseImageBlock(\n\t\tblockBuffer: Buffer,\n\t\tbuf: Buffer,\n\t\tdataPosition: number,\n\t\tlength: number,\n\t\thlength: number,\n\t\tmappedRooms: any[] | null,\n\t\troomIDsAll: { id: number; name: string }[]\n\t): ImageBlock {\n\t\t// MM per pixel (5cm)\n\t\tconst MM_PER_PIXEL = 50;\n\n\t\t// Get unscaled pixel dimensions and offsets\n\t\tconst offset = this.getSingleByteOffset(blockBuffer);\n\t\tconst { left, top, width: width_px, height: height_px } = this.getMapSizes(blockBuffer, offset);\n\n\t\tconst parameters: ImageBlock = {\n\t\t\tsegments: {\n\t\t\t\tcount: hlength > 24 ? this.getCount(blockBuffer) : 0,\n\t\t\t\tlist: [],\n\t\t\t},\n\t\t\tposition: { top, left },\n\t\t\tdimensions: { height: height_px, width: width_px },\n\t\t\tpixels: { floor: [], obstacle: [], segments: [] },\n\t\t};\n\n\t\tif (height_px <= 0 || width_px <= 0) return parameters;\n\n\t\t// Create Bounding Boxes for segments\n\t\tconst segBB: Record<number, { minX: number; maxX: number; minY: number; maxY: number; count: number }> = {};\n\t\tconst segmentIDsInImage: Set<number> = new Set();\n\n\t\tconst dataStart = dataPosition + offset;\n\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tconst pixelBytePosition = dataStart + i;\n\t\t\tconst pixelType = this.getPixelType(buf, pixelBytePosition);\n\n\t\t\tif (pixelType === 1) {\n\t\t\t\t// Obstacle\n\t\t\t\tparameters.pixels.obstacle.push(i);\n\t\t\t} else if (pixelType !== 0) {\n\t\t\t\t// Floor\n\t\t\t\tparameters.pixels.floor.push(i);\n\n\t\t\t\tconst segmentID = (buf.readUInt8(pixelBytePosition) & 248) >> 3;\n\t\t\t\tsegmentIDsInImage.add(segmentID);\n\n\t\t\t\tparameters.pixels.segments.push(i | (segmentID << 21));\n\n\t\t\t\t// Calculate UN-SCALED pixel coordinates relative to the data block (0, 0)\n\t\t\t\tconst x = i % width_px;\n\t\t\t\tconst y = Math.floor(i / width_px);\n\n\t\t\t\tconst bb = segBB[segmentID];\n\t\t\t\tif (!bb) {\n\t\t\t\t\tsegBB[segmentID] = { minX: x, maxX: x, minY: y, maxY: y, count: 1 };\n\t\t\t\t} else {\n\t\t\t\t\tif (x < bb.minX) bb.minX = x;\n\t\t\t\t\tif (x > bb.maxX) bb.maxX = x;\n\t\t\t\t\tif (y < bb.minY) bb.minY = y;\n\t\t\t\t\tif (y > bb.maxY) bb.maxY = y;\n\t\t\t\t\tbb.count++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// --- Process all found segments ---\n\t\tfor (const segId of segmentIDsInImage) {\n\t\t\tif (segId === 0) continue; // Skip \"no segment\"\n\n\t\t\tconst bb = segBB[segId];\n\t\t\tif (!bb) continue;\n\n\t\t\tconst centerX_px = Math.round((bb.minX + bb.maxX) / 2);\n\t\t\tconst centerY_px = Math.round((bb.minY + bb.maxY) / 2);\n\n\t\t\t// This logic MUST match the working localCoordsToRobotCoords formula\n\t\t\t// x_robot = (center_x_px + offset_x_px) * MM_PER_PIXEL\n\t\t\t// y_robot = ((height_px / scale) + top_px - center_y_px) * MM_PER_PIXEL\n\n\t\t\tconst centerX_robot = Math.round((centerX_px + left) * MM_PER_PIXEL);\n\n\t\t\t// NOTE: The map creator scales dimensions.height by map_scale, which cancels out:\n\t\t\t// (height_px * scale / scale) = height_px\n\t\t\tconst centerY_robot = Math.round((centerY_px + top) * MM_PER_PIXEL);\n\n\t\t\tlet roomName = \"\";\n\t\t\tconst mapping = mappedRooms?.find(([id]) => parseInt(id) === segId);\n\t\t\tif (mapping) {\n\t\t\t\tconst roomApiID = mapping[1];\n\t\t\t\tconst roomObj = roomIDsAll.find((r) => String(r.id) === String(roomApiID));\n\t\t\t\troomName = roomObj?.name || \"\";\n\t\t\t}\n\n\t\t\tparameters.segments.list.push({\n\t\t\t\tid: segId,\n\t\t\t\tname: roomName,\n\t\t\t\tcenter: [centerX_robot, centerY_robot], // Store correct MM coordinates\n\t\t\t});\n\t\t}\n\n\t\treturn parameters;\n\t}\n\n\tprivate parsePathBlock(blockBuffer: Buffer, buf: Buffer, dataPosition: number, length: number): PathBlock {\n\t\tconst pathData: PathBlock = {\n\t\t\tcurrent_angle: this.getAngle(blockBuffer),\n\t\t\tpoints: [],\n\t\t};\n\t\tconst pathDataPosition = dataPosition + OFFSETS.PATH;\n\n\t\tfor (let i = 0; i < length; i += 4) {\n\t\t\tpathData.points.push(this.getPointInPath(buf, pathDataPosition + i));\n\t\t}\n\n\t\tif (pathData.points.length >= 2) {\n\t\t\tconst last = pathData.points[pathData.points.length - 1];\n\t\t\tconst secondLast = pathData.points[pathData.points.length - 2];\n\t\t\tpathData.current_angle = (Math.atan2(last[1] - secondLast[1], last[0] - secondLast[0]) * 180) / Math.PI;\n\t\t}\n\n\t\treturn pathData;\n\t}\n\n\tprivate extractObstacles(buf: Buffer, offset: number): Obstacle[] {\n\t\tconst obstacleCount = this.getCount(buf);\n\t\tconst obstacles: Obstacle[] = [];\n\t\tfor (let i = 0; i < obstacleCount * 28; i += 28) {\n\t\t\tconst obstacle: Obstacle = [\n\t\t\t\tbuf.readUInt16LE(offset + i),\n\t\t\t\tbuf.readUInt16LE(offset + i + 2),\n\t\t\t\tbuf.readUInt16LE(offset + i + 4),\n\t\t\t\tbuf.readUInt16LE(offset + i + 6),\n\t\t\t\tbuf.readUInt16LE(offset + i + 8),\n\t\t\t\tbuf.readUInt16LE(offset + i + 10),\n\t\t\t\tbuf.toString(\"utf-8\", offset + i + 12, offset + i + 12 + 16),\n\t\t\t];\n\t\t\tobstacles.push(obstacle);\n\t\t}\n\t\treturn obstacles;\n\t}\n\n\tprivate getStroyPt(buf: Buffer, offset: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tconst points: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * 8;\n\t\t\tpoints.push([\n\t\t\t\tbuf.readUInt16LE(base), // x\n\t\t\t\tbuf.readUInt16LE(base + 2), // y\n\t\t\t\tbuf.readUInt32LE(base + 4) // code\n\t\t\t]);\n\t\t}\n\t\treturn points;\n\t}\n\n\tprivate getDirtyRect(buf: Buffer, offset: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tconst data: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * 18;\n\t\t\tdata.push([\n\t\t\t\tbuf.readUInt16LE(base), // type\n\t\t\t\tbuf.readUInt16LE(base + 2), // x1\n\t\t\t\tbuf.readUInt16LE(base + 4), // y1\n\t\t\t\tbuf.readUInt16LE(base + 6), // x2\n\t\t\t\tbuf.readUInt16LE(base + 8), // y2\n\t\t\t\tbuf.readUInt16LE(base + 10), // x3\n\t\t\t\tbuf.readUInt16LE(base + 12), // y3\n\t\t\t\tbuf.readUInt16LE(base + 14), // x4\n\t\t\t\tbuf.readUInt16LE(base + 16) // y4\n\t\t\t]);\n\t\t}\n\t\treturn data;\n\t}\n\n\tprivate getBrushPt(buf: Buffer, offset: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tconst points: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * 4;\n\t\t\tpoints.push([\n\t\t\t\tbuf.readUInt16LE(base), // x\n\t\t\t\tbuf.readUInt16LE(base + 2) // y\n\t\t\t]);\n\t\t}\n\t\treturn points;\n\t}\n\n\tprivate getDirtyNew(buf: Buffer, offset: number, length: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tif (count === 0) return [];\n\t\tconst len = length / count;\n\t\tconst data: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * len;\n\t\t\tconst hasImage = buf.readUInt8(base + 18) !== 0;\n\t\t\tdata.push([\n\t\t\t\tbuf.readUInt16LE(base), // type\n\t\t\t\tbuf.readUInt16LE(base + 2), // x1\n\t\t\t\tbuf.readUInt16LE(base + 4), // y1\n\t\t\t\tbuf.readUInt16LE(base + 6), // x2\n\t\t\t\tbuf.readUInt16LE(base + 8), // y2\n\t\t\t\tbuf.readUInt16LE(base + 10), // x3\n\t\t\t\tbuf.readUInt16LE(base + 12), // y3\n\t\t\t\tbuf.readUInt16LE(base + 14), // x4\n\t\t\t\tbuf.readUInt16LE(base + 16), // y4\n\t\t\t\thasImage ? buf.toString(\"ascii\", base + 18, base + 18 + 16).replace(/\\0/g, \"\") : \"\" // imageid\n\t\t\t]);\n\t\t}\n\t\treturn data;\n\t}\n\n\tprivate getMopErrPt(buf: Buffer, offset: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tconst points: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * 6;\n\t\t\tpoints.push([\n\t\t\t\tbuf.readUInt8(base), // errorid\n\t\t\t\tbuf.readUInt8(base + 1), // suberrorid\n\t\t\t\tbuf.readUInt16LE(base + 2), // x\n\t\t\t\tbuf.readUInt16LE(base + 4) // y\n\t\t\t]);\n\t\t}\n\t\treturn points;\n\t}\n\n\tprivate getEraserZone(buf: Buffer, offset: number, length: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tif (count === 0) return [];\n\t\tconst len = length / count;\n\t\tconst data: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * len;\n\t\t\tdata.push([\n\t\t\t\tbuf.readUInt32LE(base), // type\n\t\t\t\tbuf.readUInt16LE(base + 4), // x1\n\t\t\t\tbuf.readUInt16LE(base + 6), // y1\n\t\t\t\tbuf.readUInt16LE(base + 8), // x2\n\t\t\t\tbuf.readUInt16LE(base + 10), // y2\n\t\t\t\tbuf.readUInt16LE(base + 12), // x3\n\t\t\t\tbuf.readUInt16LE(base + 14), // y3\n\t\t\t\tbuf.readUInt16LE(base + 16), // x4\n\t\t\t\tbuf.readUInt16LE(base + 18) // y4\n\t\t\t]);\n\t\t}\n\t\treturn data;\n\t}\n\n\tprivate getLongCarpet(buf: Buffer, offset: number, length: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tif (count === 0) return [];\n\t\tconst len = length / count;\n\t\tconst data: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * len;\n\t\t\tdata.push([\n\t\t\t\tbuf.readUInt32LE(base), // id\n\t\t\t\tbuf.readUInt32LE(base + 4), // total\n\t\t\t\tbuf.readUInt32LE(base + 8) // longhaired\n\t\t\t]);\n\t\t}\n\t\treturn data;\n\t}\n\n\tprivate getDsSides(buf: Buffer, offset: number, length: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tif (count === 0) return [];\n\t\tconst len = length / count;\n\t\tconst data: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * len;\n\t\t\tdata.push([\n\t\t\t\tbuf.readUInt8(base), // id\n\t\t\t\tbuf.readUInt8(base + 1),\n\t\t\t\tbuf.readUInt8(base + 2),\n\t\t\t\tbuf.readUInt8(base + 3)\n\t\t\t]);\n\t\t}\n\t\treturn data;\n\t}\n\n\tprivate getSteeringPt(buf: Buffer, offset: number, length: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tif (count === 0) return [];\n\t\tconst len = length / count;\n\t\tconst data: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * len;\n\t\t\tdata.push([\n\t\t\t\tbuf.readUInt16LE(base), // x\n\t\t\t\tbuf.readUInt16LE(base + 2), // y\n\t\t\t\tbuf.readUInt8(base + 4) // type\n\t\t\t]);\n\t\t}\n\t\treturn data;\n\t}\n\n\tprivate getSensorInfo(buf: Buffer, offset: number, length: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tif (count === 0) return [];\n\t\tconst len = length / count;\n\t\tconst data: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * len;\n\t\t\tdata.push([\n\t\t\t\tbuf.readUInt16LE(base), // x\n\t\t\t\tbuf.readUInt16LE(base + 2), // y\n\t\t\t\tbuf.readUInt8(base + 4), // type\n\t\t\t\tbuf.readUInt8(base + 5) // status\n\t\t\t]);\n\t\t}\n\t\treturn data;\n\t}\n\n\tprivate getTidyZones(buf: Buffer, offset: number, length: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tif (count === 0) return [];\n\t\tconst len = length / count;\n\t\tconst data: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * len;\n\t\t\tdata.push([\n\t\t\t\tbuf.readUInt16LE(base), // id\n\t\t\t\tbuf.readUInt16LE(base + 2), // type\n\t\t\t\tbuf.readUInt16LE(base + 4), // x1\n\t\t\t\tbuf.readUInt16LE(base + 6), // y1\n\t\t\t\tbuf.readUInt16LE(base + 8), // x2\n\t\t\t\tbuf.readUInt16LE(base + 10), // y2\n\t\t\t\tbuf.readUInt16LE(base + 12), // x3\n\t\t\t\tbuf.readUInt16LE(base + 14), // y3\n\t\t\t\tbuf.readUInt16LE(base + 16), // x4\n\t\t\t\tbuf.readUInt16LE(base + 18) // y4\n\t\t\t]);\n\t\t}\n\t\treturn data;\n\t}\n\n\tprivate getGarbage(buf: Buffer, offset: number, length: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tif (count === 0) return [];\n\t\tconst len = length / count;\n\t\tconst data: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * len;\n\t\t\tdata.push([\n\t\t\t\tbuf.readUInt16LE(base), // robot x\n\t\t\t\tbuf.readUInt16LE(base + 2), // robot y\n\t\t\t\tbuf.readUInt16LE(base + 4), // garbage x\n\t\t\t\tbuf.readUInt16LE(base + 6), // garbage y\n\t\t\t\tbuf.readUInt16LE(base + 8), // tidyzone id\n\t\t\t\tbuf.readUInt16LE(base + 10), // garbage id\n\t\t\t\tbuf.toString(\"utf-8\", base + 12, base + len) // tag\n\t\t\t]);\n\t\t}\n\t\treturn data;\n\t}\n\n\tprivate getZoneLines(buf: Buffer, offset: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tconst data: any[] = [];\n\t\tlet toffset = 0;\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + toffset;\n\t\t\tconst id = buf.readUInt16LE(base);\n\t\t\tconst num = buf.readUInt16LE(base + 2);\n\t\t\tconst ptLen = buf.readUInt16LE(base + 4);\n\t\t\tconst points: any[] = [];\n\t\t\tfor (let j = 0; j < num; j++) {\n\t\t\t\tconst pOff = base + 6 + j * ptLen;\n\t\t\t\tpoints.push([\n\t\t\t\t\tbuf.readUInt16LE(pOff), // x\n\t\t\t\t\tbuf.readUInt16LE(pOff + 2), // y\n\t\t\t\t\tbuf.readUIntLE(pOff + 4, ptLen - 4) // type\n\t\t\t\t]);\n\t\t\t}\n\t\t\ttoffset += 6 + num * ptLen;\n\t\t\tdata.push({ id, num, ptLen, points });\n\t\t}\n\t\treturn data;\n\t}\n\n\tprivate getObstaclesOld(buf: Buffer, offset: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tconst obstacles: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * 5;\n\t\t\tobstacles.push([\n\t\t\t\tbuf.readUInt16LE(base), // x\n\t\t\t\tbuf.readUInt16LE(base + 2), // y\n\t\t\t\tbuf.readUInt8(base + 4) // type\n\t\t\t]);\n\t\t}\n\t\treturn obstacles;\n\t}\n\n\tprivate getIgnoredObstacles2(buf: Buffer, offset: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tconst obstacles: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * 6;\n\t\t\tobstacles.push([\n\t\t\t\tbuf.readUInt16LE(base), // x\n\t\t\t\tbuf.readUInt16LE(base + 2), // y\n\t\t\t\tbuf.readUInt16LE(base + 4) // type\n\t\t\t]);\n\t\t}\n\t\treturn obstacles;\n\t}\n\n\tprivate getSmartZone(buf: Buffer, offset: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tconst zones: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * 18;\n\t\t\tzones.push({\n\t\t\t\tzid: buf.readUInt16LE(base),\n\t\t\t\trange: [\n\t\t\t\t\tbuf.readUInt16LE(base + 2),\n\t\t\t\t\tbuf.readUInt16LE(base + 4),\n\t\t\t\t\tbuf.readUInt16LE(base + 6),\n\t\t\t\t\tbuf.readUInt16LE(base + 8)\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\treturn zones;\n\t}\n\n\tprivate getFurnitures(buf: Buffer, offset: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tconst furnitures: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * 23;\n\t\t\tfurnitures.push([\n\t\t\t\tbuf.readUInt16LE(base), // x1\n\t\t\t\tbuf.readUInt16LE(base + 2), // y1\n\t\t\t\tbuf.readUInt16LE(base + 4), // x2\n\t\t\t\tbuf.readUInt16LE(base + 6), // y2\n\t\t\t\tbuf.readUInt16LE(base + 8), // x3\n\t\t\t\tbuf.readUInt16LE(base + 10), // y3\n\t\t\t\tbuf.readUInt16LE(base + 12), // x4\n\t\t\t\tbuf.readUInt16LE(base + 14), // y4\n\t\t\t\tbuf.readUInt16LE(base + 16), // x_real\n\t\t\t\tbuf.readUInt8(base + 18), // percent\n\t\t\t\tbuf.readUInt8(base + 19), // type\n\t\t\t\tbuf.readUInt8(base + 20), // subtype\n\t\t\t\tbuf.readUInt8(base + 21), // edit\n\t\t\t\tbuf.readUInt8(base + 22) // id\n\t\t\t]);\n\t\t}\n\t\treturn furnitures;\n\t}\n\n\tprivate getEnemies(buf: Buffer, offset: number): any[] {\n\t\tconst count = this.getCount(buf);\n\t\tconst enemies: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * 6;\n\t\t\tenemies.push([\n\t\t\t\tbuf.readUInt16LE(base), // x\n\t\t\t\tbuf.readUInt16LE(base + 2), // y\n\t\t\t\tbuf.readUInt16LE(base + 4) // type\n\t\t\t]);\n\t\t}\n\t\treturn enemies;\n\t}\n\n\tprivate getFloorDirection(buf: Buffer, offset: number, length: number): any[] {\n\t\tconst count = length / 3; // No count header? Code says data.length / 3\n\t\tconst data: any[] = [];\n\t\tfor (let i = 0; i < count; i++) {\n\t\t\tconst base = offset + i * 3;\n\t\t\tdata.push([\n\t\t\t\tbuf.readUInt8(base), // blockid\n\t\t\t\tbuf.readUInt16LE(base + 1) // direction\n\t\t\t]);\n\t\t}\n\t\treturn data;\n\t}\n\n\tprivate getPatrol(buf: Buffer, offset: number): any[] {\n\t\t// Header structure inside data:\n\t\t// taskId: 4 bytes (at offset)\n\t\t// num: 1 byte (at offset + 4)\n\t\t// points: num * 278 bytes (starting at offset + 5)\n\n\t\tif (buf.length < offset + 5) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst num = buf.readUInt8(offset + 4);\n\t\tconst points: any[] = [];\n\t\tconst dataStart = offset + 5;\n\t\tconst pointSize = 278; // Fixed size per point based on observation\n\n\t\tfor (let i = 0; i < num; i++) {\n\t\t\tconst base = dataStart + i * pointSize;\n\n\t\t\t// Ensure we don't read past the buffer\n\t\t\tif (base + 4 > buf.length) {\n\t\t\t\tthis.adapter.log.warn(`[MapDataParser] getPatrol: Buffer too short for point ${i + 1}/${num}`);\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tpoints.push([\n\t\t\t\tbuf.readUInt16LE(base), // x\n\t\t\t\tbuf.readUInt16LE(base + 2) // y\n\t\t\t]);\n\t\t}\n\t\treturn points;\n\t}\n\n\t// --------------------\n\t// Binary Read Helpers\n\t// --------------------\n\n\tprivate getXYPositions(buf: Buffer, xOffset: number, yOffset: number): [number, number] {\n\t\tconst xPosition = buf.readInt32LE(xOffset);\n\t\tconst yPosition = buf.readInt32LE(yOffset);\n\t\treturn [xPosition, yPosition];\n\t}\n\n\t/** Reads unscaled pixel dimensions and offsets from the image block header. */\n\tprivate getMapSizes(buf: Buffer, offset: number): { left: number; top: number; width: number; height: number } {\n\t\tconst top = buf.readInt32LE(offset - 0x10); // Unscaled Pixel Offset Y\n\t\tconst left = buf.readInt32LE(offset - 0x0c); // Unscaled Pixel Offset X\n\t\tconst height = buf.readInt32LE(offset - 0x08); // Unscaled Pixel Height\n\t\tconst width = buf.readInt32LE(offset - 0x04); // Unscaled Pixel Width\n\t\treturn { left, top, width, height };\n\t}\n\n\tprivate getPointInPath(buf: Buffer, dataPosition: number): [number, number] {\n\t\tconst x = buf.readUInt16LE(dataPosition);\n\t\tconst y = buf.readUInt16LE(dataPosition + 2);\n\t\treturn [x, y];\n\t}\n\n\tprivate getCount(buf: Buffer): number {\n\t\treturn buf.readUInt32LE(OFFSETS.TYPE_COUNT);\n\t}\n\n\tprivate getPixelType(buf: Buffer, dataPosition: number): number {\n\t\treturn buf.readUInt8(dataPosition) & 0x07;\n\t}\n\n\tprivate getAngle(buf: Buffer): number {\n\t\treturn buf.readInt32LE(OFFSETS.ANGLE);\n\t}\n\n\tprivate getGoToTarget(buf: Buffer): [number, number] {\n\t\treturn [buf.readUInt16LE(OFFSETS.TARGET_X), buf.readUInt16LE(OFFSETS.TARGET_Y)];\n\t}\n\n\tprivate getForbiddenZone(buf: Buffer, dataPosition: number, offset: number): number[] {\n\t\treturn this.readUInt16LE(buf, dataPosition, offset, 8);\n\t}\n\n\tprivate getSingleByteOffset(buf: Buffer): number {\n\t\treturn buf.readUInt8(2);\n\t}\n\n\tprivate getTwoByteOffsets(buf: Buffer): [number, number] {\n\t\treturn [buf.readUInt8(2), buf.readUInt8(4)];\n\t}\n\n\tprivate getNonceData(buf: Buffer): NonceData[] {\n\t\tconst sections: NonceData[] = [];\n\t\tfor (let i = 12; i < buf.length; i += 5) {\n\t\t\tconst type = buf[i];\n\t\t\tconst unixTime = buf.readUInt32LE(i + 1);\n\t\t\tsections.push({ type, unixTime });\n\t\t}\n\t\treturn sections;\n\t}\n\n\tprivate readUInt16LE(buf: Buffer, dataPosition: number, offset: number, count: number): number[] {\n\t\tconst result: number[] = [];\n\t\tfor (let j = 0; j < count; j++) {\n\t\t\tresult.push(buf.readUInt16LE(dataPosition + offset + j * 2));\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate readUInt8(buf: Buffer, dataPosition: number, offset: number, count: number): number[] {\n\t\tconst array: number[] = [];\n\t\tfor (let j = 0; j < count; j++) {\n\t\t\tarray.push(buf.readUInt8(offset + dataPosition + j));\n\t\t}\n\t\treturn array;\n\t}\n}\n"]}